{"version":3,"file":"buttons.js","names":["_rdflib","require","_iconBase","ns","_interopRequireWildcard","style","debug","_log","_jss","_dragAndDrop","_solidLogic","utils","_error","_widgetHelpers","_iconLinks","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","iconBase","icons","cancelIconURI","checkIconURI","getStatusArea","context","box","statusArea","div","dom","document","body","getElementsByTagName","createElement","insertBefore","firstElementChild","complain","err","ele","log","appendChild","errorMessageBlock","alert","clearElement","firstChild","removeChild","extractLogURI","fullURI","logPos","search","rulPos","substring","shortDate","str","noTime","month","nowZ","Date","toISOString","slice","parseInt","e","formatDateTime","date","format","split","map","s","k","width","Milliseconds","FullYear","d","Month","join","timestamp","shortTime","setName","element","x","kb","store","findName","name","any","vcard","foaf","value","sameTerm","textContent","label","uri","fetcher","Error","nowOrWhenFetched","doc","undefined","_ok","imagesOf","each","sioc","concat","iconForClass","exports","tempSite","p","indexOf","q","findImageFromURI","iconDir","length","startsWith","findImage","thing","rdf","image","trySetImage","iconForClassMap","explitImage","setAttribute","typeIcon","classIconStyle","schemeIcon","types","findTypeURIs","typeURI","setImage","pref","id","theClass","happy","ok","faviconOrDefault","iconStyle","isOrigin","parts","res","renderDeleteConfirmPopup","refererenceElement","prompt","deleteFunction","removePopup","parentElement","removePopupAndDoDeletion","popup","confirmPopupStyle","position","top","display","gridTemplateColumns","affirm","gridColumn","gridRow","cancel","xButton","cancelButton","cancelPrompt","buttonStyle","affirmIcon","button","sureButtonElt","addEventListener","deleteButtonWithCheck","container","noun","createPopup","deleteButton","minusIconURI","smallButtonStyle","title","classList","add","getButtonStyle","options","arguments","color","buttonColor","backgroundColor","fontColor","borderColor","hoverBackgroundColor","hoverFontColor","needsBorder","border","cursor","padding","transition","outline","iconURI","text","handler","img","toLocaleUpperCase","_getClasses","getClasses","head","textButton","classes","b","opacity","continueButton","askName","predicate","Promise","resolve","_reject","form","namefield","textInputStyle","select","gotName","parentNode","trim","keyCode","_event","focus","personTR","renderAsRow","pred","tr","td1","td2","td3","link","anchor","linkIcon","draggable","makeDraggable","subject","createNameDiv","nameDiv","createLinkDiv","linkDiv","linkDivStyle","createLinkForURI","renderAsDiv","renderAsDivStyle","createImageDiv","clickable","onClickFunction","addClickListenerToElement","wrapInATR","wrapDivInATR","refreshTree","root","refresh","i","children","attachmentList","deleteAttachment","target","updater","update","st","errorBody","_xhr","createNewRow","theTarget","opt","modify","things","sort","syncTableToArray","attachmentTable","droppedURIHandler","uris","ins","forEach","u","sym","push","droppedFileHandler","files","_options$uploadFolder","_options$uploadFolder2","uploadFiles","uploadFolder","theFile","destURI","promptIcon","wf","attachmentOuter","attachmentOne","attachmentLeft","attachmentRight","paperclip","fhandler","makeDropTarget","buttonDiv","fileUploadButtonDiv","openHrefInOutlineMode","preventDefault","stopPropagation","getTarget","getAttribute","window","outlineManager","GotoSubject","panes","getOutliner","defaultAnnotationStore","hash","slash","lastIndexOf","allClassURIs","statementsMatching","object","rdfs","c","propertyTriage","possibleProperties","dp","op","no","nd","nu","pi","predicateIndex","termType","ps","toNT","info","linkButton","removeButton","selectorPanel","type","inverse","possible","callbackFunction","linkCallback","selectorPanelRefresh","list","style0","selected","innerHTML","refreshItem","item","setStyle","already","iconDiv","connectIcon","f","index","twoLine","widgetForClass","nav","a","event","twoLineDefault","twoLineWidgetForClass","widget","sup","findSuperClassesNT","cl","fromNT","twoLineTransaction","failed","enc","y","qu","escapeForXML","twoLineTrip","dc","cal","addStyleSheet","href","links","querySelectorAll","isAudio","file","isImage","isVideo","kind","dcCLasses","audio","video","what","typeURIs","prefix","Util","mediaTypeClass","t","input","buttonElt","click","line"],"sources":["../../src/widgets/buttons.ts"],"sourcesContent":["/*  Buttons\n*/\nimport { IndexedFormula, NamedNode, st, sym, uri, Util } from 'rdflib'\nimport { icons } from '../iconBase'\nimport * as ns from '../ns'\nimport * as style from '../style'\nimport * as debug from '../debug'\nimport { info } from '../log'\nimport { getClasses } from '../jss'\nimport { uploadFiles, makeDraggable, makeDropTarget } from './dragAndDrop'\nimport { store } from 'solid-logic'\nimport * as utils from '../utils'\nimport { errorMessageBlock } from './error'\nimport { addClickListenerToElement, createImageDiv, wrapDivInATR } from './widgetHelpers'\nimport { linkIcon, createLinkForURI } from './buttons/iconLinks'\n\n/**\n * UI Widgets such as buttons\n * @packageDocumentation\n */\n\n/* global alert */\n\nconst { iconBase } = icons\n\nconst cancelIconURI = iconBase + 'noun_1180156.svg' // black X\nconst checkIconURI = iconBase + 'noun_1180158.svg' // green checkmark; Continue\n\nexport type StatusAreaContext = {\n  statusArea?: HTMLElement\n  div?: HTMLElement\n  dom?: HTMLDocument\n}\nexport type ButtonType = 'Primary' | 'Secondary'\n\nexport type ButtonWidgetOptions = {\n  buttonColor?: ButtonType,\n  needsBorder?: boolean\n}\n\nexport type RenderAsDivOptions = {\n  image?: HTMLImageElement,\n  title?: string,\n  deleteFunction?: () => void,\n  link?: boolean,\n  noun?: string,\n  draggable?: boolean,\n  clickable?: boolean,\n  onClickFunction?: () => void,\n  wrapInATR?: boolean\n}\n\nfunction getStatusArea (context?: StatusAreaContext) {\n  let box = (context && context.statusArea) || (context && context.div) || null\n  if (box) return box\n  let dom = context && context.dom\n  if (!dom && typeof document !== 'undefined') {\n    dom = document\n  }\n  if (dom) {\n    const body = dom.getElementsByTagName('body')[0]\n    box = dom.createElement('div')\n    body.insertBefore((box as unknown as HTMLElement), body.firstElementChild)\n    if (context) {\n      context.statusArea = (box as unknown as HTMLElement)\n    }\n    return box\n  }\n  return null\n}\n\n/**\n * Display an error message block\n */\nexport function complain (context?: StatusAreaContext, err?: string) {\n  if (!err) return // only if error\n  const ele = getStatusArea(context)\n  debug.log('Complaint: ' + err)\n  if (ele) ele.appendChild(errorMessageBlock((context && context.dom) || document, err))\n  else alert(err)\n}\n\n/**\n * Remove all the children of an HTML element\n */\nexport function clearElement (ele: HTMLElement) {\n  while (ele.firstChild) {\n    ele.removeChild(ele.firstChild)\n  }\n  return ele\n}\n\n/**\n * To figure out the log URI from the full URI used to invoke the reasoner\n */\nexport function extractLogURI (fullURI) {\n  const logPos = fullURI.search(/logFile=/)\n  const rulPos = fullURI.search(/&rulesFile=/)\n  return fullURI.substring(logPos + 8, rulPos)\n}\n\n/**\n * By default, converts e.g. '2020-02-19T19:35:28.557Z' to '19:35'\n * if today is 19 Feb 2020, and to 'Feb 19' if not.\n * @@@ TODO This needs to be changed to local time\n * @param noTime Return a string like 'Feb 19' even if it's today.\n */\nexport function shortDate (str?: string, noTime?: boolean): string {\n  if (!str) return '???'\n  const month = [\n    'Jan',\n    'Feb',\n    'Mar',\n    'Apr',\n    'May',\n    'Jun',\n    'Jul',\n    'Aug',\n    'Sep',\n    'Oct',\n    'Nov',\n    'Dec'\n  ]\n  try {\n    const nowZ = new Date().toISOString()\n    // var nowZ = $rdf.term(now).value\n    // var n = now.getTimezoneOffset() // Minutes\n    if (str.slice(0, 10) === nowZ.slice(0, 10) && !noTime) {\n      return str.slice(11, 16)\n    }\n    if (str.slice(0, 4) === nowZ.slice(0, 4)) {\n      return (\n        month[parseInt(str.slice(5, 7), 10) - 1] +\n        ' ' +\n        parseInt(str.slice(8, 10), 10)\n      )\n    }\n    return str.slice(0, 10)\n  } catch (e) {\n    return 'shortdate:' + e\n  }\n}\n\n/**\n * Format a date and time\n * @param date for instance `new Date()`\n * @param format  for instance '{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}.{Milliseconds}'\n * @returns for instance '2000-01-15T23:14:23.002'\n */\nexport function formatDateTime (date: Date, format: string): string {\n  return format\n    .split('{')\n    .map(function (s) {\n      const k = s.split('}')[0]\n      const width = { Milliseconds: 3, FullYear: 4 }\n      const d = { Month: 1 }\n      return s\n        ? ('000' + (date['get' + k]() + (d[k] || 0))).slice(-(width[k] || 2)) + s.split('}')[1]\n        : ''\n    })\n    .join('')\n}\n\n/**\n * Get a string representation of the current time\n * @returns for instance '2000-01-15T23:14:23.002'\n */\nexport function timestamp (): string {\n  return formatDateTime(\n    new Date(),\n    '{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}.{Milliseconds}'\n  )\n}\n\n/**\n * Get a short string representation of the current time\n * @returns for instance '23:14:23.002'\n */\nexport function shortTime (): string {\n  return formatDateTime(\n    new Date(),\n    '{Hours}:{Minutes}:{Seconds}.{Milliseconds}'\n  )\n}\n\n// ///////////////////// Handy UX widgets\n\n/**\n * Sets the best name we have and looks up a better one\n */\nexport function setName (element: HTMLElement, x: NamedNode) {\n  const kb = store\n  const findName = function (x) {\n    const name =\n      kb.any(x, ns.vcard('fn')) ||\n      kb.any(x, ns.foaf('name')) ||\n      kb.any(x, ns.vcard('organization-name'))\n    return name ? name.value : null\n  }\n  const name = x.sameTerm(ns.foaf('Agent')) ? 'Everyone' : findName(x)\n  element.textContent = name || utils.label(x)\n  if (!name && x.uri) {\n    if (!kb.fetcher) {\n      throw new Error('kb has no fetcher')\n    }\n    // Note this is only a fetch, not a lookUP of all sameAs etc\n    kb.fetcher.nowOrWhenFetched(x.doc(), undefined, function (_ok) {\n      element.textContent = findName(x) || utils.label(x) // had: (ok ? '' : '? ') +\n    })\n  }\n}\n\n/**\n * Set of suitable images\n * See also [[findImage]]\n * @param x The thing for which we want to find an image\n * @param kb The RDF store to look in\n * @returns It goes looking for triples in `kb`,\n *          `(subject: x), (predicate: see list below) (object: image-url)`\n *          to find any image linked from the thing with one of the following\n *          predicates (in order):\n *          * ns.sioc('avatar')\n *          * ns.foaf('img')\n *          * ns.vcard('logo')\n *          * ns.vcard('hasPhoto')\n *          * ns.vcard('photo')\n *          * ns.foaf('depiction')\n\n */\nexport function imagesOf (x: NamedNode | null, kb: IndexedFormula): any[] {\n  return kb\n    .each(x, ns.sioc('avatar'))\n    .concat(kb.each(x, ns.foaf('img')))\n    .concat(kb.each(x, ns.vcard('logo')))\n    .concat(kb.each(x, ns.vcard('hasPhoto')))\n    .concat(kb.each(x, ns.vcard('photo')))\n    .concat(kb.each(x, ns.foaf('depiction')))\n}\n\n/**\n * Best logo or avatar or photo etc to represent someone or some group etc\n */\nexport const iconForClass = {\n  // Potentially extendable by other apps, panes, etc\n  // Relative URIs to the iconBase\n  'solid:AppProviderClass': 'noun_144.svg', //  @@ classs name should not contain 'Class'\n  'solid:AppProvider': 'noun_15177.svg', // @@\n  'solid:Pod': 'noun_Cabinet_1434380.svg',\n  'vcard:Group': 'noun_339237.svg',\n  'vcard:Organization': 'noun_143899.svg',\n  'vcard:Individual': 'noun_15059.svg',\n  'schema:Person': 'noun_15059.svg',\n  'foaf:Person': 'noun_15059.svg',\n  'foaf:Agent': 'noun_98053.svg',\n  'acl:AuthenticatedAgent': 'noun_99101.svg',\n  'prov:SoftwareAgent': 'noun_Robot_849764.svg', // Bot\n  'vcard:AddressBook': 'noun_15695.svg',\n  'trip:Trip': 'noun_581629.svg',\n  'meeting:LongChat': 'noun_1689339.svg',\n  'meeting:Meeting': 'noun_66617.svg',\n  'meeting:Project': 'noun_1036577.svg',\n  'ui:Form': 'noun_122196.svg',\n  'rdfs:Class': 'class-rectangle.svg', // For RDF developers\n  'rdf:Property': 'property-diamond.svg',\n  'owl:Ontology': 'noun_classification_1479198.svg',\n  'wf:Tracker': 'noun_122196.svg',\n  'wf:Task': 'noun_17020_gray-tick.svg',\n  'wf:Open': 'noun_17020_sans-tick.svg',\n  'wf:Closed': 'noun_17020.svg'\n}\n\n/**\n * Returns the origin of the URI of a NamedNode\n */\nfunction tempSite (x: NamedNode) {\n  // use only while one in rdflib fails with origins 2019\n  const str = x.uri.split('#')[0]\n  const p = str.indexOf('//')\n  if (p < 0) throw new Error('This URI does not have a web site part (origin)')\n  const q = str.indexOf('/', p + 2)\n  if (q < 0) {\n    // no third slash?\n    return str.slice(0) + '/' // Add slash to a bare origin\n  } else {\n    return str.slice(0, q + 1)\n  }\n}\n\n/**\n * Find an image for this thing as a class\n */\nexport function findImageFromURI (x: NamedNode | string): string | null {\n  const iconDir = iconBase\n\n  // Special cases from URI scheme:\n  if (typeof x !== 'string' && x.uri) {\n    if (\n      x.uri.split('/').length === 4 &&\n      !x.uri.split('/')[1] &&\n      !x.uri.split('/')[3]\n    ) {\n      return iconDir + 'noun_15177.svg' // App -- this is an origin\n    }\n    // Non-HTTP URI types imply types\n    if (x.uri.startsWith('message:') || x.uri.startsWith('mid:')) {\n      // message: is apple bug-- should be mid:\n      return iconDir + 'noun_480183.svg' // envelope  noun_567486\n    }\n    if (x.uri.startsWith('mailto:')) {\n      return iconDir + 'noun_567486.svg' // mailbox - an email desitination\n    }\n    // For HTTP(s) documents, we could look at the MIME type if we know it.\n    if (x.uri.startsWith('https:') && x.uri.indexOf('#') < 0) {\n      return tempSite(x) + 'favicon.ico' // was x.site().uri + ...\n      // Todo: make the document icon a fallback for if the favicon does not exist\n      // todo: pick up a possible favicon for the web page itself from a link\n      // was: return iconDir + 'noun_681601.svg' // document - under solid assumptions\n    }\n    return null\n  }\n\n  return iconDir + 'noun_10636_grey.svg' // Grey Circle -  some thing\n}\n\n/**\n * Find something we have as explicit image data for the thing\n * See also [[imagesOf]]\n * @param thing The thing for which we want to find an image\n * @returns The URL of a globe icon if thing equals `ns.foaf('Agent')`\n *          or `ns.rdf('Resource')`. Otherwise, it goes looking for\n *          triples in `store`,\n *          `(subject: thing), (predicate: see list below) (object: image-url)`\n *          to find any image linked from the thing with one of the following\n *          predicates (in order):\n *          * ns.sioc('avatar')\n *          * ns.foaf('img')\n *          * ns.vcard('logo')\n *          * ns.vcard('hasPhoto')\n *          * ns.vcard('photo')\n *          * ns.foaf('depiction')\n */\nexport function findImage (thing: NamedNode): string {\n  const kb = store\n  const iconDir = iconBase\n  if (thing.sameTerm(ns.foaf('Agent')) || thing.sameTerm(ns.rdf('Resource'))) {\n    return iconDir + 'noun_98053.svg' // Globe\n  }\n  const image =\n    kb.any(thing, ns.sioc('avatar')) ||\n    kb.any(thing, ns.foaf('img')) ||\n    kb.any(thing, ns.vcard('logo')) ||\n    kb.any(thing, ns.vcard('hasPhoto')) ||\n    kb.any(thing, ns.vcard('photo')) ||\n    kb.any(thing, ns.foaf('depiction'))\n  return image ? (image as any).uri : null\n}\n\n/**\n * Do the best you can with the data available\n *\n * @return {Boolean} Are we happy with this icon?\n * Sets src AND STYLE of the image.\n */\nfunction trySetImage (element, thing, iconForClassMap) {\n  const kb = store\n\n  const explitImage = findImage(thing)\n  if (explitImage) {\n    element.setAttribute('src', explitImage)\n    return true\n  }\n  // This is one of the classes we know about - the class itself?\n  const typeIcon = iconForClassMap[thing.uri]\n  if (typeIcon) {\n    element.setAttribute('src', typeIcon)\n    element.style = style.classIconStyle\n    // element.style.border = '0.1em solid green;'\n    // element.style.backgroundColor = '#eeffee' // pale green\n    return true\n  }\n  const schemeIcon = findImageFromURI(thing)\n  if (schemeIcon) {\n    element.setAttribute('src', schemeIcon)\n    return true // happy with this -- don't look it up\n  }\n\n  // Do we have a generic icon for something in any class its in?\n  const types = kb.findTypeURIs(thing)\n  for (const typeURI in types) {\n    if (iconForClassMap[typeURI]) {\n      element.setAttribute('src', iconForClassMap[typeURI])\n      return false // maybe we can do better\n    }\n  }\n  element.setAttribute('src', iconBase + 'noun_10636_grey.svg') // Grey Circle -  some thing\n  return false // we can do better\n}\n\n/**\n * ToDo: Also add icons for *properties* like  home, work, email, range, domain, comment,\n */\nexport function setImage (element: HTMLElement, thing: NamedNode) { // 20191230a\n  const kb = store\n\n  const iconForClassMap = {}\n  for (const k in iconForClass) {\n    const pref = k.split(':')[0]\n    const id = k.split(':')[1]\n    const theClass = ns[pref](id)\n    iconForClassMap[theClass.uri] = uri.join(iconForClass[k], iconBase)\n  }\n\n  const happy = trySetImage(element, thing, iconForClassMap)\n  if (!happy && thing.uri) {\n    if (!kb.fetcher) {\n      throw new Error('kb has no fetcher')\n    }\n    kb.fetcher.nowOrWhenFetched(thing.doc(), undefined, (ok) => {\n      if (ok) {\n        trySetImage(element, thing, iconForClassMap)\n      }\n    })\n  }\n}\n\n// If a web page, then a favicon, with a fallback to ???\n// See, e.g., http://stackoverflow.com/questions/980855/inputting-a-default-image\nexport function faviconOrDefault (dom: HTMLDocument, x: NamedNode) {\n  const image = dom.createElement('img')\n  ;(image as any).style = style.iconStyle\n  const isOrigin = function (x) {\n    if (!x.uri) return false\n    const parts = x.uri.split('/')\n    return parts.length === 3 || (parts.length === 4 && parts[3] === '')\n  }\n  image.setAttribute(\n    'src',\n    iconBase + (isOrigin(x) ? 'noun_15177.svg' : 'noun_681601.svg') // App symbol vs document\n  )\n  if (x.uri && x.uri.startsWith('https:') && x.uri.indexOf('#') < 0) {\n    const res = dom.createElement('object') // favico with a fallback of a default image if no favicon\n    res.setAttribute('data', tempSite(x) + 'favicon.ico')\n    res.setAttribute('type', 'image/x-icon')\n    res.appendChild(image) // fallback\n    return res\n  } else {\n    setImage(image, x)\n    return image\n  }\n}\n\n/* Two-option dialog pop-up\n*/\n\nfunction renderDeleteConfirmPopup (dom, refererenceElement, prompt, deleteFunction) {\n  function removePopup () {\n    refererenceElement.parentElement.removeChild(refererenceElement)\n  }\n  function removePopupAndDoDeletion () {\n    removePopup()\n    deleteFunction()\n  }\n  const popup = dom.createElement('div')\n  popup.style = style.confirmPopupStyle\n  popup.style.position = 'absolute'\n  popup.style.top = '-1em' // try leaving original button clear\n\n  popup.style.display = 'grid'\n  popup.style.gridTemplateColumns = 'auto auto'\n  const affirm = dom.createElement('div')\n  affirm.style.gridColumn = '1/2'\n  affirm.style.gridRow = '1' // @@ sigh; TS. could pass number in fact\n  const cancel = dom.createElement('div')\n  cancel.style.gridColumn = '1/2'\n  cancel.style.gridRow = '2'\n\n  const xButton = cancelButton(dom, removePopup)\n  popup.appendChild(xButton)\n  xButton.style.gridColumn = '1'\n  xButton.style.gridRow = '2'\n\n  const cancelPrompt = popup.appendChild(dom.createElement('button'))\n  cancelPrompt.style = style.buttonStyle\n  cancelPrompt.style.gridRow = '2'\n  cancelPrompt.style.gridColumn = '2'\n  cancelPrompt.textContent = 'Cancel' // @@ I18n\n\n  const affirmIcon = button(dom, icons.iconBase + 'noun_925021.svg', 'Delete it') // trashcan\n  popup.appendChild(affirmIcon)\n  affirmIcon.style.gridRow = '1'\n  affirmIcon.style.gridColumn = '1'\n\n  const sureButtonElt = popup.appendChild(dom.createElement('button'))\n  sureButtonElt.style = style.buttonStyle\n  sureButtonElt.style.gridRow = '1'\n  sureButtonElt.style.gridColumn = '2'\n  sureButtonElt.textContent = prompt\n  popup.appendChild(sureButtonElt)\n\n  affirmIcon.addEventListener('click', removePopupAndDoDeletion)\n  sureButtonElt.addEventListener('click', removePopupAndDoDeletion)\n\n  // xButton.addEventListener('click', removePopup)\n  cancelPrompt.addEventListener('click', removePopup)\n\n  return popup\n}\n/**\n * Delete button with a check you really mean it\n * @@ Supress check if command key held down?\n */\nexport function deleteButtonWithCheck (\n  dom: HTMLDocument,\n  container: HTMLElement,\n  noun: string,\n  deleteFunction: () => any\n) {\n  function createPopup () {\n    const refererenceElement = dom.createElement('div')\n    container.insertBefore(refererenceElement, deleteButton)\n    refererenceElement.style.position = 'relative' // Needed as reference for popup\n    refererenceElement.appendChild(renderDeleteConfirmPopup(dom, refererenceElement, prompt, deleteFunction))\n  }\n  const minusIconURI = iconBase + 'noun_2188_red.svg' // white minus in red #cc0000 circle\n  const deleteButton = dom.createElement('img')\n  deleteButton.setAttribute('src', minusIconURI)\n\n  deleteButton.setAttribute('style', style.smallButtonStyle) // @@tsc - would set deleteButton.style\n  deleteButton.style.float = 'right' // Historically this has alwaus floated right\n\n  const prompt = 'Remove this ' + noun\n  deleteButton.title = prompt\n  // @@ In an ideal world, make use of hover an accessibility option\n  deleteButton.classList.add('hoverControlHide')\n\n  deleteButton.addEventListener('click', createPopup)\n\n  container.classList.add('hoverControl')\n  container.appendChild(deleteButton)\n  deleteButton.setAttribute('data-testid', 'deleteButtonWithCheck')\n  return deleteButton // or button div?  caller may change size of image\n}\n\n/**\n * Get the button style, based on options.\n * See https://design.inrupt.com/atomic-core/?cat=Atoms#Buttons\n */\nfunction getButtonStyle (options: ButtonWidgetOptions = {}) {\n  // default to primary color\n  const color: string = (options.buttonColor === 'Secondary') ? '#01c9ea' : '#7c4dff'\n  let backgroundColor: string = color\n  let fontColor: string = '#ffffff'\n  let borderColor: string = color\n  // default to primary color\n  let hoverBackgroundColor: string = (options.buttonColor === 'Secondary') ? '#37cde6' : '#9f7dff'\n  let hoverFontColor: string = fontColor\n  if (options.needsBorder) {\n    backgroundColor = '#ffffff'\n    fontColor = color\n    borderColor = color\n    hoverBackgroundColor = color\n    hoverFontColor = backgroundColor\n  }\n\n  return {\n    'background-color': `${backgroundColor}`,\n    color: `${fontColor}`,\n    'font-family': 'Raleway, Roboto, sans-serif',\n    'border-radius': '0.25em',\n    'border-color': `${borderColor}`,\n    border: '1px solid',\n    cursor: 'pointer',\n    'font-size': '.8em',\n    'text-decoration': 'none',\n    padding: '0.5em 4em',\n    transition: '0.25s all ease-in-out',\n    outline: 'none',\n    '&:hover': {\n      'background-color': `${hoverBackgroundColor}`,\n      color: `${hoverFontColor}`,\n      transition: '0.25s all ease-in-out'\n    }\n  }\n}\n\n/*  Make a button\n *\n * @param dom - the DOM document object\n * @Param iconURI - the URI of the icon to use (if any)\n * @param text - the tooltip text or possibly button contents text\n * @param handler <function> - A handler to called when button is clicked\n *\n * @returns <dDomElement> - the button\n */\nexport function button (dom: HTMLDocument, iconURI: string | undefined, text: string,\n  handler?: (_event: any) => void,\n  options: ButtonWidgetOptions = { buttonColor: 'Primary', needsBorder: false }) {\n  const button = dom.createElement('button')\n  button.setAttribute('type', 'button')\n  // button.innerHTML = text  // later, user preferences may make text preferred for some\n  if (iconURI) {\n    const img = button.appendChild(dom.createElement('img'))\n    img.setAttribute('src', iconURI)\n    img.setAttribute('style', 'width: 2em; height: 2em;') // trial and error. 2em disappears\n    img.title = text\n    button.setAttribute('style', style.buttonStyle)\n  } else {\n    button.textContent = text.toLocaleUpperCase()\n    const style = getButtonStyle(options)\n    const { classes } = getClasses(dom.head, {\n      textButton: style\n    })\n\n    button.classList.add(classes.textButton)\n  }\n  if (handler) {\n    button.addEventListener('click', handler, false)\n  }\n  return button\n}\n\n/*  Make a cancel button\n *\n * @param dom - the DOM document object\n * @param handler <function> - A handler to called when button is clicked\n *\n * @returns <dDomElement> - the button\n */\nexport function cancelButton (dom: HTMLDocument, handler: (_event?: any) => void) {\n  const b = button(dom, cancelIconURI, 'Cancel', handler)\n  if (b.firstChild) { // sigh for tsc\n    (b.firstChild as HTMLElement).style.opacity = '0.3' // Black X is too harsh: current language is grey X\n  }\n  return b\n}\n\n/*  Make a continue button\n *\n * @param dom - the DOM document object\n * @param handler <function> - A handler to called when button is clicked\n *\n * @returns <dDomElement> - the button\n */\nexport function continueButton (dom: HTMLDocument, handler: (_event: any) => void) {\n  return button(dom, checkIconURI, 'Continue', handler)\n}\n\n/* Grab a name for a new thing\n *\n * Form to get the name of a new thing before we create it\n * @params theClass  Misspelt to avoid clashing with the JavaScript keyword\n * @returns: a promise of (a name or null if cancelled)\n */\nexport function askName (\n  dom: HTMLDocument,\n  kb: IndexedFormula,\n  container: HTMLDivElement,\n  predicate?: NamedNode,\n  theClass?: NamedNode,\n  noun?: string) {\n  // eslint-disable-next-line promise/param-names\n  return new Promise(function (resolve, _reject) {\n    const form = dom.createElement('div') // form is broken as HTML behaviour can resurface on js error\n    // classLabel = utils.label(ns.vcard('Individual'))\n    predicate = predicate || ns.foaf('name') // eg 'name' in user's language\n    noun = noun || (theClass ? utils.label(theClass) : '  ') // eg 'folder' in users's language\n    const prompt = noun + ' ' + utils.label(predicate) + ': '\n    form.appendChild(dom.createElement('p')).textContent = prompt\n    const namefield = dom.createElement('input')\n    namefield.setAttribute('type', 'text')\n    namefield.setAttribute('size', '100')\n    namefield.setAttribute('maxLength', '2048') // No arbitrary limits\n    namefield.setAttribute('style', style.textInputStyle)\n    namefield.select() // focus next user input\n    form.appendChild(namefield)\n    container.appendChild(form)\n\n    // namefield.focus()\n\n    function gotName () {\n      ((form as HTMLElement).parentNode as HTMLElement).removeChild(form)\n      resolve(namefield.value.trim())\n    }\n\n    namefield.addEventListener('keyup', function (e) {\n      if (e.keyCode === 13) {\n        gotName()\n      }\n    }, false)\n\n    form.appendChild(dom.createElement('br'))\n\n    form.appendChild(cancelButton(dom, function (_event) {\n      ((form as HTMLElement).parentNode as HTMLElement).removeChild(form)\n      resolve(null)\n    }))\n\n    form.appendChild(continueButton(dom, function (_event) {\n      gotName()\n    }))\n    namefield.focus()\n  }) // Promise\n}\n\n/**\n * A TR to represent a draggable person, etc in a list\n *\n * pred is unused param at the moment\n */\nexport const personTR = renderAsRow // The legacy name is used in a lot of places\n\nexport function renderAsRow (dom: HTMLDocument, pred: NamedNode, obj: NamedNode, options: any): HTMLTableRowElement {\n  const tr = dom.createElement('tr')\n  options = options || {}\n  // tr.predObj = [pred.uri, obj.uri]   moved to acl-control\n  const td1 = tr.appendChild(dom.createElement('td'))\n  const td2 = tr.appendChild(dom.createElement('td'))\n  const td3 = tr.appendChild(dom.createElement('td'))\n\n  // const image = td1.appendChild(dom.createElement('img'))\n  const image = options.image || faviconOrDefault(dom, obj)\n\n  td1.setAttribute('style', 'vertical-align: middle; width:2.5em; padding:0.5em; height: 2.5em;')\n  td2.setAttribute('style', 'vertical-align: middle; text-align:left;')\n  td3.setAttribute('style', 'vertical-align: middle; width:2em; padding:0.5em; height: 4em;')\n  td1.appendChild(image)\n\n  if (options.title) {\n    td2.textContent = options.title\n  } else {\n    setName(td2, obj) // This is async\n  }\n\n  if (options.deleteFunction) {\n    deleteButtonWithCheck(dom, td3, options.noun || 'one', options.deleteFunction)\n  }\n  if (obj.uri) {\n    // blank nodes need not apply\n    if (options.link !== false) {\n      const anchor = td3.appendChild(linkIcon(dom, obj))\n      anchor.classList.add('HoverControlHide')\n      td3.appendChild(dom.createElement('br'))\n    }\n    if (options.draggable !== false) {\n      // default is on\n      image.setAttribute('draggable', 'false') // Stop the image being dragged instead - just the TR\n      makeDraggable(tr, obj)\n    }\n  }\n  ;(tr as any).subject = obj\n  return tr\n}\n\n/* A helper function for renderAsDiv\n*  creates the NameDiv for the person\n*  Note: could not move it to the helper file because they call exported functions\n*  from buttons\n*  @internal exporting this only for unit tests\n*/\nexport function createNameDiv (dom: HTMLDocument, div: HTMLDivElement, title: string | undefined, obj: NamedNode) {\n  const nameDiv = div.appendChild(dom.createElement('div'))\n  if (title) {\n    nameDiv.textContent = title\n  } else {\n    setName(nameDiv, obj) // This is async\n  }\n}\n/* A helper function for renderAsDiv\n*  creates the linkDiv for the person\n*  Note: could not move it to the helper file because they call exported functions\n*  from buttons\n* @internal exporting this only for unit tests\n*/\nexport function createLinkDiv (dom: HTMLDocument, div: HTMLDivElement, obj: NamedNode, options: RenderAsDivOptions) {\n  const linkDiv = div.appendChild(dom.createElement('div'))\n  linkDiv.setAttribute('style', style.linkDivStyle)\n\n  if (options.deleteFunction) {\n    deleteButtonWithCheck(dom, linkDiv, options.noun || 'one', options.deleteFunction)\n  }\n\n  if (obj.uri) {\n    // blank nodes need not apply\n    if (options.link !== false) {\n      createLinkForURI(dom, linkDiv, obj)\n    }\n\n    makeDraggable(div, obj)\n  }\n}\n/**\n * A Div to represent a draggable person, etc in a list\n * configurable to add an onClick listener\n */\nexport function renderAsDiv (dom: HTMLDocument, obj: NamedNode, options: RenderAsDivOptions): HTMLElement {\n  const div = dom.createElement('div')\n  div.setAttribute('style', style.renderAsDivStyle)\n\n  options = options || {}\n  const image = options.image || faviconOrDefault(dom, obj)\n  createImageDiv(dom, div, image)\n  createNameDiv(dom, div, options.title, obj)\n  createLinkDiv(dom, div, obj, options)\n\n  if (options.clickable && options.onClickFunction) {\n    addClickListenerToElement(div, options.onClickFunction)\n  }\n\n  // to be compatible with the SolidOS table layout\n  if (options.wrapInATR) {\n    const tr = wrapDivInATR(dom, div, obj)\n    return tr\n  }\n  return div\n}\n\n/**\n * Refresh a DOM tree recursively\n */\nexport function refreshTree (root: any): void {\n  if (root.refresh) {\n    root.refresh()\n    return\n  }\n  for (let i = 0; i < root.children.length; i++) {\n    refreshTree(root.children[i])\n  }\n}\n\n/**\n * Options argument for [[attachmentList]] function\n */\nexport type attachmentListOptions = {\n  doc?: NamedNode\n  modify?: boolean\n  promptIcon?: string\n  predicate?: NamedNode\n  uploadFolder?: NamedNode\n  noun?: string\n}\n\n/**\n * Component that displays a list of resources, for instance\n * the attachments of a message, or the various documents related\n * to a meeting.\n * Accepts dropping URLs onto it to add attachments to it.\n */\nexport function attachmentList (dom: HTMLDocument, subject: NamedNode, div: HTMLElement, options: attachmentListOptions = {}) {\n  // options = options || {}\n\n  const deleteAttachment = function (target) {\n    if (!kb.updater) {\n      throw new Error('kb has no updater')\n    }\n\n    kb.updater.update(st(subject, predicate, target, doc) as any, [], function (\n      uri,\n      ok,\n      errorBody,\n      _xhr\n    ) {\n      if (ok) {\n        refresh()\n      } else {\n        complain(undefined, 'Error deleting one: ' + errorBody)\n      }\n    })\n  }\n\n  function createNewRow (target) {\n    const theTarget = target\n    const opt: any = { noun }\n    if (modify) {\n      opt.deleteFunction = function () {\n        deleteAttachment(theTarget)\n      }\n    }\n    return personTR(dom, predicate, target, opt)\n  }\n\n  const refresh = function () {\n    const things = kb.each(subject, predicate)\n    things.sort()\n    utils.syncTableToArray(attachmentTable, things, createNewRow)\n  }\n\n  function droppedURIHandler (uris) {\n    const ins: any = []\n    uris.forEach(function (u) {\n      const target = sym(u) // Attachment needs text label to disinguish I think not icon.\n      debug.log('Dropped on attachemnt ' + u) // icon was: iconBase + 'noun_25830.svg'\n      ins.push(st(subject, predicate, target, doc))\n    })\n    if (!kb.updater) {\n      throw new Error('kb has no updater')\n    }\n\n    kb.updater.update([], ins, function (uri, ok, errorBody, _xhr) {\n      if (ok) {\n        refresh()\n      } else {\n        complain(undefined, 'Error adding one: ' + errorBody)\n      }\n    })\n  }\n\n  function droppedFileHandler (files) {\n    uploadFiles(\n      kb.fetcher,\n      files,\n      options.uploadFolder?.uri, // Files\n      options.uploadFolder?.uri, // Pictures\n      function (theFile, destURI) {\n        const ins = [st(subject, predicate, kb.sym(destURI), doc)]\n        if (!kb.updater) {\n          throw new Error('kb has no updater')\n        }\n        kb.updater.update([], ins, function (uri, ok, errorBody, _xhr) {\n          if (ok) {\n            refresh()\n          } else {\n            complain(undefined, 'Error adding link to uploaded file: ' + errorBody)\n          }\n        })\n      }\n    )\n  }\n\n  const doc = options.doc || subject.doc()\n  if (options.modify === undefined) options.modify = true\n  const modify = options.modify\n  const promptIcon: string = options.promptIcon || (iconBase + 'noun_748003.svg' as string) //    target\n  // const promptIcon = options.promptIcon || (iconBase + 'noun_25830.svg') //  paperclip\n  const predicate = options.predicate || ns.wf('attachment')\n  const noun = options.noun || 'attachment'\n\n  const kb = store\n  const attachmentOuter = div.appendChild(dom.createElement('table'))\n  attachmentOuter.setAttribute('style', 'margin-top: 1em; margin-bottom: 1em;')\n  const attachmentOne = attachmentOuter.appendChild(dom.createElement('tr'))\n  const attachmentLeft = attachmentOne.appendChild(dom.createElement('td'))\n  const attachmentRight = attachmentOne.appendChild(dom.createElement('td'))\n  const attachmentTable = attachmentRight.appendChild(dom.createElement('table'))\n  attachmentTable.appendChild(dom.createElement('tr')) // attachmentTableTop\n\n  ;(attachmentOuter as any).refresh = refresh // Participate in downstream changes\n  // ;(attachmentTable as any).refresh = refresh   <- outer should be best?\n\n  refresh()\n\n  if (modify) {\n    // const buttonStyle = 'width; 2em; height: 2em; margin: 0.5em; padding: 0.1em;'\n    const paperclip = button(dom, promptIcon, 'Drop attachments here')\n    // paperclip.style = buttonStyle // @@ needed?  default has white background\n    attachmentLeft.appendChild(paperclip)\n    const fhandler = options.uploadFolder ? droppedFileHandler : null\n    makeDropTarget(paperclip, droppedURIHandler, fhandler) // beware missing the wire of the paparclip!\n    makeDropTarget(attachmentLeft, droppedURIHandler, fhandler) // just the outer won't do it\n\n    if (options.uploadFolder) { // Addd an explicit file upload button as well\n      const buttonDiv = fileUploadButtonDiv(dom, droppedFileHandler)\n      attachmentLeft.appendChild(buttonDiv)\n      // buttonDiv.children[1].style =  buttonStyle\n    }\n  }\n  return attachmentOuter\n}\n\n// /////////////////////////////////////////////////////////////////////////////\n\n/**\n * Event Handler for links within solid apps.\n *\n * Note that native links have constraints in Firefox, they\n * don't work with local files for instance (2011)\n */\nexport function openHrefInOutlineMode (e: Event) {\n  e.preventDefault()\n  e.stopPropagation()\n  const target = utils.getTarget(e)\n  const uri = target.getAttribute('href')\n  if (!uri) return debug.log('openHrefInOutlineMode: No href found!\\n')\n  const dom = window.document\n  if ((dom as any).outlineManager) {\n    // @@ TODO Remove the use of document as a global object\n    // TODO fix dependency cycle to solid-panes by calling outlineManager\n    ;(dom as any).outlineManager.GotoSubject(store.sym(uri), true, undefined, true, undefined)\n  } else if (window && (window as any).panes && (window as any).panes.getOutliner) {\n    // @@ TODO Remove the use of window as a global object\n    ;(window as any).panes\n      .getOutliner()\n      .GotoSubject(store.sym(uri), true, undefined, true, undefined)\n  } else {\n    debug.log('ERROR: Can\\'t access outline manager in this config')\n  }\n  // dom.outlineManager.GotoSubject(store.sym(uri), true, undefined, true, undefined)\n}\n\n/**\n * Make a URI in the Tabulator.org annotation store out of the URI of the thing to be annotated.\n *\n * @@ Todo: make it a personal preference.\n */\nexport function defaultAnnotationStore (subject:NamedNode):NamedNode | undefined {\n  if (subject.uri === undefined) return undefined\n  let s = subject.uri\n  if (s.slice(0, 7) !== 'http://') return undefined\n  s = s.slice(7) // Remove\n  const hash = s.indexOf('#')\n  if (hash >= 0) s = s.slice(0, hash)\n  // Strip trailing\n  else {\n    const slash = s.lastIndexOf('/')\n    if (slash < 0) return undefined\n    s = s.slice(0, slash)\n  }\n  return store.sym('http://tabulator.org/wiki/annnotation/' + s)\n}\n\n/**\n * Retrieve all RDF class URIs from solid-ui's RDF store\n * @returns an object `ret` such that `Object.keys(ret)` is\n * the list of all class URIs.\n */\nexport function allClassURIs (): { [uri: string]: boolean } {\n  const set = {}\n  store\n    .statementsMatching(undefined, ns.rdf('type'), undefined)\n    .forEach(function (st) {\n      if (st.object.value) set[st.object.value] = true\n    })\n  store\n    .statementsMatching(undefined, ns.rdfs('subClassOf'), undefined)\n    .forEach(function (st) {\n      if (st.object.value) set[st.object.value] = true\n      if (st.subject.value) set[st.subject.value] = true\n    })\n  store\n    .each(undefined, ns.rdf('type'), ns.rdfs('Class'))\n    .forEach(function (c) {\n      if (c.value) set[c.value] = true\n    })\n  return set\n}\n\n/**\n * Figuring which properties we know about\n *\n * When the user inputs an RDF property, like for a form field\n * or when specifying the relationship between two arbitrary things,\n * then er can prompt them with properties the session knows about\n *\n * TODO: Look again by catching this somewhere. (On the kb?)\n * TODO: move to diff module? Not really a button.\n * @param {Store} kb The quadstore to be searched.\n */\n\nexport function propertyTriage (kb: IndexedFormula): any {\n  const possibleProperties: any = {}\n  // if (possibleProperties === undefined) possibleProperties = {}\n  // const kb = store\n  const dp = {}\n  const op = {}\n  let no = 0\n  let nd = 0\n  let nu = 0\n  const pi = (kb as any).predicateIndex // One entry for each pred\n  for (const p in pi) {\n    const object = pi[p][0].object\n    if (object.termType === 'Literal') {\n      dp[p] = true\n      nd++\n    } else {\n      op[p] = true\n      no++\n    }\n  } // If nothing discovered, then could be either:\n  const ps = kb.each(undefined, ns.rdf('type'), ns.rdf('Property'))\n  for (let i = 0; i < ps.length; i++) {\n    const p = ps[i].toNT()\n    if (!op[p] && !dp[p]) {\n      dp[p] = true\n      op[p] = true\n      nu++\n    }\n  }\n  possibleProperties.op = op\n  possibleProperties.dp = dp\n  info(`propertyTriage: ${no} non-lit, ${nd} literal. ${nu} unknown.`)\n  return possibleProperties\n}\n\n/**\n * General purpose widgets\n */\n\n/**\n * A button for jumping\n */\nexport function linkButton (dom: HTMLDocument, object: NamedNode): HTMLElement {\n  const b = dom.createElement('button')\n  b.setAttribute('type', 'button')\n  b.textContent = 'Goto ' + utils.label(object)\n  b.addEventListener('click', function (_event) {\n    // b.parentNode.removeChild(b)\n    // TODO fix dependency cycle to solid-panes by calling outlineManager\n    ;(dom as any).outlineManager.GotoSubject(object, true, undefined, true, undefined)\n  }, true)\n  return b\n}\n\n/**\n * A button to remove some other element from the page\n */\nexport function removeButton (dom: HTMLDocument, element: HTMLElement) {\n  const b = dom.createElement('button')\n  b.setAttribute('type', 'button')\n  b.textContent = '✕' // MULTIPLICATION X\n  b.addEventListener('click', function (_event) {\n    ;(element as any).parentNode.removeChild(element)\n  }, true)\n  return b\n}\n\n//      Description text area\n//\n// Make a box to demand a description or display existing one\n//\n// @param dom - the document DOM for the user interface\n// @param kb - the graph which is the knowledge base we are working with\n// @param subject - a term, the subject of the statement(s) being edited.\n// @param predicate - a term, the predicate of the statement(s) being edited\n// @param store - The web document being edited\n// @param callbackFunction - takes (boolean ok, string errorBody)\n\n// /////////////////////////////////////// Random I/O widgets /////////////\n\n// ////              Column Header Buttons\n//\n//  These are for selecting different modes, sources,styles, etc.\n//\n/*\nbuttons.headerButtons = function (dom, kb, name, words) {\n    const box = dom.createElement('table')\n    var i, word, s = '<tr>'\n    box.setAttribute('style', 'width: 90%; height: 1.5em')\n    for (i=0; i<words.length; i++) {\n        s += '<td><input type=\"radio\" name=\"' + name + '\" id=\"' + words[i] + '\" value='\n    }\n    box.innerHTML = s + '</tr>'\n\n}\n*/\n// ////////////////////////////////////////////////////////////\n//\n//     selectorPanel\n//\n//  A vertical panel for selecting connections to left or right.\n//\n//   @param inverse means this is the object rather than the subject\n//\nexport function selectorPanel (\n  dom: HTMLDocument,\n  kb: IndexedFormula,\n  type: NamedNode,\n  predicate: NamedNode,\n  inverse: boolean,\n  possible: NamedNode[],\n  options: { connectIcon?: string },\n  callbackFunction: (_x: NamedNode, _e: Event, _selected: boolean) => void,\n  linkCallback: (_x: NamedNode, _e: Event, _inverse: boolean, _setStyleFunction: () => void) => void\n) {\n  return selectorPanelRefresh(\n    dom.createElement('div'),\n    dom,\n    kb,\n    type,\n    predicate,\n    inverse,\n    possible,\n    options,\n    callbackFunction,\n    linkCallback\n  )\n}\n\nexport function selectorPanelRefresh (\n  list: HTMLElement,\n  dom: HTMLDocument,\n  kb: IndexedFormula,\n  type: NamedNode,\n  predicate: NamedNode,\n  inverse: boolean,\n  possible: NamedNode[],\n  options: { connectIcon?: string },\n  callbackFunction: (_x: NamedNode, _e: Event, _selected: boolean) => void,\n  linkCallback: (_x: NamedNode, _e: Event, _inverse: boolean, _setStyleFunction: () => void) => void\n) {\n  const style0 =\n    'border: 0.1em solid #ddd; border-bottom: none; width: 95%; height: 2em; padding: 0.5em;'\n  let selected: any = null\n  list.innerHTML = ''\n\n  const refreshItem = function (box: HTMLElement, x: NamedNode) {\n    // Scope to hold item and x\n    let item: any\n    // eslint-disable-next-line prefer-const\n    let image: HTMLImageElement\n\n    const setStyle = function () {\n      const already = inverse\n        ? kb.each(undefined, predicate, x)\n        : kb.each(x, predicate)\n      iconDiv.setAttribute('class', already.length === 0 ? 'hideTillHover' : '') // See tabbedtab.css\n      image.setAttribute(\n        'src',\n        options.connectIcon || iconBase + 'noun_25830.svg'\n      )\n      image.setAttribute('title', already.length ? already.length : 'attach' as any)\n    }\n    const f = index.twoLine.widgetForClass(type)\n    // eslint-disable-next-line prefer-const\n    item = f(dom, x)\n    item.setAttribute('style', style0)\n\n    const nav = dom.createElement('div')\n    nav.setAttribute('class', 'hideTillHover') // See tabbedtab.css\n    nav.setAttribute('style', 'float:right; width:10%')\n\n    const a = dom.createElement('a')\n    a.setAttribute('href', x.uri)\n    a.setAttribute('style', 'float:right')\n    nav.appendChild(a).textContent = '>'\n    box.appendChild(nav)\n\n    const iconDiv = dom.createElement('div')\n    iconDiv.setAttribute(\n      'style',\n      (inverse ? 'float:left;' : 'float:right;') + ' width:30px;'\n    )\n    image = dom.createElement('img')\n    setStyle()\n    iconDiv.appendChild(image)\n    box.appendChild(iconDiv)\n\n    item.addEventListener('click', function (event) {\n      if (selected === item) {\n        // deselect\n        item.setAttribute('style', style0)\n        selected = null\n      } else {\n        if (selected) selected.setAttribute('style', style0)\n        item.setAttribute(\n          'style',\n          style0 + 'background-color: #ccc; color:black;'\n        )\n        selected = item\n      }\n      callbackFunction(x, event, selected === item)\n      setStyle()\n    }, false)\n\n    image.addEventListener('click', function (event) {\n      linkCallback(x, event, inverse, setStyle)\n    }, false)\n\n    box.appendChild(item)\n    return box\n  }\n\n  for (let i = 0; i < possible.length; i++) {\n    const box = dom.createElement('div')\n    list.appendChild(box)\n    refreshItem(box, possible[i])\n  }\n  return list\n}\n\n// ###########################################################################\n//\n//      Small compact views of things\n//\nexport let index: any = {}\n// ///////////////////////////////////////////////////////////////////////////\n// We need these for anything which is a subject of an attachment.\n//\n// These should be moved to type-dependeent UI code. Related panes maybe\n\nfunction twoLineDefault (dom: HTMLDocument, x: NamedNode): HTMLElement {\n  // Default\n  const box = dom.createElement('div')\n  box.textContent = utils.label(x)\n  return box\n}\n\n/**\n * Find a function that can create a widget for a given class\n * @param c The RDF class for which we want a widget generator function\n */\nfunction twoLineWidgetForClass (c: NamedNode): (_dom: HTMLDocument, _x: NamedNode) => HTMLElement {\n  let widget = index.twoLine[c.uri]\n  const kb = store\n  if (widget) return widget\n  const sup = kb.findSuperClassesNT(c)\n  for (const cl in sup) {\n    widget = index.twoLine[kb.fromNT(cl).uri]\n    if (widget) return widget\n  }\n  return index.twoLine['']\n}\n\n/**\n * Display a transaction\n * @param x Should have attributes through triples in store:\n *          * ns.qu('payee') -> a named node\n *          * ns.qu('date) -> a literal\n *          * ns.qu('amount') -> a literal\n */\nfunction twoLineTransaction (dom: HTMLDocument, x: NamedNode): HTMLElement {\n  let failed = ''\n  const enc = function (p) {\n    const y = store.any(x, ns.qu(p))\n    if (!y) failed += '@@ No value for ' + p + '! '\n    return y ? utils.escapeForXML(y.value) : '?' // @@@@\n  }\n  const box = dom.createElement('table')\n  box.innerHTML = `\n      <tr>\n      <td colspan=\"2\"> ${enc('payee')}</td>\n      < /tr>\n      < tr >\n      <td>${enc('date').slice(0, 10)}</td>\n      <td style = \"text-align: right;\">${enc('amount')}</td>\n      </tr>`\n  if (failed) {\n    box.innerHTML = `\n      <tr>\n        <td><a href=\"${utils.escapeForXML(x.uri)}\">${utils.escapeForXML(failed)}</a></td>\n      </tr>`\n  }\n  return box\n}\n\n/**\n * Display a trip\n * @param x Should have attributes through triples in store:\n *          * ns.dc('title') -> a literal\n *          * ns.cal('dtstart') -> a literal\n *          * ns.cal('dtend') -> a literal\n */\nfunction twoLineTrip (\n  dom: HTMLDocument,\n  x: NamedNode\n): HTMLElement {\n  const enc = function (p) {\n    const y = store.any(x, p)\n    return y ? utils.escapeForXML(y.value) : '?'\n  }\n  const box = dom.createElement('table')\n  box.innerHTML = `\n    <tr>\n      <td colspan=\"2\">${enc(ns.dc('title'))}</td>\n    </tr>\n    <tr style=\"color: #777\">\n      <td>${enc(ns.cal('dtstart'))}</td>\n      <td>${enc(ns.cal('dtend'))}</td>\n    </tr>`\n  return box\n}\n\n/**\n * Stick a stylesheet link the document if not already there\n */\nexport function addStyleSheet (dom: HTMLDocument, href: string): void {\n  const links = dom.querySelectorAll('link')\n  for (let i = 0; i < links.length; i++) {\n    if (\n      (links[i].getAttribute('rel') || '') === 'stylesheet' &&\n      (links[i].getAttribute('href') || '') === href\n    ) {\n      return\n    }\n  }\n  const link = dom.createElement('link')\n  link.setAttribute('rel', 'stylesheet')\n  link.setAttribute('type', 'text/css')\n  link.setAttribute('href', href)\n  dom.getElementsByTagName('head')[0].appendChild(link)\n}\n\n// Figure (or guess) whether this is an image, etc\n//\nexport function isAudio (file?: NamedNode) {\n  return isImage(file, 'audio')\n}\nexport function isVideo (file?: NamedNode) {\n  return isImage(file, 'video')\n}\n/**\n *\n */\nexport function isImage (file?: NamedNode, kind?: string): boolean {\n  const dcCLasses = {\n    audio: 'http://purl.org/dc/dcmitype/Sound',\n    image: 'http://purl.org/dc/dcmitype/Image',\n    video: 'http://purl.org/dc/dcmitype/MovingImage'\n  }\n  const what = kind || 'image'\n  // See https://github.com/linkeddata/rdflib.js/blob/e367d5088c/src/formula.ts#L554\n  //\n  const typeURIs = store.findTypeURIs(file as any)\n  // See https://github.com/linkeddata/rdflib.js/blob/d5000f/src/utils-js.js#L14\n  // e.g.'http://www.w3.org/ns/iana/media-types/audio'\n  const prefix: string = Util.mediaTypeClass(what + '/*').uri.split('*')[0]\n  for (const t in typeURIs) {\n    if (t.startsWith(prefix)) return true\n  }\n  if (dcCLasses[what] in typeURIs) return true\n  return false\n}\n\n/**\n * File upload button\n * @param dom The DOM aka document\n * @param  droppedFileHandler Same handler function as drop, takes array of file objects\n * @returns {Element} - a div with a button and a inout in it\n * The input is hidden, as it is uglky - the user clicks on the nice icons and fires the input.\n */\n// See https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications\nexport function fileUploadButtonDiv (\n  dom: HTMLDocument,\n  droppedFileHandler: (_files: FileList) => void\n) {\n  const div = dom.createElement('div')\n  const input = div.appendChild(dom.createElement('input'))\n  input.setAttribute('type', 'file')\n  input.setAttribute('multiple', 'true')\n  input.addEventListener(\n    'change',\n    (event: any) => {\n      debug.log('File drop event: ', event)\n      if (event.files) {\n        droppedFileHandler(event.files)\n      } else if (event.target && event.target.files) {\n        droppedFileHandler(event.target.files)\n      } else {\n        alert('Sorry no files .. internal error?')\n      }\n    },\n    false\n  )\n\n  ;(input as any).style = 'display:none'\n  const buttonElt = div.appendChild(\n    button(\n      dom,\n      iconBase + 'noun_Upload_76574_000000.svg',\n      'Upload files',\n      _event => {\n        input.click()\n      }\n    )\n  )\n  makeDropTarget(buttonElt, null, droppedFileHandler) // Can also just drop on button\n  return div\n}\n\nindex = {\n  line: { // Approx 80em\n  },\n  twoLine: { // Approx 40em * 2.4em\n    '': twoLineDefault,\n    'http://www.w3.org/2000/10/swap/pim/qif#Transaction': twoLineTransaction,\n    'http://www.w3.org/ns/pim/trip#Trip': twoLineTrip,\n    widgetForClass: twoLineWidgetForClass\n  }\n}\n"],"mappings":"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"}
{"version":3,"sources":["../src/tabs.ts"],"names":["ContainerElement","HTMLElement","TabWidgetElement","TabElement","tabWidget","options","subject","dom","document","orientation","parseInt","backgroundColor","flipped","vertical","onClose","getColors","selectedColor","color","bodyMainStyle","rootElement","createElement","setAttribute","navElement","appendChild","mainElement","tabContainer","tabElement","bodyContainer","corners","cornersPrepped","concat","slice","cornersStyle","join","margins","marginsPrepped","marginsStyle","paddingStyle","tabStyle","unselectedStyle","selectedStyle","shownStyle","hiddenStyle","refresh","orderedSync","startEmpty","children","length","selectedTab","selectedTab0","Array","from","map","tab","firstChild","find","dataset","name","selectedTabURI","uri","selectedTab1","clickMe","click","addCancelButton","onCloseSet","existingCancelButton","querySelector","removeChild","extraTab","classList","add","tabCancelButton","getAttribute","getItems","items","ordered","store","the","predicate","elements","each","makeNewSlot","item","ele","div","addEventListener","e","metaKey","resetTabStyle","resetBodyStyle","bodyTR","bodyMain","getOrCreateContainerElement","renderTabSettings","altKey","asSettings","innerHTML","renderMain","renderTab","textContent","newBodyMain","slot","i","j","left","right","differ","sameTerm","insertables","newSlot","newBodyDiv","insertBefore","contains","isLight","colorBlend","a","b","mix","ca","cb","res","str","hex","res2","split","h","l","x","total"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAEA;;;;;;AAEA;AACA;AACA;IACMA,gB;;;;;;;;;;;;;;;;;;;;kDAAyBC,W;;IAoBlBC,gB;;;;;;;;;;;;;;;;;;;;;;kDAAyBD,W;AAMtC;AACA;AACA;;;;;IACME,U;;;;;;;;;;;;;;;;;;;;;kDAAmBF,W;AAKzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACO,SAASG,SAAT,CAAoBC,OAApB,EAA+C;AACpD,MAAMC,OAAO,GAAGD,OAAO,CAACC,OAAxB;AACA,MAAMC,GAAG,GAAGF,OAAO,CAACE,GAAR,IAAeC,QAA3B;AACA,MAAMC,WAAW,GAAGC,QAAQ,CAACL,OAAO,CAACI,WAAR,IAAuB,GAAxB,CAA5B;AACA,MAAME,eAAe,GAAGN,OAAO,CAACM,eAAR,IAA2B,SAAnD;AACA,MAAMC,OAAO,GAAGH,WAAW,GAAG,CAA9B;AACA,MAAMI,QAAQ,GAAGJ,WAAW,GAAG,CAA/B;AACA,MAAMK,OAAO,GAAGT,OAAO,CAACS,OAAxB;;AAEA,mBAA+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","sourcesContent":["import { cancelButton } from './widgets'\nimport { label } from './utils'\nimport { NamedNode } from 'rdflib'\nimport { store } from 'solid-logic'\n\n/**\n * @ignore\n */\nclass ContainerElement extends HTMLElement {\n  asSettings?: boolean\n}\n\ntype TabWidgetOptions = {\n  backgroundColor?: string\n  dom?: HTMLDocument\n  items?: Array<NamedNode>\n  onClose?: (event: Event) => void\n  ordered?: boolean\n  orientation?: '0' | '1' | '2' | '3'\n  predicate?: NamedNode\n  renderMain?: (bodyMain: HTMLElement, subject: NamedNode) => void\n  renderTab?: (tabDiv: HTMLDivElement, subject: NamedNode) => void\n  renderTabSettings?: (bodyMain: ContainerElement, subject: NamedNode) => void\n  selectedTab?: NamedNode\n  startEmpty?: boolean\n  subject?: NamedNode\n}\n\nexport class TabWidgetElement extends HTMLElement {\n  bodyContainer?: HTMLElement\n  refresh?: () => void\n  tabContainer?: HTMLElement\n}\n\n/**\n * @ignore\n */\nclass TabElement extends HTMLElement {\n  bodyTR?: HTMLElement\n  subject?: NamedNode\n}\n\n/**\n * Use this widget to generate tabs from triples set in the global store.\n *\n * [Here you can see examples of the tabs](https://solid.github.io/solid-ui/examples/tabs/).\n *\n * It assumes that items to use for tabs will be in a collection by default,\n * e.g.:\n *\n * ```turtle\n * :subject :predicate ( :item1 :item2 ) .\n * ```\n *\n * You can override this by setting `ordered: false`, in which case it expects\n * unordered triples:\n *\n * ```turtle\n * :subject :predicate :item1, :item 2 .\n * ```\n *\n * Triples that are not ordered in collection are in principle not sorted,\n * which means that tabs could change order every time you render the widget.\n * But in this case the widget will try to sort it in order to keep it\n * consistent.\n *\n * In both of these cases you need to define options `subject` and `predicate`\n * to tell the widget which triples it should be looking for.\n *\n * Finally you can set items manually, using the `items` option, e.g.:\n *\n * ```javascript\n * {\n *   items: [\n *     namedNode('https://domain.tld/#item1'),\n *     namedNode('https://domain.tld/#item2')\n *   ]\n * }\n * ```\n *\n * When you set items manually you do not need to set `subject` and\n * `predicate`.\n *\n * In any case you probably want to set the renderMain option to specify\n * what should be rendered for the various items, e.g.:\n *\n * ```javascript\n * {\n *   renderMain: (bodyMain, subject) => {\n *     bodyMain.innerHTML = renderItem(subject)\n *   }\n * }\n * ```\n *\n * **Note:** `renderItem` is a custom function that you need to define yourself.\n *\n * The option `renderTabSettings` allows you to render a custom view in the\n * body container that is shown when you hold the ALT key and click on a\n * tab. It works very much like the `renderMain` option:\n *\n * ```javascript\n * {\n *   renderTabSettings: (bodyMain, subject) => {\n *     bodyMain.innerHTML = renderTabSettings(subject)\n *   }\n * }\n * ```\n *\n * **Note:** `renderTabSettings` is a custom function that you need to define\n * yourself.\n *\n * By default the widget will try to guess the label by using the\n * [[utils.label]] function. If you want to customize this yourself, you can\n * use the `renderTab` option:\n *\n * ```javascript\n * {\n *   renderTab: (tabDiv, subject) => {\n *     tabDiv.innerText = renderTabText(subject)\n *   }\n * }\n * ```\n *\n * **Note:** `renderTabText` is a custom function you need to define yourself.\n *\n * The option renderTab is also important if you want to set which tab should\n * be selected once the widget is rendered. By default it will simply select\n * the first tab, but you can override by setting `dataset.name` on the tab\n * and referring to the same string in `selectedTab`:\n *\n * ```javascript\n * {\n *   renderTab: (tabDiv, subject)  => {\n *     tabDiv.dataset.name = subject.uri\n *   },\n *   selectedTab: item2.uri\n * }\n * ```\n *\n * You can apply a color to use for tabs and border of the container by using\n * option `background-color`. This is #ddddcc by default.\n *\n * You can override the document object that the widget uses to generate DOM\n * elements by setting the option `dom`. This is encouraged to set if you\n * intend your functionality to be used in environments that don't provide\n * a global `document` object.\n *\n * If you want to render a close button next to the tabs you can set option\n * `onClose` which takes a callback function that is triggered when the\n * button is clicked:\n *\n * ```javascript\n * {\n *   onClose: (event) => {\n *     // do something that hides the widget altogether\n *   }\n * }\n * ```\n *\n * The option `orientation` allows you to set which side the tabs should be\n * located: `'0'` = Top, `'1'` = Left, `'2'` = Bottom, `'3'` = Right\n *\n * If you don't want to render anything in the body container by default,\n * you can set the option `startEmpty` to `true`.\n *\n * @param options\n */\nexport function tabWidget (options: TabWidgetOptions) {\n  const subject = options.subject\n  const dom = options.dom || document\n  const orientation = parseInt(options.orientation || '0')\n  const backgroundColor = options.backgroundColor || '#ddddcc'\n  const flipped = orientation & 2\n  const vertical = orientation & 1\n  const onClose = options.onClose\n\n  const [selectedColor, color] = getColors(backgroundColor)\n  const bodyMainStyle = `flex: 2; width: auto; height: 100%; border: 0.1em; border-style: solid; border-color: ${selectedColor}; padding: 1em;`\n  const rootElement: TabWidgetElement = dom.createElement('div') // 20200117a\n\n  rootElement.setAttribute('style', 'display: flex; height: 100%; width: 100%; flex-direction: ' +\n    (vertical ? 'row' : 'column') + (flipped ? '-reverse;' : ';'))\n\n  const navElement = rootElement.appendChild(dom.createElement('nav'))\n  navElement.setAttribute('style', 'margin: 0;')\n\n  const mainElement = rootElement.appendChild(dom.createElement('main'))\n\n  mainElement.setAttribute('style', 'margin: 0; width:100%; height: 100%;') // override tabbedtab.css\n  const tabContainer = navElement.appendChild(dom.createElement('ul'))\n  tabContainer.setAttribute('style', `\n    list-style-type: none;\n    display: flex;\n    height: 100%;\n    width: 100%;\n    margin: 0;\n    padding: 0;\n    flex-direction: ${(vertical ? 'column' : 'row')}\n  `)\n\n  const tabElement = 'li'\n\n  const bodyContainer = mainElement\n  rootElement.tabContainer = tabContainer\n  rootElement.bodyContainer = bodyContainer\n\n  const corners = ['0.2em', '0.2em', '0', '0'] // top left, TR, BR, BL\n  const cornersPrepped = corners.concat(corners).slice(orientation, orientation + 4)\n  const cornersStyle = `border-radius: ${cornersPrepped.join(' ')};`\n\n  const margins = ['0.3em', '0.3em', '0', '0.3em'] // top, right, bottom, left\n  const marginsPrepped = margins.concat(margins).slice(orientation, orientation + 4)\n  const marginsStyle = `margin: ${marginsPrepped.join(' ')};`\n\n  const paddingStyle = `padding: ${marginsPrepped.join(' ')};`\n\n  const tabStyle = cornersStyle + `padding: 0.7em; max-width: 20em; color: ${color};`\n  const unselectedStyle = `${tabStyle + marginsStyle}opacity: 50%; background-color: ${backgroundColor};`\n  const selectedStyle = `${tabStyle + marginsStyle}background-color: ${selectedColor};`\n  const shownStyle = 'height: 100%; width: 100%;'\n  const hiddenStyle = shownStyle + 'display: none;'\n  rootElement.refresh = orderedSync\n  orderedSync()\n\n  if (!options.startEmpty && tabContainer.children.length && options.selectedTab) {\n    const selectedTab0 = Array.from(tabContainer.children) // Version left for compatability with ??\n      .map(tab => tab.firstChild as HTMLElement)\n      .find(tab => tab.dataset.name === options.selectedTab)\n\n    const selectedTabURI = options.selectedTab.uri\n    const selectedTab1 = Array.from(tabContainer.children)\n      // @ts-ignore\n      .find(tab => (tab as TabElement).subject && (tab as TabElement).subject.uri && (tab as TabElement).subject.uri === selectedTabURI)\n\n    const tab = selectedTab1 || selectedTab0 || tabContainer.children[0] as HTMLButtonElement\n    const clickMe = tab.firstChild\n    // @ts-ignore\n    if (clickMe) clickMe.click()\n  } else if (!options.startEmpty) {\n    (tabContainer.children[0].firstChild as HTMLButtonElement).click() // Open first tab\n  }\n  return rootElement\n\n  function addCancelButton (tabContainer) {\n    if (tabContainer.dataset.onCloseSet) {\n      // @@ TODO: this is only here to make the browser tests work\n      // Discussion at https://github.com/solid/solid-ui/pull/110#issuecomment-527080663\n      const existingCancelButton = tabContainer.querySelector('.unstyled')\n      tabContainer.removeChild(existingCancelButton)\n    }\n    const extraTab = dom.createElement(tabElement)\n    extraTab.classList.add('unstyled')\n    const tabCancelButton = cancelButton(dom, onClose)\n    tabCancelButton.setAttribute('style', tabCancelButton.getAttribute('style') + paddingStyle)\n    extraTab.appendChild(tabCancelButton)\n    tabContainer.appendChild(extraTab)\n    tabContainer.dataset.onCloseSet = 'true'\n  }\n\n  function getItems (): Array<NamedNode> {\n    if (options.items) return options.items\n    if (options.ordered !== false) {\n      // options.ordered defaults to true\n      return (store.the(subject, options.predicate) as any).elements\n    } else {\n      return store.each(subject, options.predicate) as any\n    }\n  }\n\n  function makeNewSlot (item: NamedNode) {\n    const ele = dom.createElement(tabElement) as TabElement\n    ele.subject = item\n    const div = ele.appendChild(dom.createElement('div'))\n    div.setAttribute('style', unselectedStyle)\n\n    div.addEventListener('click', function (e) {\n      if (!e.metaKey) {\n        resetTabStyle()\n        resetBodyStyle()\n      }\n      div.setAttribute('style', selectedStyle)\n      if (!ele.bodyTR) return\n      ele.bodyTR.setAttribute('style', shownStyle)\n      const bodyMain = getOrCreateContainerElement(ele)\n      if (options.renderTabSettings && e.altKey && ele.subject && bodyMain.asSettings !== true) {\n        bodyMain.innerHTML = 'loading settings ...' + item\n        options.renderTabSettings(bodyMain, ele.subject)\n        bodyMain.asSettings = true\n      } else if (options.renderMain && ele.subject && bodyMain.asSettings !== false) {\n        bodyMain.innerHTML = 'loading item ...' + item\n        options.renderMain(bodyMain, ele.subject)\n        bodyMain.asSettings = false\n      }\n    })\n\n    if (options.renderTab) {\n      options.renderTab(div, item)\n    } else {\n      div.textContent = label(item)\n    }\n    return ele\n\n    function getOrCreateContainerElement (ele: TabElement): ContainerElement {\n      const bodyMain = ele.bodyTR?.children[0] as ContainerElement\n      if (bodyMain) return bodyMain\n      const newBodyMain = ele.bodyTR!.appendChild(dom.createElement('main'))\n      newBodyMain.setAttribute('style', bodyMainStyle)\n      return newBodyMain\n    }\n  }\n\n  // @@ Use common one from utils?\n  function orderedSync () {\n    const items = getItems()\n    let slot: TabElement, i, j, left, right\n    let differ = false\n    // Find how many match at each end\n    for (left = 0; left < tabContainer.children.length; left++) {\n      slot = tabContainer.children[left] as TabElement\n      if (\n        left >= items.length ||\n        (slot.subject && !slot.subject.sameTerm(items[left]))\n      ) {\n        differ = true\n        break\n      }\n    }\n    if (!differ && items.length === tabContainer.children.length) {\n      return // The two just match in order: a case to optimize for\n    }\n    for (right = tabContainer.children.length - 1; right >= 0; right--) {\n      slot = tabContainer.children[right] as TabElement\n      j = right - tabContainer.children.length + items.length\n      if (slot.subject && !slot.subject.sameTerm(items[j])) {\n        break\n      }\n    }\n    // The elements left ... right in tabContainer.children do not match\n    const insertables = items.slice(left, right - tabContainer.children.length + items.length + 1)\n    while (right >= left) {\n      // remove extra\n      tabContainer.removeChild(tabContainer.children[left])\n      bodyContainer.removeChild(bodyContainer.children[left])\n      right -= 1\n    }\n    for (i = 0; i < insertables.length; i++) {\n      const newSlot = makeNewSlot(insertables[i])\n      const newBodyDiv = dom.createElement('div')\n      newSlot.bodyTR = newBodyDiv\n      if (left === tabContainer.children.length) {\n        // None left of original on right\n        tabContainer.appendChild(newSlot)\n        bodyContainer.appendChild(newBodyDiv)\n      } else {\n        tabContainer.insertBefore(newSlot, tabContainer.children[left + i])\n        bodyContainer.insertBefore(newBodyDiv, bodyContainer.children[left + i])\n      }\n    }\n    if (onClose) {\n      addCancelButton(tabContainer)\n    }\n  }\n\n  function resetTabStyle () {\n    for (let i = 0; i < tabContainer.children.length; i++) {\n      const tab = tabContainer.children[i]\n      if (tab.classList.contains('unstyled')) {\n        continue\n      }\n      if (tab.children[0]) {\n        tab.children[0].setAttribute('style', unselectedStyle)\n      }\n    }\n  }\n\n  function resetBodyStyle () {\n    for (let i = 0; i < bodyContainer.children.length; i++) {\n      bodyContainer.children[i].setAttribute('style', hiddenStyle)\n    }\n  }\n}\n\n/**\n * @internal\n */\nfunction getColors (backgroundColor: string): [string, string] {\n  return isLight(backgroundColor)\n    ? [colorBlend(backgroundColor, '#ffffff', 0.3), '#000000']\n    : [colorBlend(backgroundColor, '#000000', 0.3), '#ffffff']\n}\n\n/**\n * @internal\n */\nfunction colorBlend (a: string, b: string, mix: number): string {\n  let ca, cb, res\n  let str = '#'\n  const hex = '0123456789abcdef'\n  for (let i = 0; i < 3; i++) {\n    ca = parseInt(a.slice(i * 2 + 1, i * 2 + 3), 16)\n    cb = parseInt(b.slice(i * 2 + 1, i * 2 + 3), 16)\n    res = ca * (1.0 - mix) + cb * mix // @@@ rounding\n    const res2 = parseInt(('' + res).split('.')[0]) // @@ ugh\n    const h = parseInt(('' + res2 / 16).split('.')[0]) // @@ ugh\n    const l = parseInt(('' + (res2 % 16)).split('.')[0]) // @@ ugh\n    str += hex[h] + hex[l]\n  }\n  return str\n}\n\n/**\n * @internal\n */\nfunction isLight (x: string): boolean {\n  let total = 0\n  for (let i = 0; i < 3; i++) {\n    total += parseInt(x.slice(i * 2 + 1, i * 2 + 3), 16)\n  }\n  return total > 128 * 3\n}\n"],"file":"tabs.js"}
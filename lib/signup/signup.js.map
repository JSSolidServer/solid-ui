{"version":3,"file":"signup.js","names":["Signup","config","defaultConfig","prototype","listen","promise","Promise","resolve","reject","eventMethod","window","addEventListener","eventListener","messageEvent","e","u","data","slice","user","length","signup","signupUrl","signupEndpoint","width","signupWindowWidth","height","signupWindowHeight","leftPosition","screen","topPosition","windowTitle","windowUrl","encodeURIComponent","location","origin","windowSpecs","open","self","then","webid"],"sources":["../../src/signup/signup.js"],"sourcesContent":["import defaultConfig from './config-default'\n\n/**\n * Provides functionality for signing up with a Solid provider\n * @module signup\n */\n\n/**\n * Creates a Signup UI manager\n * @class\n */\nexport function Signup (config) {\n  this.config = config || defaultConfig\n}\n\n/**\n * Sets up an event listener to monitor login messages from child window/iframe\n * @method listen\n * @return {Promise<String>} Event listener promise, resolves to user's WebID\n */\nSignup.prototype.listen = function listen () {\n  const promise = new Promise(function (resolve, reject) {\n    const eventMethod = window.addEventListener\n      ? 'addEventListener'\n      : 'attachEvent'\n    const eventListener = window[eventMethod]\n    const messageEvent = eventMethod === 'attachEvent'\n      ? 'onmessage'\n      : 'message'\n    eventListener(messageEvent, function (e) {\n      const u = e.data\n      if (u.slice(0, 5) === 'User:') {\n        const user = u.slice(5, u.length)\n        if (user && user.length > 0 && user.slice(0, 4) === 'http') {\n          return resolve(user)\n        } else {\n          return reject(user)\n        }\n      }\n    }, true)\n  })\n  return promise\n}\n\n/**\n * Opens a signup popup window, sets up `listen()`.\n * @method signup\n * @static\n * @param signupUrl {String} Location of a Solid server for user signup.\n * @return {Promise<String>} Returns a listener promise, resolves with signed\n *   up user's WebID.\n */\nSignup.prototype.signup = function signup (signupUrl) {\n  signupUrl = signupUrl || this.config.signupEndpoint\n  const width = this.config.signupWindowWidth\n  const height = this.config.signupWindowHeight\n  // set borders\n  const leftPosition = (window.screen.width / 2) - ((width / 2) + 10)\n  // set title and status bars\n  const topPosition = (window.screen.height / 2) - ((height / 2) + 50)\n  const windowTitle = 'Solid signup'\n  const windowUrl = signupUrl + '?origin=' +\n    encodeURIComponent(window.location.origin)\n  const windowSpecs = 'resizable,scrollbars,status,width=' + width + ',height=' +\n    height + ',left=' + leftPosition + ',top=' + topPosition\n  window.open(windowUrl, windowTitle, windowSpecs)\n  const self = this\n  return new Promise(function (resolve) {\n    self.listen()\n      .then(function (webid) {\n        return resolve(webid)\n      })\n  })\n}\n"],"mappings":";;;;;;;;;AAAA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACO,SAASA,MAAT,CAAiBC,MAAjB,EAAyB;EAC9B,KAAKA,MAAL,GAAcA,MAAM,IAAIC,yBAAxB;AACD;AAED;AACA;AACA;AACA;AACA;;;AACAF,MAAM,CAACG,SAAP,CAAiBC,MAAjB,GAA0B,SAASA,MAAT,GAAmB;EAC3C,IAAMC,OAAO,GAAG,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;IACrD,IAAMC,WAAW,GAAGC,MAAM,CAACC,gBAAP,GAChB,kBADgB,GAEhB,aAFJ;IAGA,IAAMC,aAAa,GAAGF,MAAM,CAACD,WAAD,CAA5B;IACA,IAAMI,YAAY,GAAGJ,WAAW,KAAK,aAAhB,GACjB,WADiB,GAEjB,SAFJ;IAGAG,aAAa,CAACC,YAAD,EAAe,UAAUC,CAAV,EAAa;MACvC,IAAMC,CAAC,GAAGD,CAAC,CAACE,IAAZ;;MACA,IAAID,CAAC,CAACE,KAAF,CAAQ,CAAR,EAAW,CAAX,MAAkB,OAAtB,EAA+B;QAC7B,IAAMC,IAAI,GAAGH,CAAC,CAACE,KAAF,CAAQ,CAAR,EAAWF,CAAC,CAACI,MAAb,CAAb;;QACA,IAAID,IAAI,IAAIA,IAAI,CAACC,MAAL,GAAc,CAAtB,IAA2BD,IAAI,CAACD,KAAL,CAAW,CAAX,EAAc,CAAd,MAAqB,MAApD,EAA4D;UAC1D,OAAOV,OAAO,CAACW,IAAD,CAAd;QACD,CAFD,MAEO;UACL,OAAOV,MAAM,CAACU,IAAD,CAAb;QACD;MACF;IACF,CAVY,EAUV,IAVU,CAAb;EAWD,CAnBe,CAAhB;EAoBA,OAAOb,OAAP;AACD,CAtBD;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAL,MAAM,CAACG,SAAP,CAAiBiB,MAAjB,GAA0B,SAASA,MAAT,CAAiBC,SAAjB,EAA4B;EACpDA,SAAS,GAAGA,SAAS,IAAI,KAAKpB,MAAL,CAAYqB,cAArC;EACA,IAAMC,KAAK,GAAG,KAAKtB,MAAL,CAAYuB,iBAA1B;EACA,IAAMC,MAAM,GAAG,KAAKxB,MAAL,CAAYyB,kBAA3B,CAHoD,CAIpD;;EACA,IAAMC,YAAY,GAAIjB,MAAM,CAACkB,MAAP,CAAcL,KAAd,GAAsB,CAAvB,IAA8BA,KAAK,GAAG,CAAT,GAAc,EAA3C,CAArB,CALoD,CAMpD;;EACA,IAAMM,WAAW,GAAInB,MAAM,CAACkB,MAAP,CAAcH,MAAd,GAAuB,CAAxB,IAA+BA,MAAM,GAAG,CAAV,GAAe,EAA7C,CAApB;EACA,IAAMK,WAAW,GAAG,cAApB;EACA,IAAMC,SAAS,GAAGV,SAAS,GAAG,UAAZ,GAChBW,kBAAkB,CAACtB,MAAM,CAACuB,QAAP,CAAgBC,MAAjB,CADpB;EAEA,IAAMC,WAAW,GAAG,uCAAuCZ,KAAvC,GAA+C,UAA/C,GAClBE,MADkB,GACT,QADS,GACEE,YADF,GACiB,OADjB,GAC2BE,WAD/C;EAEAnB,MAAM,CAAC0B,IAAP,CAAYL,SAAZ,EAAuBD,WAAvB,EAAoCK,WAApC;EACA,IAAME,IAAI,GAAG,IAAb;EACA,OAAO,IAAI/B,OAAJ,CAAY,UAAUC,OAAV,EAAmB;IACpC8B,IAAI,CAACjC,MAAL,GACGkC,IADH,CACQ,UAAUC,KAAV,EAAiB;MACrB,OAAOhC,OAAO,CAACgC,KAAD,CAAd;IACD,CAHH;EAID,CALM,CAAP;AAMD,CArBD"}
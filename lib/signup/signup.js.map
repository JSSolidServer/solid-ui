{"version":3,"file":"signup.js","names":["Signup","config","defaultConfig","prototype","listen","promise","Promise","resolve","reject","eventMethod","window","addEventListener","eventListener","messageEvent","e","u","data","slice","user","length","signup","signupUrl","signupEndpoint","width","signupWindowWidth","height","signupWindowHeight","leftPosition","screen","topPosition","windowTitle","windowUrl","encodeURIComponent","location","origin","windowSpecs","open","self","then","webid"],"sources":["../../src/signup/signup.js"],"sourcesContent":["import defaultConfig from './config-default'\n\n/**\n * Provides functionality for signing up with a Solid provider\n * @module signup\n */\n\n/**\n * Creates a Signup UI manager\n * @class\n */\nexport function Signup (config) {\n  this.config = config || defaultConfig\n}\n\n/**\n * Sets up an event listener to monitor login messages from child window/iframe\n * @method listen\n * @return {Promise<String>} Event listener promise, resolves to user's WebID\n */\nSignup.prototype.listen = function listen () {\n  const promise = new Promise(function (resolve, reject) {\n    const eventMethod = window.addEventListener\n      ? 'addEventListener'\n      : 'attachEvent'\n    const eventListener = window[eventMethod]\n    const messageEvent = eventMethod === 'attachEvent'\n      ? 'onmessage'\n      : 'message'\n    eventListener(messageEvent, function (e) {\n      const u = e.data\n      if (u.slice(0, 5) === 'User:') {\n        const user = u.slice(5, u.length)\n        if (user && user.length > 0 && user.slice(0, 4) === 'http') {\n          return resolve(user)\n        } else {\n          return reject(user)\n        }\n      }\n    }, true)\n  })\n  return promise\n}\n\n/**\n * Opens a signup popup window, sets up `listen()`.\n * @method signup\n * @static\n * @param signupUrl {String} Location of a Solid server for user signup.\n * @return {Promise<String>} Returns a listener promise, resolves with signed\n *   up user's WebID.\n */\nSignup.prototype.signup = function signup (signupUrl) {\n  signupUrl = signupUrl || this.config.signupEndpoint\n  const width = this.config.signupWindowWidth\n  const height = this.config.signupWindowHeight\n  // set borders\n  const leftPosition = (window.screen.width / 2) - ((width / 2) + 10)\n  // set title and status bars\n  const topPosition = (window.screen.height / 2) - ((height / 2) + 50)\n  const windowTitle = 'Solid signup'\n  const windowUrl = signupUrl + '?origin=' +\n    encodeURIComponent(window.location.origin)\n  const windowSpecs = 'resizable,scrollbars,status,width=' + width + ',height=' +\n    height + ',left=' + leftPosition + ',top=' + topPosition\n  window.open(windowUrl, windowTitle, windowSpecs)\n  const self = this\n  return new Promise(function (resolve) {\n    self.listen()\n      .then(function (webid) {\n        return resolve(webid)\n      })\n  })\n}\n"],"mappings":";;;;;;;AAAA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACO,SAASA,MAAM,CAAEC,MAAM,EAAE;EAC9B,IAAI,CAACA,MAAM,GAAGA,MAAM,IAAIC,yBAAa;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACAF,MAAM,CAACG,SAAS,CAACC,MAAM,GAAG,SAASA,MAAM,GAAI;EAC3C,IAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,UAAUC,OAAO,EAAEC,MAAM,EAAE;IACrD,IAAMC,WAAW,GAAGC,MAAM,CAACC,gBAAgB,GACvC,kBAAkB,GAClB,aAAa;IACjB,IAAMC,aAAa,GAAGF,MAAM,CAACD,WAAW,CAAC;IACzC,IAAMI,YAAY,GAAGJ,WAAW,KAAK,aAAa,GAC9C,WAAW,GACX,SAAS;IACbG,aAAa,CAACC,YAAY,EAAE,UAAUC,CAAC,EAAE;MACvC,IAAMC,CAAC,GAAGD,CAAC,CAACE,IAAI;MAChB,IAAID,CAAC,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,OAAO,EAAE;QAC7B,IAAMC,IAAI,GAAGH,CAAC,CAACE,KAAK,CAAC,CAAC,EAAEF,CAAC,CAACI,MAAM,CAAC;QACjC,IAAID,IAAI,IAAIA,IAAI,CAACC,MAAM,GAAG,CAAC,IAAID,IAAI,CAACD,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,MAAM,EAAE;UAC1D,OAAOV,OAAO,CAACW,IAAI,CAAC;QACtB,CAAC,MAAM;UACL,OAAOV,MAAM,CAACU,IAAI,CAAC;QACrB;MACF;IACF,CAAC,EAAE,IAAI,CAAC;EACV,CAAC,CAAC;EACF,OAAOb,OAAO;AAChB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAL,MAAM,CAACG,SAAS,CAACiB,MAAM,GAAG,SAASA,MAAM,CAAEC,SAAS,EAAE;EACpDA,SAAS,GAAGA,SAAS,IAAI,IAAI,CAACpB,MAAM,CAACqB,cAAc;EACnD,IAAMC,KAAK,GAAG,IAAI,CAACtB,MAAM,CAACuB,iBAAiB;EAC3C,IAAMC,MAAM,GAAG,IAAI,CAACxB,MAAM,CAACyB,kBAAkB;EAC7C;EACA,IAAMC,YAAY,GAAIjB,MAAM,CAACkB,MAAM,CAACL,KAAK,GAAG,CAAC,IAAMA,KAAK,GAAG,CAAC,GAAI,EAAE,CAAC;EACnE;EACA,IAAMM,WAAW,GAAInB,MAAM,CAACkB,MAAM,CAACH,MAAM,GAAG,CAAC,IAAMA,MAAM,GAAG,CAAC,GAAI,EAAE,CAAC;EACpE,IAAMK,WAAW,GAAG,cAAc;EAClC,IAAMC,SAAS,GAAGV,SAAS,GAAG,UAAU,GACtCW,kBAAkB,CAACtB,MAAM,CAACuB,QAAQ,CAACC,MAAM,CAAC;EAC5C,IAAMC,WAAW,GAAG,oCAAoC,GAAGZ,KAAK,GAAG,UAAU,GAC3EE,MAAM,GAAG,QAAQ,GAAGE,YAAY,GAAG,OAAO,GAAGE,WAAW;EAC1DnB,MAAM,CAAC0B,IAAI,CAACL,SAAS,EAAED,WAAW,EAAEK,WAAW,CAAC;EAChD,IAAME,IAAI,GAAG,IAAI;EACjB,OAAO,IAAI/B,OAAO,CAAC,UAAUC,OAAO,EAAE;IACpC8B,IAAI,CAACjC,MAAM,EAAE,CACVkC,IAAI,CAAC,UAAUC,KAAK,EAAE;MACrB,OAAOhC,OAAO,CAACgC,KAAK,CAAC;IACvB,CAAC,CAAC;EACN,CAAC,CAAC;AACJ,CAAC"}
{"version":3,"file":"create.js","names":["kb","solidLogicSingleton","store","newThingUI","createContext","dataBrowserContext","thePanes","dom","div","me","uri","Error","iconStyle","star","appendChild","createElement","visible","setAttribute","icons","iconBase","complain","message","pre","createTextNode","styleTheIcons","style","i","iconArray","length","st","disabled","selectTool","icon","selectNewTool","_event","addEventListener","makeNewAppInstance","options","Promise","resolve","reject","selectUI","callbackWS","ws","newBase","ensureLoadedProfile","then","_context","newPaneOptions","Object","assign","folder","undefined","workspace","opt","debug","log","pane","name","mintNew","newInstance","tail","slice","isPackage","includes","add","ns","ldp","sym","doc","refreshTarget","refresh","p","innerHTML","noun","err","pa","mintClass","utils","label","appPathSegment","toUpperCase","selectWorkspace","gotName","endsWith","encodeURIComponent","widgets","askName","foaf","mintingPanes","values","filter","mintingClassMap","reduce","classMap","forEach","push","e","event","iconEle","noIndexHTML"],"sources":["../../src/create/create.ts"],"sourcesContent":["/*   create.js     UI to craete new objects in the solid-app-set world\n **\n */\n\nimport { DataBrowserContext, NewPaneOptions, PaneDefinition } from 'pane-registry'\nimport { solidLogicSingleton } from 'solid-logic'\nimport * as debug from '../debug'\nimport { icons } from '../iconBase'\nimport { ensureLoadedProfile, selectWorkspace } from '../login/login'\nimport * as ns from '../ns'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\nimport { CreateContext, NewAppInstanceOptions } from './types'\n\nconst kb = solidLogicSingleton.store\n\n/*  newThingUI -- return UI for user to select a new object, folder, etc\n **\n ** context must include:  dom, div,\n **     optional:   folder: NamedNode -- the folder where the thing is bring put\n **                (suppresses asking for a full URI or workspace)\n **\n */\nexport function newThingUI (\n  createContext: CreateContext,\n  dataBrowserContext: DataBrowserContext,\n  thePanes: Array<PaneDefinition>\n): void {\n  const dom = createContext.dom\n  const div = createContext.div\n  if (createContext.me && !createContext.me.uri) {\n    throw new Error('newThingUI:  Invalid userid: ' + createContext.me)\n  }\n\n  const iconStyle = 'padding: 0.7em; width: 2em; height: 2em;' // was: 'padding: 1em; width: 3em; height: 3em;'\n  const star = div.appendChild(dom.createElement('img'))\n  let visible = false // the inividual tools tools\n  //   noun_272948.svg = black star\n  // noun_34653_green.svg = green plus\n  star.setAttribute('src', icons.iconBase + 'noun_34653_green.svg')\n  star.setAttribute('style', iconStyle)\n  star.setAttribute('title', 'Add another tool')\n\n  const complain = function complain (message) {\n    const pre = div.appendChild(dom.createElement('pre'))\n    pre.setAttribute('style', 'background-color: pink')\n    pre.appendChild(dom.createTextNode(message))\n  }\n\n  function styleTheIcons (style) {\n    for (let i = 0; i < iconArray.length; i++) {\n      let st = iconStyle + style\n      if (iconArray[i].disabled) {\n        // @@ unused\n        st += 'opacity: 0.3;'\n      }\n      iconArray[i].setAttribute('style', st) // eg 'background-color: #ccc;'\n    }\n  }\n\n  function selectTool (icon) {\n    styleTheIcons('display: none;') // 'background-color: #ccc;'\n    icon.setAttribute('style', iconStyle + 'background-color: yellow;')\n  }\n\n  function selectNewTool (_event?) {\n    visible = !visible\n    star.setAttribute(\n      'style',\n      iconStyle + (visible ? 'background-color: yellow;' : '')\n    )\n    styleTheIcons(visible ? '' : 'display: none;')\n  }\n\n  star.addEventListener('click', selectNewTool)\n\n  function makeNewAppInstance (options: NewAppInstanceOptions) {\n    return new Promise(function (resolve, reject) {\n      let selectUI // , selectUIParent\n      function callbackWS (ws, newBase) {\n        ensureLoadedProfile(createContext).then(\n          _context => {\n            const newPaneOptions: NewPaneOptions = Object.assign({\n              newBase,\n              folder: options.folder || undefined,\n              workspace: ws\n            }, options)\n            for (const opt in options) {\n              // get div, dom, me, folder, pane, refreshTable\n              newPaneOptions[opt] = options[opt]\n            }\n            debug.log(`newThingUI: Minting new ${newPaneOptions.pane.name} at ${newPaneOptions.newBase}`)\n            options.pane\n              .mintNew!(dataBrowserContext, newPaneOptions)\n              .then(function (newPaneOptions) {\n                if (!newPaneOptions || !newPaneOptions.newInstance) {\n                  throw new Error('Cannot mint new - missing newInstance')\n                }\n                if (newPaneOptions.folder) {\n                  const tail = newPaneOptions.newInstance.uri.slice(\n                    newPaneOptions.folder.uri.length\n                  )\n                  const isPackage = tail.includes('/')\n                  debug.log('  new thing is packge? ' + isPackage)\n                  if (isPackage) {\n                    kb.add(\n                      newPaneOptions.folder,\n                      ns.ldp('contains'),\n                      kb.sym(newPaneOptions.newBase),\n                      newPaneOptions.folder.doc()\n                    )\n                  } else {\n                    // single file\n                    kb.add(\n                      newPaneOptions.folder,\n                      ns.ldp('contains'),\n                      newPaneOptions.newInstance,\n                      newPaneOptions.folder.doc()\n                    ) // Ping the patch system?\n                  }\n                  // @ts-ignore @@ TODO check whether refresh can exist here. Either fix type or remove unreachable code\n                  if (newPaneOptions.refreshTarget && newPaneOptions.refreshTarget.refresh) {\n                    // @@ TODO Remove the need to cast as any\n                    ;(newPaneOptions.refreshTarget as any).refresh() // Refresh the containing display\n                  }\n                  // selectUI.parentNode.removeChild(selectUI) It removes itself\n                } else {\n                  const p = options.div.appendChild(dom.createElement('p'))\n                  p.setAttribute('style', 'font-size: 120%;')\n                  // Make link to new thing\n                  p.innerHTML =\n                    \"Your <a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'><b>new \" +\n                    options.noun +\n                    '</b></a> is ready to be set up. ' +\n                    \"<br/><br/><a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'>Go to your new \" +\n                    options.noun +\n                    '.</a>'\n                  // selectUI.parentNode.removeChild(selectUI) // Clean up\n                  // selectUIParent.removeChild(selectUI) // Clean up\n                }\n                selectNewTool() // toggle star to plain and menu vanish again\n              })\n              .catch(function (err) {\n                complain(err)\n                reject(err)\n              })\n          },\n          err => {\n            // login fails\n            complain('Error logging on: ' + err)\n          }\n        )\n      } // callbackWS\n\n      const pa = options.pane\n      // options.appPathSegment = pa.name // was 'edu.mit.solid.pane.'\n      options.noun = pa.mintClass ? utils.label(pa.mintClass) : pa.name\n      options.appPathSegment = options.noun.slice(0, 1).toUpperCase() + options.noun.slice(1)\n\n      if (!options.folder) {\n        // No folder given? Ask user for full URI\n        selectUI = selectWorkspace(dom, {\n          noun: options.noun,\n          appPathSegment: options.appPathSegment\n        }, callbackWS)\n        options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      } else {\n        const gotName = function (name) {\n          if (!name) {\n            // selectUIParent.removeChild(selectUI)   itremves itself if cancelled\n            selectNewTool() // toggle star to plain and menu vanish again\n          } else {\n            let uri = options.folder!.uri\n            if (!uri.endsWith('/')) {\n              uri = uri + '/'\n            }\n            uri = uri + encodeURIComponent(name) + '/'\n            callbackWS(null, uri)\n          }\n        }\n        widgets\n          .askName(\n            dom,\n            kb,\n            options.div,\n            ns.foaf('name'),\n            null,\n            options.noun\n          )\n          .then(gotName)\n        // selectUI = getNameForm(dom, kb, options.noun, gotName)\n        // options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      }\n    })\n  } // makeNewAppInstance\n\n  const iconArray: Array<any> = []\n  const mintingPanes = Object.values(thePanes).filter(pane => pane.mintNew)\n  const mintingClassMap = mintingPanes.reduce((classMap, pane) => {\n    if (pane.mintClass) {\n      classMap[pane.mintClass.uri] = (classMap[pane.mintClass.uri] || 0) + 1\n    }\n    return classMap\n  }, {})\n  mintingPanes.forEach(pane => {\n    // @@ TODO Remove the need to cast to any\n    const icon: any = createContext.div.appendChild(dom.createElement('img'))\n    icon.setAttribute('src', pane.icon)\n    const noun = pane.mintClass\n      ? mintingClassMap[pane.mintClass.uri] > 1\n        ? `${utils.label(pane.mintClass)} (using ${pane.name} pane)`\n        : utils.label(pane.mintClass)\n      : pane.name + ' @@'\n    icon.setAttribute('title', 'Make new ' + noun)\n    icon.setAttribute('style', iconStyle + 'display: none;')\n    iconArray.push(icon)\n    if (!icon.disabled) {\n      icon.addEventListener('click', function (e) {\n        selectTool(icon)\n        makeNewAppInstance({\n          event: e,\n          folder: createContext.folder || null,\n          iconEle: icon,\n          pane,\n          noun,\n          noIndexHTML: true, // do NOT @@ for now write a HTML file\n          div: createContext.div,\n          me: createContext.me,\n          dom: createContext.dom,\n          refreshTarget: createContext.refreshTarget\n        })\n      })\n    }\n  })\n}\n\n// Form to get the name of a new thing before we create it\n//\n// Used in contacts for new groups, individuals.\n//\n/*\nfunction getNameForm (dom, kb, classLabel, gotNameCallback) {\n  const form = dom.createElement('div') // form is broken as HTML behaviour can resurface on js error\n  form.innerHTML = '<p>Name of new ' + classLabel + ':</p>'\n  const namefield = dom.createElement('input')\n  namefield.setAttribute('type', 'text')\n  namefield.setAttribute('size', '30')\n  namefield.setAttribute('style', style.textInputStyle)\n  namefield.setAttribute('maxLength', '2048') // No arbitrary limits\n  namefield.select() // focus next user input\n\n  const gotName = function () {\n    namefield.setAttribute('class', 'pendingedit')\n    namefield.disabled = true\n    continueButton.disabled = true\n    cancel.disabled = true\n    gotNameCallback(true, namefield.value)\n  }\n\n  namefield.addEventListener('keyup', function (e) {\n    if (e.keyCode === 13) {\n      gotName()\n    }\n  }, false)\n  form.appendChild(namefield)\n\n  form.appendChild(dom.createElement('br'))\n\n  const cancel = form.appendChild(widgets.cancelButton(dom))\n  cancel.addEventListener('click', function (e) {\n    form.parentNode.removeChild(form)\n    gotNameCallback(false)\n  }, false)\n\n  const continueButton = form.appendChild(widgets.continueButton(dom))\n  continueButton.addEventListener('click', function (e) {\n    gotName()\n  }, false)\n\n  return form\n}\n*/\n"],"mappings":"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"}
{"version":3,"file":"create.js","names":["kb","solidLogicSingleton","store","newThingUI","createContext","dataBrowserContext","thePanes","dom","div","me","uri","Error","iconStyle","star","appendChild","createElement","visible","setAttribute","icons","iconBase","complain","message","pre","createTextNode","styleTheIcons","style","i","iconArray","length","st","disabled","selectTool","icon","selectNewTool","_event","addEventListener","makeNewAppInstance","options","Promise","resolve","reject","selectUI","callbackWS","ws","newBase","ensureLoadedProfile","then","_context","newPaneOptions","Object","assign","folder","undefined","workspace","opt","debug","log","pane","name","mintNew","newInstance","tail","slice","isPackage","includes","add","ns","ldp","sym","doc","refreshTarget","refresh","p","innerHTML","noun","err","pa","mintClass","utils","label","appPathSegment","toUpperCase","selectWorkspace","gotName","endsWith","encodeURIComponent","widgets","askName","foaf","mintingPanes","values","filter","mintingClassMap","reduce","classMap","forEach","push","e","event","iconEle","noIndexHTML"],"sources":["../../src/create/create.ts"],"sourcesContent":["/*   create.js     UI to craete new objects in the solid-app-set world\n **\n */\n\nimport { DataBrowserContext, NewPaneOptions, PaneDefinition } from 'pane-registry'\nimport { solidLogicSingleton } from 'solid-logic'\nimport * as debug from '../debug'\nimport { icons } from '../iconBase'\nimport { ensureLoadedProfile, selectWorkspace } from '../login/login'\nimport * as ns from '../ns'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\nimport { CreateContext, NewAppInstanceOptions } from './types'\n\nconst kb = solidLogicSingleton.store\n\n/*  newThingUI -- return UI for user to select a new object, folder, etc\n **\n ** context must include:  dom, div,\n **     optional:   folder: NamedNode -- the folder where the thing is bring put\n **                (suppresses asking for a full URI or workspace)\n **\n */\nexport function newThingUI (\n  createContext: CreateContext,\n  dataBrowserContext: DataBrowserContext,\n  thePanes: Array<PaneDefinition>\n): void {\n  const dom = createContext.dom\n  const div = createContext.div\n  if (createContext.me && !createContext.me.uri) {\n    throw new Error('newThingUI:  Invalid userid: ' + createContext.me)\n  }\n\n  const iconStyle = 'padding: 0.7em; width: 2em; height: 2em;' // was: 'padding: 1em; width: 3em; height: 3em;'\n  const star = div.appendChild(dom.createElement('img'))\n  let visible = false // the inividual tools tools\n  //   noun_272948.svg = black star\n  // noun_34653_green.svg = green plus\n  star.setAttribute('src', icons.iconBase + 'noun_34653_green.svg')\n  star.setAttribute('style', iconStyle)\n  star.setAttribute('title', 'Add another tool')\n\n  const complain = function complain (message) {\n    const pre = div.appendChild(dom.createElement('pre'))\n    pre.setAttribute('style', 'background-color: pink')\n    pre.appendChild(dom.createTextNode(message))\n  }\n\n  function styleTheIcons (style) {\n    for (let i = 0; i < iconArray.length; i++) {\n      let st = iconStyle + style\n      if (iconArray[i].disabled) {\n        // @@ unused\n        st += 'opacity: 0.3;'\n      }\n      iconArray[i].setAttribute('style', st) // eg 'background-color: #ccc;'\n    }\n  }\n\n  function selectTool (icon) {\n    styleTheIcons('display: none;') // 'background-color: #ccc;'\n    icon.setAttribute('style', iconStyle + 'background-color: yellow;')\n  }\n\n  function selectNewTool (_event?) {\n    visible = !visible\n    star.setAttribute(\n      'style',\n      iconStyle + (visible ? 'background-color: yellow;' : '')\n    )\n    styleTheIcons(visible ? '' : 'display: none;')\n  }\n\n  star.addEventListener('click', selectNewTool)\n\n  function makeNewAppInstance (options: NewAppInstanceOptions) {\n    return new Promise(function (resolve, reject) {\n      let selectUI // , selectUIParent\n      function callbackWS (ws, newBase) {\n        ensureLoadedProfile(createContext).then(\n          _context => {\n            const newPaneOptions: NewPaneOptions = Object.assign({\n              newBase,\n              folder: options.folder || undefined,\n              workspace: ws\n            }, options)\n            for (const opt in options) {\n              // get div, dom, me, folder, pane, refreshTable\n              newPaneOptions[opt] = options[opt]\n            }\n            debug.log(`newThingUI: Minting new ${newPaneOptions.pane.name} at ${newPaneOptions.newBase}`)\n            options.pane\n              .mintNew!(dataBrowserContext, newPaneOptions)\n              .then(function (newPaneOptions) {\n                if (!newPaneOptions || !newPaneOptions.newInstance) {\n                  throw new Error('Cannot mint new - missing newInstance')\n                }\n                if (newPaneOptions.folder) {\n                  const tail = newPaneOptions.newInstance.uri.slice(\n                    newPaneOptions.folder.uri.length\n                  )\n                  const isPackage = tail.includes('/')\n                  debug.log('  new thing is packge? ' + isPackage)\n                  if (isPackage) {\n                    kb.add(\n                      newPaneOptions.folder,\n                      ns.ldp('contains'),\n                      kb.sym(newPaneOptions.newBase),\n                      newPaneOptions.folder.doc()\n                    )\n                  } else {\n                    // single file\n                    kb.add(\n                      newPaneOptions.folder,\n                      ns.ldp('contains'),\n                      newPaneOptions.newInstance,\n                      newPaneOptions.folder.doc()\n                    ) // Ping the patch system?\n                  }\n                  // @ts-ignore @@ TODO check whether refresh can exist here. Either fix type or remove unreachable code\n                  if (newPaneOptions.refreshTarget && newPaneOptions.refreshTarget.refresh) {\n                    // @@ TODO Remove the need to cast as any\n                    ;(newPaneOptions.refreshTarget as any).refresh() // Refresh the containing display\n                  }\n                  // selectUI.parentNode.removeChild(selectUI) It removes itself\n                } else {\n                  const p = options.div.appendChild(dom.createElement('p'))\n                  p.setAttribute('style', 'font-size: 120%;')\n                  // Make link to new thing\n                  p.innerHTML =\n                    \"Your <a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'><b>new \" +\n                    options.noun +\n                    '</b></a> is ready to be set up. ' +\n                    \"<br/><br/><a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'>Go to your new \" +\n                    options.noun +\n                    '.</a>'\n                  // selectUI.parentNode.removeChild(selectUI) // Clean up\n                  // selectUIParent.removeChild(selectUI) // Clean up\n                }\n                selectNewTool() // toggle star to plain and menu vanish again\n              })\n              .catch(function (err) {\n                complain(err)\n                reject(err)\n              })\n          },\n          err => {\n            // login fails\n            complain('Error logging on: ' + err)\n          }\n        )\n      } // callbackWS\n\n      const pa = options.pane\n      // options.appPathSegment = pa.name // was 'edu.mit.solid.pane.'\n      options.noun = pa.mintClass ? utils.label(pa.mintClass) : pa.name\n      options.appPathSegment = options.noun.slice(0, 1).toUpperCase() + options.noun.slice(1)\n\n      if (!options.folder) {\n        // No folder given? Ask user for full URI\n        selectUI = selectWorkspace(dom, {\n          noun: options.noun,\n          appPathSegment: options.appPathSegment\n        }, callbackWS)\n        options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      } else {\n        const gotName = function (name) {\n          if (!name) {\n            // selectUIParent.removeChild(selectUI)   itremves itself if cancelled\n            selectNewTool() // toggle star to plain and menu vanish again\n          } else {\n            let uri = options.folder!.uri\n            if (!uri.endsWith('/')) {\n              uri = uri + '/'\n            }\n            uri = uri + encodeURIComponent(name) + '/'\n            callbackWS(null, uri)\n          }\n        }\n        widgets\n          .askName(\n            dom,\n            kb,\n            options.div,\n            ns.foaf('name'),\n            null,\n            options.noun\n          )\n          .then(gotName)\n        // selectUI = getNameForm(dom, kb, options.noun, gotName)\n        // options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      }\n    })\n  } // makeNewAppInstance\n\n  const iconArray: Array<any> = []\n  const mintingPanes = Object.values(thePanes).filter(pane => pane.mintNew)\n  const mintingClassMap = mintingPanes.reduce((classMap, pane) => {\n    if (pane.mintClass) {\n      classMap[pane.mintClass.uri] = (classMap[pane.mintClass.uri] || 0) + 1\n    }\n    return classMap\n  }, {})\n  mintingPanes.forEach(pane => {\n    // @@ TODO Remove the need to cast to any\n    const icon: any = createContext.div.appendChild(dom.createElement('img'))\n    icon.setAttribute('src', pane.icon)\n    const noun = pane.mintClass\n      ? mintingClassMap[pane.mintClass.uri] > 1\n        ? `${utils.label(pane.mintClass)} (using ${pane.name} pane)`\n        : utils.label(pane.mintClass)\n      : pane.name + ' @@'\n    icon.setAttribute('title', 'Make new ' + noun)\n    icon.setAttribute('style', iconStyle + 'display: none;')\n    iconArray.push(icon)\n    if (!icon.disabled) {\n      icon.addEventListener('click', function (e) {\n        selectTool(icon)\n        makeNewAppInstance({\n          event: e,\n          folder: createContext.folder || null,\n          iconEle: icon,\n          pane,\n          noun,\n          noIndexHTML: true, // do NOT @@ for now write a HTML file\n          div: createContext.div,\n          me: createContext.me,\n          dom: createContext.dom,\n          refreshTarget: createContext.refreshTarget\n        })\n      })\n    }\n  })\n}\n\n// Form to get the name of a new thing before we create it\n//\n// Used in contacts for new groups, individuals.\n//\n/*\nfunction getNameForm (dom, kb, classLabel, gotNameCallback) {\n  const form = dom.createElement('div') // form is broken as HTML behaviour can resurface on js error\n  form.innerHTML = '<p>Name of new ' + classLabel + ':</p>'\n  const namefield = dom.createElement('input')\n  namefield.setAttribute('type', 'text')\n  namefield.setAttribute('size', '30')\n  namefield.setAttribute('style', style.textInputStyle)\n  namefield.setAttribute('maxLength', '2048') // No arbitrary limits\n  namefield.select() // focus next user input\n\n  const gotName = function () {\n    namefield.setAttribute('class', 'pendingedit')\n    namefield.disabled = true\n    continueButton.disabled = true\n    cancel.disabled = true\n    gotNameCallback(true, namefield.value)\n  }\n\n  namefield.addEventListener('keyup', function (e) {\n    if (e.keyCode === 13) {\n      gotName()\n    }\n  }, false)\n  form.appendChild(namefield)\n\n  form.appendChild(dom.createElement('br'))\n\n  const cancel = form.appendChild(widgets.cancelButton(dom))\n  cancel.addEventListener('click', function (e) {\n    form.parentNode.removeChild(form)\n    gotNameCallback(false)\n  }, false)\n\n  const continueButton = form.appendChild(widgets.continueButton(dom))\n  continueButton.addEventListener('click', function (e) {\n    gotName()\n  }, false)\n\n  return form\n}\n*/\n"],"mappings":";;;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAAqC;AAAA;AAXrC;AACA;AACA;;AAYA,IAAMA,EAAE,GAAGC,+BAAmB,CAACC,KAAK;;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,UAAU,CACxBC,aAA4B,EAC5BC,kBAAsC,EACtCC,QAA+B,EACzB;EACN,IAAMC,GAAG,GAAGH,aAAa,CAACG,GAAG;EAC7B,IAAMC,GAAG,GAAGJ,aAAa,CAACI,GAAG;EAC7B,IAAIJ,aAAa,CAACK,EAAE,IAAI,CAACL,aAAa,CAACK,EAAE,CAACC,GAAG,EAAE;IAC7C,MAAM,IAAIC,KAAK,CAAC,+BAA+B,GAAGP,aAAa,CAACK,EAAE,CAAC;EACrE;EAEA,IAAMG,SAAS,GAAG,0CAA0C,EAAC;EAC7D,IAAMC,IAAI,GAAGL,GAAG,CAACM,WAAW,CAACP,GAAG,CAACQ,aAAa,CAAC,KAAK,CAAC,CAAC;EACtD,IAAIC,OAAO,GAAG,KAAK,EAAC;EACpB;EACA;EACAH,IAAI,CAACI,YAAY,CAAC,KAAK,EAAEC,eAAK,CAACC,QAAQ,GAAG,sBAAsB,CAAC;EACjEN,IAAI,CAACI,YAAY,CAAC,OAAO,EAAEL,SAAS,CAAC;EACrCC,IAAI,CAACI,YAAY,CAAC,OAAO,EAAE,kBAAkB,CAAC;EAE9C,IAAMG,QAAQ,GAAG,SAASA,QAAQ,CAAEC,OAAO,EAAE;IAC3C,IAAMC,GAAG,GAAGd,GAAG,CAACM,WAAW,CAACP,GAAG,CAACQ,aAAa,CAAC,KAAK,CAAC,CAAC;IACrDO,GAAG,CAACL,YAAY,CAAC,OAAO,EAAE,wBAAwB,CAAC;IACnDK,GAAG,CAACR,WAAW,CAACP,GAAG,CAACgB,cAAc,CAACF,OAAO,CAAC,CAAC;EAC9C,CAAC;EAED,SAASG,aAAa,CAAEC,KAAK,EAAE;IAC7B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAEF,CAAC,EAAE,EAAE;MACzC,IAAIG,EAAE,GAAGjB,SAAS,GAAGa,KAAK;MAC1B,IAAIE,SAAS,CAACD,CAAC,CAAC,CAACI,QAAQ,EAAE;QACzB;QACAD,EAAE,IAAI,eAAe;MACvB;MACAF,SAAS,CAACD,CAAC,CAAC,CAACT,YAAY,CAAC,OAAO,EAAEY,EAAE,CAAC,EAAC;IACzC;EACF;;EAEA,SAASE,UAAU,CAAEC,IAAI,EAAE;IACzBR,aAAa,CAAC,gBAAgB,CAAC,EAAC;IAChCQ,IAAI,CAACf,YAAY,CAAC,OAAO,EAAEL,SAAS,GAAG,2BAA2B,CAAC;EACrE;EAEA,SAASqB,aAAa,CAAEC,MAAO,EAAE;IAC/BlB,OAAO,GAAG,CAACA,OAAO;IAClBH,IAAI,CAACI,YAAY,CACf,OAAO,EACPL,SAAS,IAAII,OAAO,GAAG,2BAA2B,GAAG,EAAE,CAAC,CACzD;IACDQ,aAAa,CAACR,OAAO,GAAG,EAAE,GAAG,gBAAgB,CAAC;EAChD;EAEAH,IAAI,CAACsB,gBAAgB,CAAC,OAAO,EAAEF,aAAa,CAAC;EAE7C,SAASG,kBAAkB,CAAEC,OAA8B,EAAE;IAC3D,OAAO,IAAIC,OAAO,CAAC,UAAUC,OAAO,EAAEC,MAAM,EAAE;MAC5C,IAAIC,QAAQ,EAAC;MACb,SAASC,UAAU,CAAEC,EAAE,EAAEC,OAAO,EAAE;QAChC,IAAAC,0BAAmB,EAACzC,aAAa,CAAC,CAAC0C,IAAI,CACrC,UAAAC,QAAQ,EAAI;UACV,IAAMC,cAA8B,GAAGC,MAAM,CAACC,MAAM,CAAC;YACnDN,OAAO,EAAPA,OAAO;YACPO,MAAM,EAAEd,OAAO,CAACc,MAAM,IAAIC,SAAS;YACnCC,SAAS,EAAEV;UACb,CAAC,EAAEN,OAAO,CAAC;UACX,KAAK,IAAMiB,GAAG,IAAIjB,OAAO,EAAE;YACzB;YACAW,cAAc,CAACM,GAAG,CAAC,GAAGjB,OAAO,CAACiB,GAAG,CAAC;UACpC;UACAC,KAAK,CAACC,GAAG,mCAA4BR,cAAc,CAACS,IAAI,CAACC,IAAI,iBAAOV,cAAc,CAACJ,OAAO,EAAG;UAC7FP,OAAO,CAACoB,IAAI,CACTE,OAAO,CAAEtD,kBAAkB,EAAE2C,cAAc,CAAC,CAC5CF,IAAI,CAAC,UAAUE,cAAc,EAAE;YAC9B,IAAI,CAACA,cAAc,IAAI,CAACA,cAAc,CAACY,WAAW,EAAE;cAClD,MAAM,IAAIjD,KAAK,CAAC,uCAAuC,CAAC;YAC1D;YACA,IAAIqC,cAAc,CAACG,MAAM,EAAE;cACzB,IAAMU,IAAI,GAAGb,cAAc,CAACY,WAAW,CAAClD,GAAG,CAACoD,KAAK,CAC/Cd,cAAc,CAACG,MAAM,CAACzC,GAAG,CAACkB,MAAM,CACjC;cACD,IAAMmC,SAAS,GAAGF,IAAI,CAACG,QAAQ,CAAC,GAAG,CAAC;cACpCT,KAAK,CAACC,GAAG,CAAC,yBAAyB,GAAGO,SAAS,CAAC;cAChD,IAAIA,SAAS,EAAE;gBACb/D,EAAE,CAACiE,GAAG,CACJjB,cAAc,CAACG,MAAM,EACrBe,EAAE,CAACC,GAAG,CAAC,UAAU,CAAC,EAClBnE,EAAE,CAACoE,GAAG,CAACpB,cAAc,CAACJ,OAAO,CAAC,EAC9BI,cAAc,CAACG,MAAM,CAACkB,GAAG,EAAE,CAC5B;cACH,CAAC,MAAM;gBACL;gBACArE,EAAE,CAACiE,GAAG,CACJjB,cAAc,CAACG,MAAM,EACrBe,EAAE,CAACC,GAAG,CAAC,UAAU,CAAC,EAClBnB,cAAc,CAACY,WAAW,EAC1BZ,cAAc,CAACG,MAAM,CAACkB,GAAG,EAAE,CAC5B,EAAC;cACJ;cACA;cACA,IAAIrB,cAAc,CAACsB,aAAa,IAAItB,cAAc,CAACsB,aAAa,CAACC,OAAO,EAAE;gBACxE;gBACA;gBAAEvB,cAAc,CAACsB,aAAa,CAASC,OAAO,EAAE,EAAC;cACnD;cACA;YACF,CAAC,MAAM;cACL,IAAMC,CAAC,GAAGnC,OAAO,CAAC7B,GAAG,CAACM,WAAW,CAACP,GAAG,CAACQ,aAAa,CAAC,GAAG,CAAC,CAAC;cACzDyD,CAAC,CAACvD,YAAY,CAAC,OAAO,EAAE,kBAAkB,CAAC;cAC3C;cACAuD,CAAC,CAACC,SAAS,GACT,gCAAgC,GAChCzB,cAAc,CAACY,WAAW,CAAClD,GAAG,GAC9B,WAAW,GACX2B,OAAO,CAACqC,IAAI,GACZ,kCAAkC,GAClC,qCAAqC,GACrC1B,cAAc,CAACY,WAAW,CAAClD,GAAG,GAC9B,mBAAmB,GACnB2B,OAAO,CAACqC,IAAI,GACZ,OAAO;cACT;cACA;YACF;;YACAzC,aAAa,EAAE,EAAC;UAClB,CAAC,CAAC,SACI,CAAC,UAAU0C,GAAG,EAAE;YACpBvD,QAAQ,CAACuD,GAAG,CAAC;YACbnC,MAAM,CAACmC,GAAG,CAAC;UACb,CAAC,CAAC;QACN,CAAC,EACD,UAAAA,GAAG,EAAI;UACL;UACAvD,QAAQ,CAAC,oBAAoB,GAAGuD,GAAG,CAAC;QACtC,CAAC,CACF;MACH,CAAC,CAAC;;MAEF,IAAMC,EAAE,GAAGvC,OAAO,CAACoB,IAAI;MACvB;MACApB,OAAO,CAACqC,IAAI,GAAGE,EAAE,CAACC,SAAS,GAAGC,KAAK,CAACC,KAAK,CAACH,EAAE,CAACC,SAAS,CAAC,GAAGD,EAAE,CAAClB,IAAI;MACjErB,OAAO,CAAC2C,cAAc,GAAG3C,OAAO,CAACqC,IAAI,CAACZ,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACmB,WAAW,EAAE,GAAG5C,OAAO,CAACqC,IAAI,CAACZ,KAAK,CAAC,CAAC,CAAC;MAEvF,IAAI,CAACzB,OAAO,CAACc,MAAM,EAAE;QACnB;QACAV,QAAQ,GAAG,IAAAyC,sBAAe,EAAC3E,GAAG,EAAE;UAC9BmE,IAAI,EAAErC,OAAO,CAACqC,IAAI;UAClBM,cAAc,EAAE3C,OAAO,CAAC2C;QAC1B,CAAC,EAAEtC,UAAU,CAAC;QACdL,OAAO,CAAC7B,GAAG,CAACM,WAAW,CAAC2B,QAAQ,CAAC;QACjC;MACF,CAAC,MAAM;QACL,IAAM0C,OAAO,GAAG,SAAVA,OAAO,CAAazB,IAAI,EAAE;UAC9B,IAAI,CAACA,IAAI,EAAE;YACT;YACAzB,aAAa,EAAE,EAAC;UAClB,CAAC,MAAM;YACL,IAAIvB,GAAG,GAAG2B,OAAO,CAACc,MAAM,CAAEzC,GAAG;YAC7B,IAAI,CAACA,GAAG,CAAC0E,QAAQ,CAAC,GAAG,CAAC,EAAE;cACtB1E,GAAG,GAAGA,GAAG,GAAG,GAAG;YACjB;YACAA,GAAG,GAAGA,GAAG,GAAG2E,kBAAkB,CAAC3B,IAAI,CAAC,GAAG,GAAG;YAC1ChB,UAAU,CAAC,IAAI,EAAEhC,GAAG,CAAC;UACvB;QACF,CAAC;QACD4E,OAAO,CACJC,OAAO,CACNhF,GAAG,EACHP,EAAE,EACFqC,OAAO,CAAC7B,GAAG,EACX0D,EAAE,CAACsB,IAAI,CAAC,MAAM,CAAC,EACf,IAAI,EACJnD,OAAO,CAACqC,IAAI,CACb,CACA5B,IAAI,CAACqC,OAAO,CAAC;QAChB;QACA;QACA;MACF;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;;EAEF,IAAMxD,SAAqB,GAAG,EAAE;EAChC,IAAM8D,YAAY,GAAGxC,MAAM,CAACyC,MAAM,CAACpF,QAAQ,CAAC,CAACqF,MAAM,CAAC,UAAAlC,IAAI;IAAA,OAAIA,IAAI,CAACE,OAAO;EAAA,EAAC;EACzE,IAAMiC,eAAe,GAAGH,YAAY,CAACI,MAAM,CAAC,UAACC,QAAQ,EAAErC,IAAI,EAAK;IAC9D,IAAIA,IAAI,CAACoB,SAAS,EAAE;MAClBiB,QAAQ,CAACrC,IAAI,CAACoB,SAAS,CAACnE,GAAG,CAAC,GAAG,CAACoF,QAAQ,CAACrC,IAAI,CAACoB,SAAS,CAACnE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC;IACxE;IACA,OAAOoF,QAAQ;EACjB,CAAC,EAAE,CAAC,CAAC,CAAC;EACNL,YAAY,CAACM,OAAO,CAAC,UAAAtC,IAAI,EAAI;IAC3B;IACA,IAAMzB,IAAS,GAAG5B,aAAa,CAACI,GAAG,CAACM,WAAW,CAACP,GAAG,CAACQ,aAAa,CAAC,KAAK,CAAC,CAAC;IACzEiB,IAAI,CAACf,YAAY,CAAC,KAAK,EAAEwC,IAAI,CAACzB,IAAI,CAAC;IACnC,IAAM0C,IAAI,GAAGjB,IAAI,CAACoB,SAAS,GACvBe,eAAe,CAACnC,IAAI,CAACoB,SAAS,CAACnE,GAAG,CAAC,GAAG,CAAC,aAClCoE,KAAK,CAACC,KAAK,CAACtB,IAAI,CAACoB,SAAS,CAAC,qBAAWpB,IAAI,CAACC,IAAI,cAClDoB,KAAK,CAACC,KAAK,CAACtB,IAAI,CAACoB,SAAS,CAAC,GAC7BpB,IAAI,CAACC,IAAI,GAAG,KAAK;IACrB1B,IAAI,CAACf,YAAY,CAAC,OAAO,EAAE,WAAW,GAAGyD,IAAI,CAAC;IAC9C1C,IAAI,CAACf,YAAY,CAAC,OAAO,EAAEL,SAAS,GAAG,gBAAgB,CAAC;IACxDe,SAAS,CAACqE,IAAI,CAAChE,IAAI,CAAC;IACpB,IAAI,CAACA,IAAI,CAACF,QAAQ,EAAE;MAClBE,IAAI,CAACG,gBAAgB,CAAC,OAAO,EAAE,UAAU8D,CAAC,EAAE;QAC1ClE,UAAU,CAACC,IAAI,CAAC;QAChBI,kBAAkB,CAAC;UACjB8D,KAAK,EAAED,CAAC;UACR9C,MAAM,EAAE/C,aAAa,CAAC+C,MAAM,IAAI,IAAI;UACpCgD,OAAO,EAAEnE,IAAI;UACbyB,IAAI,EAAJA,IAAI;UACJiB,IAAI,EAAJA,IAAI;UACJ0B,WAAW,EAAE,IAAI;UAAE;UACnB5F,GAAG,EAAEJ,aAAa,CAACI,GAAG;UACtBC,EAAE,EAAEL,aAAa,CAACK,EAAE;UACpBF,GAAG,EAAEH,aAAa,CAACG,GAAG;UACtB+D,aAAa,EAAElE,aAAa,CAACkE;QAC/B,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}
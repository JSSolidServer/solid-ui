{"version":3,"sources":["../src/create.js"],"names":["UI","authn","require","icons","ns","store","solidLogicSingleton","style","utils","widgets","kb","module","exports","newThingUI","createContext","dataBrowserContext","thePanes","Error","dom","div","me","uri","iconStyle","star","appendChild","createElement","visible","setAttribute","iconBase","complain","message","pre","createTextNode","styleTheIcons","i","iconArray","length","st","disabled","selectTool","icon","selectNewTool","_event","addEventListener","makeNewAppInstance","options","Promise","resolve","reject","selectUI","callbackWS","ws","newBase","logInLoadProfile","then","_context","newPaneOptions","workspace","opt","debug","log","pane","name","mintNew","newInstance","folder","tail","slice","isPackage","includes","add","ldp","sym","doc","refreshTarget","refresh","p","innerHTML","noun","err","pa","mintClass","label","appPathSegment","toUpperCase","selectWorkspace","gotName","endsWith","encodeURIComponent","askName","foaf","mintingPanes","Object","values","filter","mintingClassMap","reduce","classMap","forEach","push","e","event","iconEle","noIndexHTML"],"mappings":"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","sourcesContent":["/*   create.js     UI to craete new objects in the solid-app-set world\n **\n */\n// const error = require('./widgets/error')\n// const widgets = require('./widgets/index')\n// const utils = require('./utils')\n\n// const UI = require('solid-ui')\n\nimport * as debug from './debug'\n\nconst UI = {\n  authn: require('./authn/authn'),\n  icons: require('./iconBase'),\n  ns: require('./ns'),\n  store: require('./logic').solidLogicSingleton.store,\n  style: require('./style'),\n  utils: require('./utils'),\n  widgets: require('./widgets')\n}\n\nconst kb = UI.store\n\nmodule.exports = {\n  newThingUI\n}\n\n/*  newThingUI -- return UI for user to select a new object, folder, etc\n **\n ** context must include:  dom, div,\n **     optional:   folder: NamedNode -- the folder where the thing is bring put\n **                (suppresses asking for a full URI or workspace)\n **\n */\nfunction newThingUI (createContext, dataBrowserContext, thePanes) {\n  if (!thePanes) throw new Error('@@ newThingUI: update API') // phase out\n  const dom = createContext.dom\n  const div = createContext.div\n  if (createContext.me && !createContext.me.uri) {\n    throw new Error('newThingUI:  Invalid userid: ' + createContext.me)\n  }\n\n  const iconStyle = 'padding: 0.7em; width: 2em; height: 2em;' // was: 'padding: 1em; width: 3em; height: 3em;'\n  const star = div.appendChild(dom.createElement('img'))\n  var visible = false // the inividual tools tools\n  //   noun_272948.svg = black star\n  // noun_34653_green.svg = green plus\n  star.setAttribute('src', UI.icons.iconBase + 'noun_34653_green.svg')\n  star.setAttribute('style', iconStyle)\n  star.setAttribute('title', 'Add another tool')\n\n  var complain = function complain (message) {\n    var pre = div.appendChild(dom.createElement('pre'))\n    pre.setAttribute('style', 'background-color: pink')\n    pre.appendChild(dom.createTextNode(message))\n  }\n\n  function styleTheIcons (style) {\n    for (var i = 0; i < iconArray.length; i++) {\n      var st = iconStyle + style\n      if (iconArray[i].disabled) {\n        // @@ unused\n        st += 'opacity: 0.3;'\n      }\n      iconArray[i].setAttribute('style', st) // eg 'background-color: #ccc;'\n    }\n  }\n\n  function selectTool (icon) {\n    styleTheIcons('display: none;') // 'background-color: #ccc;'\n    icon.setAttribute('style', iconStyle + 'background-color: yellow;')\n  }\n\n  function selectNewTool (_event) {\n    visible = !visible\n    star.setAttribute(\n      'style',\n      iconStyle + (visible ? 'background-color: yellow;' : '')\n    )\n    styleTheIcons(visible ? '' : 'display: none;')\n  }\n\n  star.addEventListener('click', selectNewTool)\n\n  function makeNewAppInstance (options) {\n    return new Promise(function (resolve, reject) {\n      var selectUI // , selectUIParent\n      function callbackWS (ws, newBase) {\n        UI.authn.logInLoadProfile(createContext).then(\n          _context => {\n            var newPaneOptions = {\n              newBase: newBase,\n              workspace: ws\n            }\n            for (var opt in options) {\n              // get div, dom, me, folder, pane, refreshTable\n              newPaneOptions[opt] = options[opt]\n            }\n            debug.log(\n              'newThingUI: Minting new ' +\n                newPaneOptions.pane.name +\n                ' at ' +\n                newPaneOptions.newBase\n            )\n            options.pane\n              .mintNew(dataBrowserContext, newPaneOptions)\n              .then(function (newPaneOptions) {\n                if (!newPaneOptions || !newPaneOptions.newInstance) {\n                  throw new Error('Cannot mint new - missing newInstance')\n                }\n                if (newPaneOptions.folder) {\n                  var tail = newPaneOptions.newInstance.uri.slice(\n                    newPaneOptions.folder.uri.length\n                  )\n                  const isPackage = tail.includes('/')\n                  debug.log('  new thing is packge? ' + isPackage)\n                  if (isPackage) {\n                    kb.add(\n                      newPaneOptions.folder,\n                      UI.ns.ldp('contains'),\n                      kb.sym(newPaneOptions.newBase),\n                      newPaneOptions.folder.doc()\n                    )\n                  } else {\n                    // single file\n                    kb.add(\n                      newPaneOptions.folder,\n                      UI.ns.ldp('contains'),\n                      newPaneOptions.newInstance,\n                      newPaneOptions.folder.doc()\n                    ) // Ping the patch system?\n                  }\n                  if (newPaneOptions.refreshTarget && newPaneOptions.refreshTarget.refresh) {\n                    newPaneOptions.refreshTarget.refresh() // Refresh the cntaining display\n                  }\n                  // selectUI.parentNode.removeChild(selectUI) It removes itself\n                } else {\n                  var p = options.div.appendChild(dom.createElement('p'))\n                  p.setAttribute('style', 'font-size: 120%;')\n                  // Make link to new thing\n                  p.innerHTML =\n                    \"Your <a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'><b>new \" +\n                    options.noun +\n                    '</b></a> is ready to be set up. ' +\n                    \"<br/><br/><a target='_blank' href='\" +\n                    newPaneOptions.newInstance.uri +\n                    \"'>Go to your new \" +\n                    options.noun +\n                    '.</a>'\n                  // selectUI.parentNode.removeChild(selectUI) // Clean up\n                  // selectUIParent.removeChild(selectUI) // Clean up\n                }\n                selectNewTool() // toggle star to plain and menu vanish again\n              })\n              .catch(function (err) {\n                complain(err)\n                reject(err)\n              })\n          },\n          err => {\n            // login fails\n            complain('Error logging on: ' + err)\n          }\n        )\n      } // callbackWS\n\n      var pa = options.pane\n      // options.appPathSegment = pa.name // was 'edu.mit.solid.pane.'\n      options.noun = pa.mintClass ? UI.utils.label(pa.mintClass) : pa.name\n      options.appPathSegment = options.noun.slice(0, 1).toUpperCase() + options.noun.slice(1)\n\n      if (!options.folder) {\n        // No folder given? Ask user for full URI\n        selectUI = UI.authn.selectWorkspace(dom, options, callbackWS)\n        options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      } else {\n        var gotName = function (name) {\n          if (!name) {\n            // selectUIParent.removeChild(selectUI)   itremves itself if cancelled\n            selectNewTool() // toggle star to plain and menu vanish again\n          } else {\n            var uri = options.folder.uri\n            if (!uri.endsWith('/')) {\n              uri = uri + '/'\n            }\n            uri = uri + encodeURIComponent(name) + '/'\n            callbackWS(null, uri)\n          }\n        }\n        UI.widgets\n          .askName(\n            dom,\n            UI.store,\n            options.div,\n            UI.ns.foaf('name'),\n            null,\n            options.noun\n          )\n          .then(gotName)\n        // selectUI = getNameForm(dom, UI.store, options.noun, gotName)\n        // options.div.appendChild(selectUI)\n        // selectUIParent = options.div\n      }\n    })\n  } // makeNewAppInstance\n\n  const iconArray = []\n  const mintingPanes = Object.values(thePanes).filter(pane => pane.mintNew)\n  const mintingClassMap = mintingPanes.reduce((classMap, pane) => {\n    if (pane.mintClass) {\n      classMap[pane.mintClass] = (classMap[pane.mintClass] || 0) + 1\n    }\n    return classMap\n  }, {})\n  mintingPanes.forEach(pane => {\n    const icon = createContext.div.appendChild(dom.createElement('img'))\n    icon.setAttribute('src', pane.icon)\n    const noun = pane.mintClass\n      ? mintingClassMap[pane.mintClass] > 1\n          ? `${UI.utils.label(pane.mintClass)} (using ${pane.name} pane)`\n          : UI.utils.label(pane.mintClass)\n      : pane.name + ' @@'\n    icon.setAttribute('title', 'Make new ' + noun)\n    icon.setAttribute('style', iconStyle + 'display: none;')\n    iconArray.push(icon)\n    if (!icon.disabled) {\n      icon.addEventListener('click', function (e) {\n        selectTool(icon)\n        makeNewAppInstance({\n          event: e,\n          folder: createContext.folder,\n          iconEle: icon,\n          pane,\n          noun,\n          noIndexHTML: true, // do NOT @@ for now write a HTML file\n          div: createContext.div,\n          me: createContext.me,\n          dom: createContext.dom,\n          refreshTarget: createContext.refreshTarget\n        })\n      })\n    }\n  })\n}\n\n// Form to get the name of a new thing before we create it\n//\n// Used in contacts for new groups, individuals.\n//\n/*\nfunction getNameForm (dom, kb, classLabel, gotNameCallback) {\n  var form = dom.createElement('div') // form is broken as HTML behaviour can resurface on js error\n  form.innerHTML = '<p>Name of new ' + classLabel + ':</p>'\n  var namefield = dom.createElement('input')\n  namefield.setAttribute('type', 'text')\n  namefield.setAttribute('size', '30')\n  namefield.setAttribute('style', UI.style.textInputStyle)\n  namefield.setAttribute('maxLength', '2048') // No arbitrary limits\n  namefield.select() // focus next user input\n\n  var gotName = function () {\n    namefield.setAttribute('class', 'pendingedit')\n    namefield.disabled = true\n    continueButton.disabled = true\n    cancel.disabled = true\n    gotNameCallback(true, namefield.value)\n  }\n\n  namefield.addEventListener('keyup', function (e) {\n    if (e.keyCode === 13) {\n      gotName()\n    }\n  }, false)\n  form.appendChild(namefield)\n\n  form.appendChild(dom.createElement('br'))\n\n  var cancel = form.appendChild(UI.widgets.cancelButton(dom))\n  cancel.addEventListener('click', function (e) {\n    form.parentNode.removeChild(form)\n    gotNameCallback(false)\n  }, false)\n\n  var continueButton = form.appendChild(UI.widgets.continueButton(dom))\n  continueButton.addEventListener('click', function (e) {\n    gotName()\n  }, false)\n\n  return form\n}\n*/\n"],"file":"create.js"}
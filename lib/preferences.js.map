{"version":3,"file":"preferences.js","names":["kb","store","value","get","k","set","v","debug","log","Error","recordSharedPreferences","subject","context","Promise","resolve","reject","sharedPreferences","any","ns","ui","sp","$rdf","sym","doc","uri","ins","st","updater","update","ok","errorMessage","recordPersonalDefaults","theClass","ensureLoadedPreferences","then","preferencesFile","preferencesFileError","regs","each","solid","prefs","reg","length","forEach","r","personalDefaults","widgets","newThing","rdf","push","errm","err","renderPreferencesForm","preferencesForm","prefContainer","dom","createElement","participation","participationObject","me","heading","text","appendChild","textContent","noun","appendForm","mes","complain","errorMessageBlock","toJS","term","datatype","equals","xsd","Date","Number","getPreferencesForClass","predicates","results","pred","v1"],"sources":["../src/preferences.js"],"sourcesContent":["//                  Solid-UI preferences\n//                  =====================\n//\n\nimport * as $rdf from 'rdflib' // pull in first avoid cross-refs\nimport { store } from 'solid-logic'\nimport * as debug from './debug'\nimport { ensureLoadedPreferences } from './login/login'\nimport * as ns from './ns'\nimport * as participation from './participation' // @ts-ignore\nimport * as widgets from './widgets'\n\nconst kb = store\n\n// This was tabulator . preferences in the tabulator\n//  Is this functionality used anywhere?\n//\n\n// used for storing user name\n// @@ Deprocate these functions.  They were used for\n// communication around the tabulator functionality about the user session\n\nexport const value = []\nexport function get (k) {\n  return value[k]\n}\n\nexport function set (k, v) {\n  if (typeof v !== 'string') {\n    debug.log('Non-string value of preference ' + k + ': ' + v)\n    throw new Error('Non-string value of preference ' + k + ': ' + v)\n  }\n  this.value[k] = v\n}\n\n// In a solid world, Preferences are stored in the web\n//\n// Make an RDF node for recording the common view preferences for any object\n// (maybe make it in a separate file?)\nexport function recordSharedPreferences (subject, context) {\n  return new Promise(function (resolve, reject) {\n    const sharedPreferences = kb.any(subject, ns.ui('sharedPreferences'))\n    if (!sharedPreferences) {\n      const sp = $rdf.sym(subject.doc().uri + '#SharedPreferences')\n      const ins = [\n        $rdf.st(subject, ns.ui('sharedPreferences'), sp, subject.doc())\n      ]\n      debug.log('Creating shared preferences ' + sp)\n      kb.updater.update([], ins, function (uri, ok, errorMessage) {\n        if (!ok) {\n          reject(new Error('Error creating shared prefs: ' + errorMessage))\n        } else {\n          context.sharedPreferences = sp\n          resolve(context)\n        }\n      })\n    } else {\n      context.sharedPreferences = sharedPreferences\n      resolve(context)\n    }\n  })\n}\n\n// Construct a personal defaults node in the preferences file for a given class of object\n//\nexport function recordPersonalDefaults (theClass, context) {\n  return new Promise(function (resolve, reject) {\n    ensureLoadedPreferences(context).then(\n      context => {\n        if (!context.preferencesFile) {\n          debug.log(\n            'Not doing private class preferences as no access to preferences file. ' +\n              context.preferencesFileError\n          )\n          return\n        }\n        const regs = kb.each(\n          null,\n          ns.solid('forClass'),\n          theClass,\n          context.preferencesFile\n        )\n        let ins = []\n        let prefs\n        let reg\n        if (regs.length) {\n          // Use existing node if we can\n          regs.forEach(r => {\n            prefs = prefs || kb.any(r, ns.solid('personalDefaults'))\n          })\n          if (prefs) {\n            context.personalDefaults = prefs // Found one\n            resolve(context)\n            return\n          } else {\n            prefs = widgets.newThing(context.preferencesFile)\n            reg = regs[0]\n          }\n        } else {\n          // no regs fo class\n          reg = widgets.newThing(context.preferencesFile)\n          ins = [\n            $rdf.st(\n              reg,\n              ns.rdf('type'),\n              ns.solid('TypeRegistration'),\n              context.preferencesFile\n            ),\n            $rdf.st(reg, ns.solid('forClass'), theClass, context.preferencesFile)\n          ]\n        }\n        prefs = widgets.newThing(context.preferencesFile)\n        ins.push(\n          $rdf.st(\n            reg,\n            ns.solid('personalDefaults'),\n            prefs,\n            context.preferencesFile\n          )\n        )\n        kb.updater.update([], ins, function (uri, ok, errm) {\n          if (!ok) {\n            reject(new Error('Setting preferences for ' + theClass + ': ' + errm))\n          } else {\n            context.personalDefaults = prefs\n            resolve(context)\n          }\n        })\n      },\n      err => {\n        reject(err)\n      }\n    )\n  })\n}\n\nexport function renderPreferencesForm (subject, theClass, preferencesForm, context) {\n  const prefContainer = context.dom.createElement('div')\n  participation.participationObject(subject, subject.doc(), context.me).then(\n    participation => {\n      const dom = context.dom\n      function heading (text) {\n        prefContainer.appendChild(dom.createElement('h5')).textContent = text\n      }\n      heading('My view of this ' + context.noun)\n      widgets.appendForm(\n        dom,\n        prefContainer,\n        {},\n        participation,\n        preferencesForm,\n        subject.doc(),\n        (ok, mes) => {\n          if (!ok) widgets.complain(context, mes)\n        }\n      )\n\n      heading(\"Everyone's  view of this \" + context.noun)\n      recordSharedPreferences(subject, context).then(context => {\n        const sharedPreferences = context.sharedPreferences\n        widgets.appendForm(\n          dom,\n          prefContainer,\n          {},\n          sharedPreferences,\n          preferencesForm,\n          subject.doc(),\n          (ok, mes) => {\n            if (!ok) widgets.complain(context, mes)\n          }\n        )\n\n        heading('My default view of any ' + context.noun)\n        recordPersonalDefaults(theClass, context).then(\n          context => {\n            widgets.appendForm(\n              dom,\n              prefContainer,\n              {},\n              context.personalDefaults,\n              preferencesForm,\n              context.preferencesFile,\n              (ok, mes) => {\n                if (!ok) widgets.complain(context, mes)\n              }\n            )\n          },\n          err => {\n            widgets.complain(context, err)\n          }\n        )\n      })\n    },\n    err => {\n      // parp object fails\n      prefContainer.appendChild(widgets.errorMessageBlock(context.dom, err))\n    }\n  )\n  return prefContainer\n}\n\n// This should be part of rdflib.js ad part of the RDFJS Standard!!\n\nfunction toJS (term) {\n  if (!term.datatype) return term // Objects remain objects\n  if (term.datatype.equals(ns.xsd('boolean'))) {\n    return term.value === '1'\n  }\n  if (\n    term.datatype.equals(ns.xsd('dateTime')) ||\n    term.datatype.equals(ns.xsd('date'))\n  ) {\n    return new Date(term.value)\n  }\n  if (\n    term.datatype.equals(ns.xsd('integer')) ||\n    term.datatype.equals(ns.xsd('float')) ||\n    term.datatype.equals(ns.xsd('decimal'))\n  ) {\n    return Number(term.value)\n  }\n  return term.value\n}\n\n// This is the function which acuakly reads and combines the preferences\n//\n//  @@ make it much more tolerant of missing buts of prefernces\nexport function getPreferencesForClass (subject, theClass, predicates, context) {\n  return new Promise(function (resolve, reject) {\n    recordSharedPreferences(subject, context).then(context => {\n      const sharedPreferences = context.sharedPreferences\n      if (context.me) {\n        participation\n          .participationObject(subject, subject.doc(), context.me)\n          .then(participation => {\n            recordPersonalDefaults(theClass, context).then(context => {\n              const results = []\n              const personalDefaults = context.personalDefaults\n              predicates.forEach(pred => {\n                // Order of preference: My settings on object, Global settings on object, my settings on class\n                const v1 =\n                  kb.any(participation, pred) ||\n                  kb.any(sharedPreferences, pred) ||\n                  kb.any(personalDefaults, pred)\n                if (v1) {\n                  results[pred.uri] = toJS(v1)\n                }\n              })\n              resolve(results)\n            }, reject)\n          }, reject)\n      } else {\n        // no user defined, just use common prefs\n        const results = []\n        predicates.forEach(pred => {\n          const v1 = kb.any(sharedPreferences, pred)\n          if (v1) {\n            results[pred.uri] = toJS(v1)\n          }\n        })\n        resolve(results)\n      }\n    })\n  })\n}\n\n// ends\n"],"mappings":"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"}
{"version":3,"file":"preferences.js","names":["kb","store","value","get","k","set","v","debug","log","Error","recordSharedPreferences","subject","context","Promise","resolve","reject","sharedPreferences","any","ns","ui","sp","$rdf","sym","doc","uri","ins","st","updater","update","ok","errorMessage","recordPersonalDefaults","theClass","ensureLoadedPreferences","then","preferencesFile","preferencesFileError","regs","each","solid","prefs","reg","length","forEach","r","personalDefaults","widgets","newThing","rdf","push","errm","err","renderPreferencesForm","preferencesForm","prefContainer","dom","createElement","participation","participationObject","me","heading","text","appendChild","textContent","noun","appendForm","mes","complain","errorMessageBlock","toJS","term","datatype","equals","xsd","Date","Number","getPreferencesForClass","predicates","results","pred","v1"],"sources":["../src/preferences.js"],"sourcesContent":["//                  Solid-UI preferences\n//                  =====================\n//\n\nimport * as $rdf from 'rdflib' // pull in first avoid cross-refs\nimport { store } from 'solid-logic'\nimport * as debug from './debug'\nimport { ensureLoadedPreferences } from './login/login'\nimport * as ns from './ns'\nimport * as participation from './participation' // @ts-ignore\nimport * as widgets from './widgets'\n\nconst kb = store\n\n// This was tabulator . preferences in the tabulator\n//  Is this functionality used anywhere?\n//\n\n// used for storing user name\n// @@ Deprocate these functions.  They were used for\n// communication around the tabulator functionality about the user session\n\nexport const value = []\nexport function get (k) {\n  return value[k]\n}\n\nexport function set (k, v) {\n  if (typeof v !== 'string') {\n    debug.log('Non-string value of preference ' + k + ': ' + v)\n    throw new Error('Non-string value of preference ' + k + ': ' + v)\n  }\n  this.value[k] = v\n}\n\n// In a solid world, Preferences are stored in the web\n//\n// Make an RDF node for recording the common view preferences for any object\n// (maybe make it in a separate file?)\nexport function recordSharedPreferences (subject, context) {\n  return new Promise(function (resolve, reject) {\n    const sharedPreferences = kb.any(subject, ns.ui('sharedPreferences'))\n    if (!sharedPreferences) {\n      const sp = $rdf.sym(subject.doc().uri + '#SharedPreferences')\n      const ins = [\n        $rdf.st(subject, ns.ui('sharedPreferences'), sp, subject.doc())\n      ]\n      debug.log('Creating shared preferences ' + sp)\n      kb.updater.update([], ins, function (uri, ok, errorMessage) {\n        if (!ok) {\n          reject(new Error('Error creating shared prefs: ' + errorMessage))\n        } else {\n          context.sharedPreferences = sp\n          resolve(context)\n        }\n      })\n    } else {\n      context.sharedPreferences = sharedPreferences\n      resolve(context)\n    }\n  })\n}\n\n// Construct a personal defaults node in the preferences file for a given class of object\n//\nexport function recordPersonalDefaults (theClass, context) {\n  return new Promise(function (resolve, reject) {\n    ensureLoadedPreferences(context).then(\n      context => {\n        if (!context.preferencesFile) {\n          debug.log(\n            'Not doing private class preferences as no access to preferences file. ' +\n              context.preferencesFileError\n          )\n          return\n        }\n        const regs = kb.each(\n          null,\n          ns.solid('forClass'),\n          theClass,\n          context.preferencesFile\n        )\n        let ins = []\n        let prefs\n        let reg\n        if (regs.length) {\n          // Use existing node if we can\n          regs.forEach(r => {\n            prefs = prefs || kb.any(r, ns.solid('personalDefaults'))\n          })\n          if (prefs) {\n            context.personalDefaults = prefs // Found one\n            resolve(context)\n            return\n          } else {\n            prefs = widgets.newThing(context.preferencesFile)\n            reg = regs[0]\n          }\n        } else {\n          // no regs fo class\n          reg = widgets.newThing(context.preferencesFile)\n          ins = [\n            $rdf.st(\n              reg,\n              ns.rdf('type'),\n              ns.solid('TypeRegistration'),\n              context.preferencesFile\n            ),\n            $rdf.st(reg, ns.solid('forClass'), theClass, context.preferencesFile)\n          ]\n        }\n        prefs = widgets.newThing(context.preferencesFile)\n        ins.push(\n          $rdf.st(\n            reg,\n            ns.solid('personalDefaults'),\n            prefs,\n            context.preferencesFile\n          )\n        )\n        kb.updater.update([], ins, function (uri, ok, errm) {\n          if (!ok) {\n            reject(new Error('Setting preferences for ' + theClass + ': ' + errm))\n          } else {\n            context.personalDefaults = prefs\n            resolve(context)\n          }\n        })\n      },\n      err => {\n        reject(err)\n      }\n    )\n  })\n}\n\nexport function renderPreferencesForm (subject, theClass, preferencesForm, context) {\n  const prefContainer = context.dom.createElement('div')\n  participation.participationObject(subject, subject.doc(), context.me).then(\n    participation => {\n      const dom = context.dom\n      function heading (text) {\n        prefContainer.appendChild(dom.createElement('h5')).textContent = text\n      }\n      heading('My view of this ' + context.noun)\n      widgets.appendForm(\n        dom,\n        prefContainer,\n        {},\n        participation,\n        preferencesForm,\n        subject.doc(),\n        (ok, mes) => {\n          if (!ok) widgets.complain(context, mes)\n        }\n      )\n\n      heading(\"Everyone's  view of this \" + context.noun)\n      recordSharedPreferences(subject, context).then(context => {\n        const sharedPreferences = context.sharedPreferences\n        widgets.appendForm(\n          dom,\n          prefContainer,\n          {},\n          sharedPreferences,\n          preferencesForm,\n          subject.doc(),\n          (ok, mes) => {\n            if (!ok) widgets.complain(context, mes)\n          }\n        )\n\n        heading('My default view of any ' + context.noun)\n        recordPersonalDefaults(theClass, context).then(\n          context => {\n            widgets.appendForm(\n              dom,\n              prefContainer,\n              {},\n              context.personalDefaults,\n              preferencesForm,\n              context.preferencesFile,\n              (ok, mes) => {\n                if (!ok) widgets.complain(context, mes)\n              }\n            )\n          },\n          err => {\n            widgets.complain(context, err)\n          }\n        )\n      })\n    },\n    err => {\n      // parp object fails\n      prefContainer.appendChild(widgets.errorMessageBlock(context.dom, err))\n    }\n  )\n  return prefContainer\n}\n\n// This should be part of rdflib.js ad part of the RDFJS Standard!!\n\nfunction toJS (term) {\n  if (!term.datatype) return term // Objects remain objects\n  if (term.datatype.equals(ns.xsd('boolean'))) {\n    return term.value === '1'\n  }\n  if (\n    term.datatype.equals(ns.xsd('dateTime')) ||\n    term.datatype.equals(ns.xsd('date'))\n  ) {\n    return new Date(term.value)\n  }\n  if (\n    term.datatype.equals(ns.xsd('integer')) ||\n    term.datatype.equals(ns.xsd('float')) ||\n    term.datatype.equals(ns.xsd('decimal'))\n  ) {\n    return Number(term.value)\n  }\n  return term.value\n}\n\n// This is the function which acuakly reads and combines the preferences\n//\n//  @@ make it much more tolerant of missing buts of prefernces\nexport function getPreferencesForClass (subject, theClass, predicates, context) {\n  return new Promise(function (resolve, reject) {\n    recordSharedPreferences(subject, context).then(context => {\n      const sharedPreferences = context.sharedPreferences\n      if (context.me) {\n        participation\n          .participationObject(subject, subject.doc(), context.me)\n          .then(participation => {\n            recordPersonalDefaults(theClass, context).then(context => {\n              const results = []\n              const personalDefaults = context.personalDefaults\n              predicates.forEach(pred => {\n                // Order of preference: My settings on object, Global settings on object, my settings on class\n                const v1 =\n                  kb.any(participation, pred) ||\n                  kb.any(sharedPreferences, pred) ||\n                  kb.any(personalDefaults, pred)\n                if (v1) {\n                  results[pred.uri] = toJS(v1)\n                }\n              })\n              resolve(results)\n            }, reject)\n          }, reject)\n      } else {\n        // no user defined, just use common prefs\n        const results = []\n        predicates.forEach(pred => {\n          const v1 = kb.any(sharedPreferences, pred)\n          if (v1) {\n            results[pred.uri] = toJS(v1)\n          }\n        })\n        resolve(results)\n      }\n    })\n  })\n}\n\n// ends\n"],"mappings":"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"}
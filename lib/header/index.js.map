{"version":3,"file":"index.js","names":["DEFAULT_HELP_MENU_ICON","icons","iconBase","DEFAUL_SOLID_ICON_URL","initHeader","store","userMenuList","options","header","document","getElementById","pod","getPod","rebuildHeader","authSession","onLogout","onLogin","user","authn","currentUser","innerHTML","createBanner","appendChild","podLink","createElement","href","uri","addStyleClassToElement","image","src","logo","createUserMenu","createLoginSignUpButtons","userMenu","banner","leftSideOfHeader","helpMenuList","helpMenu","createHelpMenu","helpMenuItems","forEach","menuItem","menuItemType","url","createUserMenuItem","createUserMenuLink","label","target","createUserMenuButton","onclick","setAttribute","helpMenuContainer","helpMenuTrigger","type","helpMenuIcon","helpIcon","throttledMenuToggle","throttle","event","toggleMenu","addEventListener","timer","setTimeout","clearTimeout","profileLoginButtonPre","loginStatusBox","onClick","button","innerText","link","fetcher","load","loggedInMenuList","loggedInMenu","loggedInMenuTrigger","profileImg","getProfileImg","loggedInMenuContainer","child","menuProfileItem","profileUrl","widgets","findImage","emptyProfile","profileImage","style","backgroundImage","trigger","menu","isExpanded","getAttribute","expand","close","toString"],"sources":["../../src/header/index.ts"],"sourcesContent":["/* global EventListenerOrEventListenerObject */\n/*\n    This file was copied from mashlib/src/global/header.ts file. It is modified to\n    work in solid-ui by adjusting where imported functions are found.\n */\nimport { IndexedFormula, NamedNode } from 'rdflib'\nimport { icons } from '../index'\nimport { authn, authSession } from 'solid-logic'\nimport { loginStatusBox } from '../login/login'\n// import { loginStatusBox, authSession, currentUser } from '../authn/authn'\nimport * as widgets from '../widgets'\nimport { emptyProfile } from './empty-profile'\nimport { addStyleClassToElement, getPod, throttle } from '../utils/headerFooterHelpers'\n\n/**\n * menu icons\n*/\nconst DEFAULT_HELP_MENU_ICON = icons.iconBase + 'noun_help.svg'\nconst DEFAUL_SOLID_ICON_URL = 'https://solidproject.org/assets/img/solid-emblem.svg'\n\nexport type MenuItemLink = {\n  label: string,\n  url: string,\n  target?: string\n}\n\nexport type MenuItemButton = {\n  label: string,\n  onclick: () => void\n}\n\nexport type MenuItems = MenuItemLink | MenuItemButton\n\n/*\n  HeaderOptions allow for customizing the logo and menu list.  If a logo is not provided the default\n  is solid. Menulist will always show a link to logout and to the users profile.\n  */\nexport type HeaderOptions = {\n  logo?: string,\n  helpIcon?: string,\n  helpMenuList?: MenuItems[]\n}\n\n/**\n * Initialize header component, the header object returned depends on whether the user is authenticated.\n * @param store the data store\n * @param userMenuList a list of menu items when the user is logged in\n * @param options allow the header to be customized with a personalized logo, help icon and a help menu list of links or buttons.\n * @returns a header for an authenticated user with menu items given or a login screen\n */\nexport async function initHeader (store: IndexedFormula, userMenuList: MenuItems[], options?: HeaderOptions) {\n  const header = document.getElementById('PageHeader')\n  if (!header) {\n    return\n  }\n\n  const pod = getPod()\n  rebuildHeader(header, store, pod, userMenuList, options)()\n  authSession.onLogout(rebuildHeader(header, store, pod, userMenuList, options))\n  authSession.onLogin(rebuildHeader(header, store, pod, userMenuList, options))\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function rebuildHeader (header: HTMLElement, store: IndexedFormula, pod: NamedNode, userMenuList: MenuItems[], options?: HeaderOptions) {\n  return async () => {\n    const user = authn.currentUser()\n    header.innerHTML = ''\n    header.appendChild(await createBanner(store, pod, user, userMenuList, options))\n  }\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createBanner (store: IndexedFormula, pod: NamedNode, user: NamedNode | null, userMenuList: MenuItems[], options?: HeaderOptions): Promise<HTMLElement> {\n  const podLink = document.createElement('a')\n  podLink.href = pod.uri\n  addStyleClassToElement(podLink, ['header-banner__link'])\n  const image = document.createElement('img')\n  if (options) {\n    image.src = options.logo ? options.logo : DEFAUL_SOLID_ICON_URL\n  }\n  addStyleClassToElement(image, ['header-banner__icon'])\n  podLink.appendChild(image)\n\n  const userMenu = user\n    ? await createUserMenu(store, user, userMenuList)\n    : createLoginSignUpButtons()\n\n  const banner = document.createElement('div')\n  addStyleClassToElement(banner, ['header-banner'])\n  banner.appendChild(podLink)\n\n  const leftSideOfHeader = document.createElement('div')\n  addStyleClassToElement(leftSideOfHeader, ['header-banner__right-menu'])\n  leftSideOfHeader.appendChild(userMenu)\n\n  if (options && options.helpMenuList) {\n    const helpMenu = createHelpMenu(options, options.helpMenuList)\n    leftSideOfHeader.appendChild(helpMenu as HTMLDivElement)\n  }\n\n  banner.appendChild(leftSideOfHeader)\n\n  return banner\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createHelpMenu (options: HeaderOptions, helpMenuItems: MenuItems[]) {\n  if (!helpMenuItems) return\n  const helpMenuList = document.createElement('ul')\n  addStyleClassToElement(helpMenuList, ['header-user-menu__list'])\n  helpMenuItems.forEach(function (menuItem) {\n    const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n    if (menuItemType === 'url') {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n    } else {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n    }\n  })\n\n  const helpMenu = document.createElement('nav')\n\n  addStyleClassToElement(helpMenu, ['header-user-menu__navigation-menu'])\n  helpMenu.setAttribute('aria-hidden', 'true')\n  helpMenu.appendChild(helpMenuList)\n\n  const helpMenuContainer = document.createElement('div')\n  addStyleClassToElement(helpMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(helpMenuContainer, ['header-user-menu'])\n  helpMenuContainer.appendChild(helpMenu)\n\n  const helpMenuTrigger = document.createElement('button')\n  addStyleClassToElement(helpMenuTrigger, ['header-user-menu__trigger'])\n  helpMenuTrigger.type = 'button'\n\n  const helpMenuIcon = document.createElement('img')\n  helpMenuIcon.src = (options && options.helpIcon) ? options.helpIcon : icons.iconBase + DEFAULT_HELP_MENU_ICON\n  addStyleClassToElement(helpMenuIcon, ['header-banner__help-icon'])\n  helpMenuContainer.appendChild(helpMenuTrigger)\n  helpMenuTrigger.appendChild(helpMenuIcon)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, helpMenuTrigger, helpMenu), 50)\n  helpMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  helpMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  helpMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return helpMenuContainer\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createLoginSignUpButtons () {\n  const profileLoginButtonPre = document.createElement('div')\n  addStyleClassToElement(profileLoginButtonPre, ['header-banner__login'])\n  profileLoginButtonPre.appendChild(loginStatusBox(document, null, {}))\n  return profileLoginButtonPre\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuButton (label: string, onClick: EventListenerOrEventListenerObject): HTMLElement {\n  const button = document.createElement('button')\n  addStyleClassToElement(button, ['header-user-menu__button'])\n  button.addEventListener('click', onClick)\n  button.innerText = label\n  return button\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuLink (label: string, href: string, target?: string): HTMLElement {\n  const link = document.createElement('a')\n  addStyleClassToElement(link, ['header-user-menu__link'])\n  link.href = href\n  link.innerText = label\n  if (target) link.target = target\n  return link\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createUserMenu (store: IndexedFormula, user: NamedNode, userMenuList: MenuItems[]): Promise<HTMLElement> {\n  const fetcher = (<any>store).fetcher\n  if (fetcher) {\n    // Making sure that Profile is loaded before building menu\n    await fetcher.load(user)\n  }\n\n  const loggedInMenuList = document.createElement('ul')\n  addStyleClassToElement(loggedInMenuList, ['header-user-menu__list'])\n  if (userMenuList) {\n    userMenuList.forEach(function (menuItem) {\n      const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n      if (menuItemType === 'url') {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n      } else {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n      }\n    })\n  }\n  const loggedInMenu = document.createElement('nav')\n\n  addStyleClassToElement(loggedInMenu, ['header-user-menu__navigation-menu'])\n  loggedInMenu.setAttribute('aria-hidden', 'true')\n  loggedInMenu.appendChild(loggedInMenuList)\n\n  const loggedInMenuTrigger = document.createElement('button')\n  addStyleClassToElement(loggedInMenuTrigger, ['header-user-menu__trigger'])\n  loggedInMenuTrigger.type = 'button'\n  const profileImg = getProfileImg(store, user)\n  if (typeof profileImg === 'string') {\n    loggedInMenuTrigger.innerHTML = profileImg\n  } else {\n    loggedInMenuTrigger.appendChild(profileImg)\n  }\n\n  const loggedInMenuContainer = document.createElement('div')\n  addStyleClassToElement(loggedInMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(loggedInMenuContainer, ['header-user-menu'])\n  loggedInMenuContainer.appendChild(loggedInMenuTrigger)\n  loggedInMenuContainer.appendChild(loggedInMenu)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, loggedInMenuTrigger, loggedInMenu), 50)\n  loggedInMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  loggedInMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  loggedInMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return loggedInMenuContainer\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuItem (child: HTMLElement): HTMLElement {\n  const menuProfileItem = document.createElement('li')\n  addStyleClassToElement(menuProfileItem, ['header-user-menu__list-item'])\n  menuProfileItem.appendChild(child)\n  return menuProfileItem\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function getProfileImg (store: IndexedFormula, user: NamedNode): string | HTMLElement {\n  let profileUrl = null\n  try {\n    profileUrl = widgets.findImage(user)\n    if (!profileUrl) {\n      return emptyProfile\n    }\n  } catch {\n    return emptyProfile\n  }\n\n  const profileImage = document.createElement('div')\n  addStyleClassToElement(profileImage, ['header-user-menu__photo'])\n  profileImage.style.backgroundImage = `url(${profileUrl})`\n  return profileImage\n}\n\n/**\n * @internal\n */\nfunction toggleMenu (event: Event, trigger: HTMLButtonElement, menu: HTMLElement): void {\n  const isExpanded = trigger.getAttribute('aria-expanded') === 'true'\n  const expand = event.type === 'mouseover'\n  const close = event.type === 'mouseout'\n  if ((isExpanded && expand) || (!isExpanded && close)) {\n    return\n  }\n  trigger.setAttribute('aria-expanded', (!isExpanded).toString())\n  menu.setAttribute('aria-hidden', isExpanded.toString())\n}\n"],"mappings":"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"}
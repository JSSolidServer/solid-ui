{"version":3,"file":"index.js","names":["_index","require","_solidLogic","_login","widgets","_interopRequireWildcard","_emptyProfile","_headerFooterHelpers","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","DEFAULT_HELP_MENU_ICON","icons","iconBase","DEFAUL_SOLID_ICON_URL","initHeader","_x","_x2","_x3","_initHeader","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee2","store","userMenuList","options","header","pod","wrap","_callee2$","_context2","prev","next","document","getElementById","abrupt","getPod","rebuildHeader","authSession","onLogout","onLogin","stop","_callee","user","_callee$","_context","authn","currentUser","innerHTML","t0","createBanner","t1","sent","appendChild","_x4","_x5","_x6","_x7","_x8","_createBanner","_callee3","podLink","image","userMenu","banner","leftSideOfHeader","helpMenu","_callee3$","_context3","createElement","href","uri","addStyleClassToElement","src","logo","createUserMenu","createLoginSignUpButtons","helpMenuList","createHelpMenu","helpMenuItems","forEach","menuItem","menuItemType","url","createUserMenuItem","createUserMenuLink","label","target","createUserMenuButton","onclick","setAttribute","helpMenuContainer","helpMenuTrigger","type","helpMenuIcon","helpIcon","throttledMenuToggle","throttle","event","toggleMenu","addEventListener","timer","setTimeout","clearTimeout","profileLoginButtonPre","loginStatusBox","onClick","button","innerText","link","_x9","_x10","_x11","_createUserMenu","_callee4","fetcher","loggedInMenuList","loggedInMenu","loggedInMenuTrigger","profileImg","loggedInMenuContainer","_callee4$","_context4","load","getProfileImg","child","menuProfileItem","profileUrl","findImage","emptyProfile","_unused","profileImage","style","backgroundImage","concat","trigger","menu","isExpanded","getAttribute","expand","close","toString"],"sources":["../../src/header/index.ts"],"sourcesContent":["/* global EventListenerOrEventListenerObject */\n/*\n    This file was copied from mashlib/src/global/header.ts file. It is modified to\n    work in solid-ui by adjusting where imported functions are found.\n */\nimport { IndexedFormula, NamedNode } from 'rdflib'\nimport { icons } from '../index'\nimport { authn, authSession } from 'solid-logic'\nimport { loginStatusBox } from '../login/login'\n// import { loginStatusBox, authSession, currentUser } from '../authn/authn'\nimport * as widgets from '../widgets'\nimport { emptyProfile } from './empty-profile'\nimport { addStyleClassToElement, getPod, throttle } from '../utils/headerFooterHelpers'\n\n/**\n * menu icons\n*/\nconst DEFAULT_HELP_MENU_ICON = icons.iconBase + 'noun_help.svg'\nconst DEFAUL_SOLID_ICON_URL = 'https://solidproject.org/assets/img/solid-emblem.svg'\n\nexport type MenuItemLink = {\n  label: string,\n  url: string,\n  target?: string\n}\n\nexport type MenuItemButton = {\n  label: string,\n  onclick: () => void\n}\n\nexport type MenuItems = MenuItemLink | MenuItemButton\n\n/*\n  HeaderOptions allow for customizing the logo and menu list.  If a logo is not provided the default\n  is solid. Menulist will always show a link to logout and to the users profile.\n  */\nexport type HeaderOptions = {\n  logo?: string,\n  helpIcon?: string,\n  helpMenuList?: MenuItems[]\n}\n\n/**\n * Initialize header component, the header object returned depends on whether the user is authenticated.\n * @param store the data store\n * @param userMenuList a list of menu items when the user is logged in\n * @param options allow the header to be customized with a personalized logo, help icon and a help menu list of links or buttons.\n * @returns a header for an authenticated user with menu items given or a login screen\n */\nexport async function initHeader (store: IndexedFormula, userMenuList: MenuItems[], options?: HeaderOptions) {\n  const header = document.getElementById('PageHeader')\n  if (!header) {\n    return\n  }\n\n  const pod = getPod()\n  rebuildHeader(header, store, pod, userMenuList, options)()\n  authSession.onLogout(rebuildHeader(header, store, pod, userMenuList, options))\n  authSession.onLogin(rebuildHeader(header, store, pod, userMenuList, options))\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function rebuildHeader (header: HTMLElement, store: IndexedFormula, pod: NamedNode, userMenuList: MenuItems[], options?: HeaderOptions) {\n  return async () => {\n    const user = authn.currentUser()\n    header.innerHTML = ''\n    header.appendChild(await createBanner(store, pod, user, userMenuList, options))\n  }\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createBanner (store: IndexedFormula, pod: NamedNode, user: NamedNode | null, userMenuList: MenuItems[], options?: HeaderOptions): Promise<HTMLElement> {\n  const podLink = document.createElement('a')\n  podLink.href = pod.uri\n  addStyleClassToElement(podLink, ['header-banner__link'])\n  const image = document.createElement('img')\n  if (options) {\n    image.src = options.logo ? options.logo : DEFAUL_SOLID_ICON_URL\n  }\n  addStyleClassToElement(image, ['header-banner__icon'])\n  podLink.appendChild(image)\n\n  const userMenu = user\n    ? await createUserMenu(store, user, userMenuList)\n    : createLoginSignUpButtons()\n\n  const banner = document.createElement('div')\n  addStyleClassToElement(banner, ['header-banner'])\n  banner.appendChild(podLink)\n\n  const leftSideOfHeader = document.createElement('div')\n  addStyleClassToElement(leftSideOfHeader, ['header-banner__right-menu'])\n  leftSideOfHeader.appendChild(userMenu)\n\n  if (options && options.helpMenuList) {\n    const helpMenu = createHelpMenu(options, options.helpMenuList)\n    leftSideOfHeader.appendChild(helpMenu as HTMLDivElement)\n  }\n\n  banner.appendChild(leftSideOfHeader)\n\n  return banner\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createHelpMenu (options: HeaderOptions, helpMenuItems: MenuItems[]) {\n  if (!helpMenuItems) return\n  const helpMenuList = document.createElement('ul')\n  addStyleClassToElement(helpMenuList, ['header-user-menu__list'])\n  helpMenuItems.forEach(function (menuItem) {\n    const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n    if (menuItemType === 'url') {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n    } else {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n    }\n  })\n\n  const helpMenu = document.createElement('nav')\n\n  addStyleClassToElement(helpMenu, ['header-user-menu__navigation-menu'])\n  helpMenu.setAttribute('aria-hidden', 'true')\n  helpMenu.appendChild(helpMenuList)\n\n  const helpMenuContainer = document.createElement('div')\n  addStyleClassToElement(helpMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(helpMenuContainer, ['header-user-menu'])\n  helpMenuContainer.appendChild(helpMenu)\n\n  const helpMenuTrigger = document.createElement('button')\n  addStyleClassToElement(helpMenuTrigger, ['header-user-menu__trigger'])\n  helpMenuTrigger.type = 'button'\n\n  const helpMenuIcon = document.createElement('img')\n  helpMenuIcon.src = (options && options.helpIcon) ? options.helpIcon : icons.iconBase + DEFAULT_HELP_MENU_ICON\n  addStyleClassToElement(helpMenuIcon, ['header-banner__help-icon'])\n  helpMenuContainer.appendChild(helpMenuTrigger)\n  helpMenuTrigger.appendChild(helpMenuIcon)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, helpMenuTrigger, helpMenu), 50)\n  helpMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  helpMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  helpMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return helpMenuContainer\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createLoginSignUpButtons () {\n  const profileLoginButtonPre = document.createElement('div')\n  addStyleClassToElement(profileLoginButtonPre, ['header-banner__login'])\n  profileLoginButtonPre.appendChild(loginStatusBox(document, null, {}))\n  return profileLoginButtonPre\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuButton (label: string, onClick: EventListenerOrEventListenerObject): HTMLElement {\n  const button = document.createElement('button')\n  addStyleClassToElement(button, ['header-user-menu__button'])\n  button.addEventListener('click', onClick)\n  button.innerText = label\n  return button\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuLink (label: string, href: string, target?: string): HTMLElement {\n  const link = document.createElement('a')\n  addStyleClassToElement(link, ['header-user-menu__link'])\n  link.href = href\n  link.innerText = label\n  if (target) link.target = target\n  return link\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createUserMenu (store: IndexedFormula, user: NamedNode, userMenuList: MenuItems[]): Promise<HTMLElement> {\n  const fetcher = (<any>store).fetcher\n  if (fetcher) {\n    // Making sure that Profile is loaded before building menu\n    await fetcher.load(user)\n  }\n\n  const loggedInMenuList = document.createElement('ul')\n  addStyleClassToElement(loggedInMenuList, ['header-user-menu__list'])\n  if (userMenuList) {\n    userMenuList.forEach(function (menuItem) {\n      const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n      if (menuItemType === 'url') {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n      } else {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n      }\n    })\n  }\n  const loggedInMenu = document.createElement('nav')\n\n  addStyleClassToElement(loggedInMenu, ['header-user-menu__navigation-menu'])\n  loggedInMenu.setAttribute('aria-hidden', 'true')\n  loggedInMenu.appendChild(loggedInMenuList)\n\n  const loggedInMenuTrigger = document.createElement('button')\n  addStyleClassToElement(loggedInMenuTrigger, ['header-user-menu__trigger'])\n  loggedInMenuTrigger.type = 'button'\n  const profileImg = getProfileImg(store, user)\n  if (typeof profileImg === 'string') {\n    loggedInMenuTrigger.innerHTML = profileImg\n  } else {\n    loggedInMenuTrigger.appendChild(profileImg)\n  }\n\n  const loggedInMenuContainer = document.createElement('div')\n  addStyleClassToElement(loggedInMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(loggedInMenuContainer, ['header-user-menu'])\n  loggedInMenuContainer.appendChild(loggedInMenuTrigger)\n  loggedInMenuContainer.appendChild(loggedInMenu)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, loggedInMenuTrigger, loggedInMenu), 50)\n  loggedInMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  loggedInMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  loggedInMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return loggedInMenuContainer\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuItem (child: HTMLElement): HTMLElement {\n  const menuProfileItem = document.createElement('li')\n  addStyleClassToElement(menuProfileItem, ['header-user-menu__list-item'])\n  menuProfileItem.appendChild(child)\n  return menuProfileItem\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function getProfileImg (store: IndexedFormula, user: NamedNode): string | HTMLElement {\n  let profileUrl = null\n  try {\n    profileUrl = widgets.findImage(user)\n    if (!profileUrl) {\n      return emptyProfile\n    }\n  } catch {\n    return emptyProfile\n  }\n\n  const profileImage = document.createElement('div')\n  addStyleClassToElement(profileImage, ['header-user-menu__photo'])\n  profileImage.style.backgroundImage = `url(${profileUrl})`\n  return profileImage\n}\n\n/**\n * @internal\n */\nfunction toggleMenu (event: Event, trigger: HTMLButtonElement, menu: HTMLElement): void {\n  const isExpanded = trigger.getAttribute('aria-expanded') === 'true'\n  const expand = event.type === 'mouseover'\n  const close = event.type === 'mouseout'\n  if ((isExpanded && expand) || (!isExpanded && close)) {\n    return\n  }\n  trigger.setAttribute('aria-expanded', (!isExpanded).toString())\n  menu.setAttribute('aria-hidden', isExpanded.toString())\n}\n"],"mappings":"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"}
{"version":3,"sources":["../../src/header/index.ts"],"names":["initHeader","store","options","header","document","getElementById","pod","rebuildHeader","authSession","onLogout","onLogin","user","innerHTML","createBanner","appendChild","podLink","createElement","href","uri","image","src","logo","createUserMenu","createLoginSignUpButtons","userMenu","helpMenu","createHelpMenu","banner","leftSideOfHeader","helpMenuList","createUserMenuItem","createUserMenuLink","setAttribute","helpIcon","icons","iconBase","helpMenuContainer","helpMenuTrigger","type","helpMenuIcon","throttledMenuToggle","event","toggleMenu","addEventListener","timer","setTimeout","clearTimeout","profileLoginButtonPre","createUserMenuButton","label","onClick","button","innerText","target","link","fetcher","load","loggedInMenuList","menuList","forEach","menuItem","menuItemType","url","logout","loggedInMenu","loggedInMenuTrigger","profileImg","getProfileImg","loggedInMenuContainer","child","menuProfileItem","profileUrl","widgets","findImage","emptyProfile","profileImage","style","backgroundImage","trigger","menu","isExpanded","getAttribute","expand","close","toString"],"mappings":"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","sourcesContent":["/* global EventListenerOrEventListenerObject */\n/*\n    This file was copied from mashlib/src/global/header.ts file. It is modified to\n    work in solid-ui by adjusting where imported functions are found.\n */\nimport { IndexedFormula, NamedNode } from 'rdflib'\nimport { icons } from '..'\nimport { loginStatusBox, authSession, currentUser } from '../authn/authn'\nimport * as widgets from '../widgets'\nimport { emptyProfile } from './empty-profile'\nimport { addStyleClassToElement, getPod, throttle } from './headerHelpers'\n\nexport type MenuItemLink = {\n  label: string,\n  url: string\n}\n\nexport type MenuItemButton = {\n  label: string,\n  onclick: () => {}\n}\n\nexport type MenuItems = MenuItemLink | MenuItemButton\n\n/*\nHeaderOptions allow for customizing the logo and menu list.  If a logo is not provided the default\n    is solid. Menulist will always show a link to logout and to the users profile.\n  */\nexport type HeaderOptions = {\n  logo?: string,\n  menuList?: MenuItems[]\n}\n\n/**\n * Initialize header component, the header object returned depends on whether the user is authenticated.\n * @param store the data store\n * @param options allow the header to be customized with a personalized logo and a menu list of links or buttons.\n * @returns a header for an authenticated user with menu items given or a login screen\n */\nexport async function initHeader (store: IndexedFormula, options?: HeaderOptions) {\n  const header = document.getElementById('PageHeader')\n  if (!header) {\n    return\n  }\n\n  const pod = getPod()\n  rebuildHeader(header, store, pod, options)()\n  authSession.onLogout(rebuildHeader(header, store, pod, options))\n  authSession.onLogin(rebuildHeader(header, store, pod, options))\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function rebuildHeader (header: HTMLElement, store: IndexedFormula, pod: NamedNode, options?: HeaderOptions) {\n  return async () => {\n    const user = currentUser()\n    header.innerHTML = ''\n    header.appendChild(await createBanner(store, pod, user, options))\n  }\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createBanner (store: IndexedFormula, pod: NamedNode, user: NamedNode | null, options?: HeaderOptions): Promise<HTMLElement> {\n  const podLink = document.createElement('a')\n  podLink.href = pod.uri\n  addStyleClassToElement(podLink, ['header-banner__link'])\n  const image = document.createElement('img')\n  if (options) {\n    image.src = options.logo ? options.logo : 'https://solidproject.org/assets/img/solid-emblem.svg'\n  }\n  addStyleClassToElement(image, ['header-banner__icon'])\n  podLink.appendChild(image)\n\n  const userMenu = user\n    ? await createUserMenu(store, user, options)\n    : createLoginSignUpButtons()\n\n  const helpMenu = createHelpMenu()\n\n  const banner = document.createElement('div')\n  addStyleClassToElement(banner, ['header-banner'])\n  banner.appendChild(podLink)\n\n  const leftSideOfHeader = document.createElement('div')\n  addStyleClassToElement(leftSideOfHeader, ['header-banner__right-menu'])\n  leftSideOfHeader.appendChild(userMenu)\n  leftSideOfHeader.appendChild(helpMenu)\n\n  banner.appendChild(leftSideOfHeader)\n\n  return banner\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createHelpMenu () {\n  const helpMenuList = document.createElement('ul')\n  addStyleClassToElement(helpMenuList, ['header-user-menu__list'])\n  helpMenuList.appendChild(createUserMenuItem(createUserMenuLink('User guide', 'https://github.com/solid/userguide', '_blank')))\n  helpMenuList.appendChild(createUserMenuItem(createUserMenuLink('Report a problem', 'https://github.com/solid/solidos/issues', '_blank')))\n\n  const helpMenu = document.createElement('nav')\n\n  addStyleClassToElement(helpMenu, ['header-user-menu__navigation-menu'])\n  helpMenu.setAttribute('aria-hidden', 'true')\n  helpMenu.appendChild(helpMenuList)\n\n  const helpIcon = icons.iconBase + 'noun_144.svg'\n\n  const helpMenuContainer = document.createElement('div')\n  addStyleClassToElement(helpMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(helpMenuContainer, ['header-user-menu'])\n  helpMenuContainer.appendChild(helpMenu)\n\n  const helpMenuTrigger = document.createElement('button')\n  addStyleClassToElement(helpMenuTrigger, ['header-user-menu__trigger'])\n  helpMenuTrigger.type = 'button'\n\n  const helpMenuIcon = document.createElement('img')\n  helpMenuIcon.src = helpIcon\n  addStyleClassToElement(helpMenuIcon, ['header-banner__help-icon'])\n  helpMenuContainer.appendChild(helpMenuTrigger)\n  helpMenuTrigger.appendChild(helpMenuIcon)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, helpMenuTrigger, helpMenu), 50)\n  helpMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  helpMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  helpMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return helpMenuContainer\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createLoginSignUpButtons () {\n  const profileLoginButtonPre = document.createElement('div')\n  addStyleClassToElement(profileLoginButtonPre, ['header-banner__login'])\n  profileLoginButtonPre.appendChild(loginStatusBox(document, null, {}))\n  return profileLoginButtonPre\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuButton (label: string, onClick: EventListenerOrEventListenerObject): HTMLElement {\n  const button = document.createElement('button')\n  addStyleClassToElement(button, ['header-user-menu__button'])\n  button.addEventListener('click', onClick)\n  button.innerText = label\n  return button\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuLink (label: string, href: string, target?:string): HTMLElement {\n  const link = document.createElement('a')\n  addStyleClassToElement(link, ['header-user-menu__link'])\n  link.href = href\n  link.innerText = label\n  if (target) link.target = target\n  return link\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createUserMenu (store: IndexedFormula, user: NamedNode, options?: HeaderOptions): Promise<HTMLElement> {\n  const fetcher = (<any>store).fetcher\n  if (fetcher) {\n    // Making sure that Profile is loaded before building menu\n    await fetcher.load(user)\n  }\n  const loggedInMenuList = document.createElement('ul')\n  addStyleClassToElement(loggedInMenuList, ['header-user-menu__list'])\n  loggedInMenuList.appendChild(createUserMenuItem(createUserMenuLink('Show your profile', user.uri)))\n  if (options) {\n    if (options.menuList) {\n      options.menuList.forEach(function (menuItem) {\n        const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n        if (menuItemType === 'url') {\n          loggedInMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, menuItem[menuItemType])))\n        } else {\n          loggedInMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, menuItem[menuItemType])))\n        }\n      })\n    }\n  }\n\n  loggedInMenuList.appendChild(createUserMenuItem(createUserMenuButton('Log out', () => authSession.logout())))\n\n  const loggedInMenu = document.createElement('nav')\n\n  addStyleClassToElement(loggedInMenu, ['header-user-menu__navigation-menu'])\n  loggedInMenu.setAttribute('aria-hidden', 'true')\n  loggedInMenu.appendChild(loggedInMenuList)\n\n  const loggedInMenuTrigger = document.createElement('button')\n  addStyleClassToElement(loggedInMenuTrigger, ['header-user-menu__trigger'])\n  loggedInMenuTrigger.type = 'button'\n  const profileImg = getProfileImg(store, user)\n  if (typeof profileImg === 'string') {\n    loggedInMenuTrigger.innerHTML = profileImg\n  } else {\n    loggedInMenuTrigger.appendChild(profileImg)\n  }\n\n  const loggedInMenuContainer = document.createElement('div')\n  addStyleClassToElement(loggedInMenuContainer, ['header-banner__user-menu'])\n  addStyleClassToElement(loggedInMenuContainer, ['header-user-menu'])\n  loggedInMenuContainer.appendChild(loggedInMenuTrigger)\n  loggedInMenuContainer.appendChild(loggedInMenu)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, loggedInMenuTrigger, loggedInMenu), 50)\n  loggedInMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  loggedInMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n  })\n  loggedInMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n  })\n\n  return loggedInMenuContainer\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuItem (child: HTMLElement): HTMLElement {\n  const menuProfileItem = document.createElement('li')\n  addStyleClassToElement(menuProfileItem, ['header-user-menu__list-item'])\n  menuProfileItem.appendChild(child)\n  return menuProfileItem\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function getProfileImg (store: IndexedFormula, user: NamedNode): string | HTMLElement {\n  const profileUrl = null\n  try {\n    const profileUrl = widgets.findImage(user)\n    if (!profileUrl) {\n      return emptyProfile\n    }\n  } catch {\n    return emptyProfile\n  }\n\n  const profileImage = document.createElement('div')\n  addStyleClassToElement(profileImage, ['header-user-menu__photo'])\n  profileImage.style.backgroundImage = `url(\"${profileUrl}\")`\n  return profileImage\n}\n\n/**\n * @internal\n */\nfunction toggleMenu (event: Event, trigger: HTMLButtonElement, menu: HTMLElement): void {\n  const isExpanded = trigger.getAttribute('aria-expanded') === 'true'\n  const expand = event.type === 'mouseover'\n  const close = event.type === 'mouseout'\n  if ((isExpanded && expand) || (!isExpanded && close)) {\n    return\n  }\n  trigger.setAttribute('aria-expanded', (!isExpanded).toString())\n  menu.setAttribute('aria-hidden', isExpanded.toString())\n}\n"],"file":"index.js"}
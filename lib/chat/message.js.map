{"version":3,"file":"message.js","names":["_infinite","require","_messageTools","_bookmarks","_chatLogic","debug","_interopRequireWildcard","_iconBase","_solidLogic","_login","_index","ns","pad","style","utils","widgets","_signature","_keys","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","_createForOfIteratorHelper","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","F","s","done","value","_e2","f","TypeError","normalCompletion","didErr","err","step","next","_e3","minLen","_arrayLikeToArray","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","dom","window","document","messageBodyStyle","label","elementForImageURI","imageUri","options","img","createElement","height","inlineImageHeightEms","trim","setAttribute","anchor","appendChild","makeDraggable","$rdf","sym","text","term","uri","addEventListener","openHrefInOutlineMode","textContent","nickname","person","store","any","foaf","creatorAndDate","td1","creator","date","message","nickAnchor","fetcher","nowOrWhenFetched","doc","undefined","_ok","_body","creatorAndDateHorizontal","dateBit","fontSize","marginLeft","renderMessageRow","_x","_x2","_x3","_x4","_x5","_renderMessageRow","_asyncToGenerator2","_regenerator","mark","_callee9","channelObject","fresh","userContext","unsignedMessage","colorizeByAuthor","latestVersion","latestVersionCreator","msgId","content","versions","replies","thread","straightReplies","_iterator2","_step2","reply","signature","msg","originalMessage","edited","sortDate","messageRow","bothDates","td2","isURI","para","isImage","_img","anc","bgcolor","getBgColor","strip","td3","toolsButton","wrap","_callee9$","_context10","prev","_getBgColor","dct","mostRecentVersion","sent","sioc","allVersions","log","join","map","version","each","flat","holds","rdf","concat","SEC","getBlankMsg","id","created","maker","warn","getPublicKey","then","publicKey","regex","match","verifySignature","originalVersion","sameTerm","the","AJAR_date","AJAR_subject","authorDateOnLeft","setImage","shortDate","expandImagesInline","href","lightColorHash","sentimentStripLinked","children","button","icons","iconBase","_ref4","_callee8","_event","toolsTR","tools","toolsTD","_callee8$","_context9","toolTR","parentNode","removeChild","abrupt","messageToolbar","chatOptions","nextSibling","parentElement","insertBefore","stop","_x20","showThread","_e","switchToEditor","_x6","_x7","_x8","_x9","_switchToEditor","_callee10","messageTable","editRow","_callee10$","_context11","t0","renderMessageEditor","t1","t2","t3","t4","t5","originalRow","visibility","revertEditing","messageEditor","handleFieldInput","_x10","_handleFieldInput","_callee5","_callee5$","_context6","sendMessage","field","_x11","_x12","_sendMessage","_callee7","fromMainField","sendComplete","_sendComplete","statusArea","_callee7$","_context8","_sendComplete3","_callee6","_text2","oldRow","_callee6$","_context7","insertMessageIntoTable","backgroundColor","disabled","scrollIntoView","newestFirst","focus","select","_sendComplete2","_x18","_x19","updateMessage","errorMessageBlock","droppedFileHandler","files","base","chatDocument","dir","uploadFiles","_ref","_callee","theFile","destURI","_callee$","_context2","_x13","_x14","droppedURIHandler","_ref2","_callee2","uris","_iterator","_step","_callee2$","_context3","finish","_x15","turnOnInput","getImageDoc","imageDoc","Date","now","tookPicture","_x16","_tookPicture","_callee4","_callee4$","_context5","menuButton","menuHandler","buttonStyle","rhs","me","authn","currentUser","menuOptions","div","newBase","event","chatChannel","lhs","middle","innerHTML","rows","anyValue","_ref3","_callee3","_callee3$","_context4","code","shiftKey","shiftEnterSendsMessage","_x17","makeDropTarget","sendButton","sendIcon","cancelButton","dateFolder","leafDocumentFromDate","media","cameraButton","recordParticipation","channel","context","ensureLoggedIn","assign","findBookmarkDocument","_context"],"sources":["../../src/chat/message.js"],"sourcesContent":["/**  UI code for individual messages: display them, edit them\n *\n * @packageDocumentation\n */\n\n/* global $rdf */\nimport { insertMessageIntoTable } from './infinite'\nimport { messageToolbar, sentimentStripLinked } from './messageTools'\nimport { findBookmarkDocument } from './bookmarks'\nimport { mostRecentVersion, originalVersion, allVersions } from './chatLogic'\nimport * as debug from '../debug'\nimport { icons } from '../iconBase'\nimport { store, authn } from 'solid-logic'\nimport { ensureLoggedIn } from '../login/login'\nimport { media } from '../media/index'\nimport * as ns from '../ns'\nimport * as pad from '../pad'\nimport * as style from '../style'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\nimport { getBlankMsg, verifySignature, SEC } from './signature'\nimport { getPublicKey } from './keys'\n\nconst dom = window.document\nconst messageBodyStyle = style.messageBodyStyle\n\nconst label = utils.label\n\n/**\n * elementForImageURI\n * HTML component for an image\n * @param imageUri\n * @param options { inlineImageHeightEms }\n * @returns HTMLAnchorElement For Image\n */\nexport function elementForImageURI (imageUri, options) {\n  const img = dom.createElement('img')\n  let height = '10'\n  if (options.inlineImageHeightEms) {\n    height = ('' + options.inlineImageHeightEms).trim()\n  }\n  img.setAttribute(\n    'style',\n    'max-height: ' + height + 'em; border-radius: 1em; margin: 0.7em;'\n  )\n  // widgets.makeDropTarget(img, handleURIsDroppedOnMugshot, droppedFileHandler)\n  if (imageUri) img.setAttribute('src', imageUri)\n  const anchor = dom.createElement('a')\n  anchor.setAttribute('href', imageUri)\n  anchor.setAttribute('target', 'images')\n  anchor.appendChild(img)\n  widgets.makeDraggable(img, $rdf.sym(imageUri))\n  return anchor\n}\n\nconst anchor = function (text, term) {\n  // If there is no link return an element anyway\n  const a = dom.createElement('a')\n  if (term && term.uri) {\n    a.setAttribute('href', term.uri)\n    a.addEventListener('click', widgets.openHrefInOutlineMode, true)\n    a.setAttribute('style', 'color: #3B5998; text-decoration: none; ') // font-weight: bold\n  }\n  a.textContent = text\n  return a\n}\n\nfunction nickname (person) {\n  const s = store.any(person, ns.foaf('nick'))\n  if (s) return '' + s.value\n  return '' + label(person)\n}\n\n/**\n * creatorAndDate\n * Displays creator and date for a chat message\n * inside the `td1` element\n * @param td1\n * @param creator\n * @param date\n * @param message\n * @returns HTMLAnchorElement For Image\n */\nexport function creatorAndDate (td1, creator, date, message) {\n  const nickAnchor = td1.appendChild(anchor(nickname(creator), creator))\n  if (creator.uri) {\n    store.fetcher.nowOrWhenFetched(creator.doc(), undefined, function (\n      _ok,\n      _body\n    ) {\n      nickAnchor.textContent = nickname(creator)\n    })\n  }\n  td1.appendChild(dom.createElement('br'))\n  td1.appendChild(anchor(date, message))\n}\n\n/**\n * creatorAndDateHorizontal\n * Horizontally displays creator and date for a chat message\n * inside the `td1` element\n * @param td1\n * @param creator\n * @param date\n * @param message\n * @returns HTMLAnchorElement For Image\n */\nexport function creatorAndDateHorizontal (td1, creator, date, message) {\n  const nickAnchor = td1.appendChild(anchor(label(creator), creator))\n  if (creator.uri) {\n    store.fetcher.nowOrWhenFetched(creator.doc(), undefined, function (\n      _ok,\n      _body\n    ) {\n      nickAnchor.textContent = nickname(creator)\n    })\n  }\n  const dateBit = td1.appendChild(anchor(date, message))\n  dateBit.style.fontSize = '80%'\n  dateBit.style.marginLeft = '1em'\n  td1.appendChild(dom.createElement('br'))\n}\n\n/**\n * renderMessageRow\n * Renders a chat message, read-only mode\n * @param channelObject\n * @param message\n * @param fresh\n * @param options\n * @param userContext\n * @returns Message Row HTML Table Element\n */\nexport async function renderMessageRow (channelObject, message, fresh, options, userContext) {\n  let unsignedMessage = false\n  const colorizeByAuthor =\n    options.colorizeByAuthor === '1' || options.colorizeByAuthor === true\n\n  // const id = store.any(latestVersion, ns.sioc('id'))\n  // const replies = store.each(latestVersion, ns.sioc('has_reply'))\n\n  const creator = store.any(message, ns.foaf('maker'))\n  const date = store.any(message, ns.dct('created'))\n  const latestVersion = await mostRecentVersion(message)\n  const latestVersionCreator = store.any(latestVersion, ns.foaf('maker'))\n\n  // use latest content if same owner, else use original\n  // this is may be too strict. Should we find latest valid version if any ?\n  const msgId = creator.uri === latestVersionCreator?.uri ? latestVersion : message\n  const content = store.any(msgId, ns.sioc('content'))\n\n  const versions = await allVersions(msgId)\n  if (versions.length > 1) {\n    debug.log('renderMessageRow versions: ', versions.join(',  '))\n  }\n  // be tolerant in accepting replies on any version of a message\n  const replies = versions.map(version => store.each(version, ns.sioc('has_reply'))).flat()\n\n  let thread = null\n  const straightReplies = []\n  for (const reply of replies) {\n    if (store.holds(reply, ns.rdf('type'), ns.sioc('Thread'))) {\n      thread = reply\n      debug.log('renderMessageRow: found thread: ' + thread)\n    } else {\n      straightReplies.push(reply)\n    }\n  }\n  if (straightReplies.length > 1) {\n    debug.log('renderMessageRow: found normal replies: ', straightReplies)\n  }\n  if (!thread) {\n    // thread = store.any(message, ns.sioc('has_reply'))\n    thread = store.any(null, ns.sioc('has_member'), message)\n  }\n  // debug.log('@@@@ is thread' + thread)\n\n  // get signature\n  const signature = store.any(msgId, $rdf.sym(`${SEC}proofValue`))\n\n  // set proof message object\n  const msg = getBlankMsg()\n  msg.id = msgId.uri\n  msg.created = store.any(msgId, ns.dct('created')).value\n  msg.content = content.value\n  msg.maker = creator.uri\n\n  // verify signature\n  if (!signature?.value) { // unsigned message\n    unsignedMessage = true\n    debug.warn(msgId.uri + ' is unsigned') // TODO replace with UI (colored message ?)\n  } else { // signed message, get public key and check signature\n    getPublicKey(creator).then(publicKey => {\n      // debug.log(creator.uri + '\\n' + msg.created + '\\n' + msg.id + '\\n' + publicKey)\n      if (!publicKey) {\n        debug.warn('message is signed but ' + creator.uri + ' is missing publicKey')\n      }\n      // check that publicKey is a valid hex string\n      const regex = /[0-9A-Fa-f]{6}/g\n      if (!publicKey?.match(regex)) debug.warn('invalid publicKey hex string\\n' + creator.uri + '\\n' + publicKey)\n      // verify signature\n      else if (signature?.value && !verifySignature(signature?.value, msg, publicKey)) debug.warn('invalid signature\\n' + msg.id)\n    })\n  }\n\n  const originalMessage = await originalVersion(message)\n  const edited = !message.sameTerm(originalMessage)\n  // @@ load it first  @@   Or display the new data at the old date.\n  // @@@ kludge!\n  const sortDate = store.the(originalMessage, ns.dct('created'), null, originalMessage.doc()) || store.the(message, ns.dct('created'), null, message.doc())\n  // In message\n\n  const messageRow = dom.createElement('tr')\n  if (unsignedMessage) messageRow.setAttribute('style', 'background-color: red')\n  messageRow.AJAR_date = sortDate.value\n  messageRow.AJAR_subject = message\n\n  const td1 = dom.createElement('td')\n  messageRow.appendChild(td1)\n  if (!options.authorDateOnLeft) {\n    const img = dom.createElement('img')\n    img.setAttribute(\n      'style',\n      'max-height: 2.5em; max-width: 2.5em; border-radius: 0.5em; margin: auto;'\n    )\n    widgets.setImage(img, creator)\n    td1.appendChild(img)\n  } else {\n    creatorAndDate(td1, creator, widgets.shortDate(sortDate.value), message)\n  }\n  let bothDates = widgets.shortDate(sortDate.value)\n  if (edited) {\n    bothDates += ' ... ' + widgets.shortDate(date.value)\n  }\n\n  // Render the content ot the message itself\n  const td2 = messageRow.appendChild(dom.createElement('td'))\n\n  if (!options.authorDateOnLeft) {\n    creatorAndDateHorizontal(\n      td2,\n      creator,\n      bothDates, // widgets.shortDate(dateString)\n      message\n    )\n  }\n  const text = content ? content.value.trim() : '??? no content?'\n  const isURI = /^https?:\\/[^ <>]*$/i.test(text)\n  let para = null\n  if (isURI) {\n    const isImage = /\\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(text) // @@ Should use content-type not URI\n    if (isImage && options.expandImagesInline) {\n      const img = elementForImageURI(text, options)\n      td2.appendChild(img)\n    } else {\n      // Link but not Image\n      const anc = td2.appendChild(dom.createElement('a'))\n      para = anc.appendChild(dom.createElement('p'))\n      anc.href = text\n      para.textContent = text\n      td2.appendChild(anc)\n    }\n  } else {\n    // text\n    para = dom.createElement('p')\n    td2.appendChild(para)\n    para.textContent = text\n  }\n  if (para) {\n    const bgcolor = colorizeByAuthor\n      ? pad.lightColorHash(creator)\n      : getBgColor(fresh)\n    para.setAttribute(\n      'style',\n      messageBodyStyle + 'background-color: ' + bgcolor + ';'\n    )\n  }\n\n  function getBgColor (fresh) {\n    return fresh ? '#e8ffe8' : 'white'\n  }\n\n  // Sentiment strip\n  const strip = await sentimentStripLinked(message, message.doc())\n  if (strip.children.length) {\n    td2.appendChild(dom.createElement('br'))\n    td2.appendChild(strip)\n  }\n\n  // Message tool bar button\n  const td3 = dom.createElement('td')\n  messageRow.appendChild(td3)\n  const toolsButton = widgets.button(\n    dom,\n    icons.iconBase + 'noun_243787.svg',\n    '...'\n  )\n  td3.appendChild(toolsButton)\n  toolsButton.addEventListener('click', async function (_event) {\n    if (messageRow.toolTR) {\n      // already got a toolbar? Toogle\n      messageRow.parentNode.removeChild(messageRow.toolTR)\n      delete messageRow.toolTR\n      return\n    }\n    const toolsTR = dom.createElement('tr')\n    const tools = await messageToolbar(message, messageRow, { ...userContext, chatOptions: options }, channelObject)\n    tools.style =\n      'border: 0.05em solid #888; border-radius: 0 0 0.7em 0.7em;  border-top: 0; height:3.5em; background-color: #fff;' // @@ fix\n    if (messageRow.nextSibling) {\n      messageRow.parentElement.insertBefore(toolsTR, messageRow.nextSibling)\n    } else {\n      messageRow.parentElement.appendChild(toolsTR)\n    }\n    messageRow.toolTR = toolsTR\n    toolsTR.appendChild(dom.createElement('td')) // left\n    const toolsTD = toolsTR.appendChild(dom.createElement('td'))\n    toolsTR.appendChild(dom.createElement('td')) // right\n    toolsTD.appendChild(tools)\n  })\n  if (thread && options.showThread) {\n    // debug.log('  message has thread ' + thread)\n    td3.appendChild(widgets.button(\n      dom,\n      icons.iconBase + 'noun_1180164.svg', // right arrow .. @@ think of stg better\n      'see thread',\n      _e => {\n        // debug.log('@@@@ Calling showThread thread ' + thread)\n        options.showThread(thread, options)\n      }\n    ))\n  }\n  return messageRow\n} // END OF RENDERMESSAGE\n\nexport async function switchToEditor (messageRow, message, channelObject, userContext) {\n  const messageTable = messageRow.parentNode\n  const editRow = renderMessageEditor(channelObject, messageTable, userContext,\n    channelObject.options, await mostRecentVersion(message))\n  messageTable.insertBefore(editRow, messageRow)\n  editRow.originalRow = messageRow\n  messageRow.style.visibility = 'hidden' // Hide the original message. unhide if user cancels edit\n}\n/*       Control for a new message -- or editing an old message ***************\n *\n */\nexport function renderMessageEditor (channelObject, messageTable, userContext, options, originalMessage) {\n  function revertEditing (messageEditor) {\n    messageEditor.originalRow.style.visibility = 'visible' // restore read-only version\n    messageEditor.parentNode.removeChild(messageEditor)\n  }\n\n  async function handleFieldInput (_event) {\n    await sendMessage(field.value, true)\n  }\n\n  async function sendMessage (text, fromMainField) {\n    async function sendComplete (message, _text2) {\n      // const dateStamp = store.any(message, ns.dct('created'), null, message.doc())\n      // const content = $rdf.literal(text2)\n      await insertMessageIntoTable(channelObject, messageTable, message, false, options, userContext) // not green\n\n      if (originalMessage) { // editing another message\n        const oldRow = messageEditor.originalRow\n        // oldRow.style.display = '' // restore read-only version, re-attack\n        if (oldRow.parentNode) {\n          oldRow.parentNode.removeChild(oldRow) // No longer needed old version\n        } else {\n          debug.warn('No parentNode on old message ' + oldRow.textContent)\n          oldRow.style.backgroundColor = '#fee'\n          oldRow.style.visibility = 'hidden' // @@ FIX THIS AND REMOVE FROM DOM INSTEAD\n        }\n        messageEditor.parentNode.removeChild(messageEditor) // no longer need editor\n      } else {\n        if (fromMainField) {\n          field.value = '' // clear from out for reuse\n          field.setAttribute('style', messageBodyStyle)\n          field.disabled = false\n          field.scrollIntoView(options.newestFirst) // allign bottom (top)\n          field.focus() // Start typing next line immediately\n          field.select()\n        }\n      }\n      // await channelObject.div.refresh() // Add new day if nec  @@ add back\n    }\n\n    // const me = authn.currentUser() // Must be logged on or wuld have got login button\n    if (fromMainField) {\n      field.setAttribute('style', messageBodyStyle + 'color: #bbb;') // pendingedit\n      field.disabled = true\n    }\n\n    let message\n    try {\n      message = await channelObject.updateMessage(text, originalMessage, null, options.thread)\n    } catch (err) {\n      const statusArea = userContext.statusArea || messageEditor\n      statusArea.appendChild(\n        widgets.errorMessageBlock(dom, 'Error writing message: ' + err)\n      )\n      return\n    }\n    await sendComplete(message, text)\n  } // sendMessage\n\n  //    DRAG AND DROP\n  function droppedFileHandler (files) {\n    const base = messageTable.chatDocument.dir().uri\n    widgets.uploadFiles(\n      store.fetcher,\n      files,\n      base + 'Files',\n      base + 'Pictures',\n      async function (theFile, destURI) {\n        // @@@@@@ Wait for each if several\n        await sendMessage(destURI)\n      }\n    )\n  }\n\n  // When a set of URIs are dropped on the field\n  const droppedURIHandler = async function (uris) {\n    for (const uri of uris) {\n      await sendMessage(uri)\n    }\n  }\n\n  // When we are actually logged on\n  function turnOnInput () {\n    function getImageDoc () {\n      imageDoc = $rdf.sym(\n        chatDocument.dir().uri + 'Image_' + Date.now() + '.png'\n      )\n      return imageDoc\n    }\n\n    async function tookPicture (imageDoc) {\n      if (imageDoc) {\n        await sendMessage(imageDoc.uri)\n      }\n    }\n\n    // Body of turnOnInput\n\n    let menuButton\n    if (options.menuHandler) {\n      const menuButton = widgets.button(\n        dom, icons.iconBase + 'noun_243787.svg', 'More')\n      menuButton.setAttribute('style', style.buttonStyle + 'float: right;')\n      // menuButton.addEventListener('click', _event => sendMessage(), false) (done in turnoninput)\n      rhs.appendChild(menuButton)\n    }\n\n    if (options.menuHandler && menuButton) {\n      const me = authn.currentUser()\n      const menuOptions = {\n        me,\n        dom,\n        div: null, // @@ was: div\n        newBase: messageTable.chatDocument.dir().uri\n      }\n      menuButton.addEventListener(\n        'click',\n        event => {\n          options.menuHandler(event, channelObject.chatChannel, menuOptions)\n        },\n        false\n      )\n    }\n\n    const me = authn.currentUser() // If already logged on\n    creatorAndDate(lhs, me, '', null)\n\n    field = dom.createElement('textarea')\n    middle.innerHTML = ''\n    middle.appendChild(field)\n    field.rows = 3\n    if (originalMessage) {\n      field.value = store.anyValue(originalMessage, ns.sioc('content'), null, originalMessage.doc())\n    }\n    // field.cols = 40\n    field.setAttribute('style', messageBodyStyle + 'background-color: #eef;')\n\n    // Trap the Enter BEFORE it is used ti make a newline\n\n    field.addEventListener(\n      'keydown',\n      async function (e) {\n        // User preference?\n        if (e.code === 'Enter') {\n        // if (e.keyCode === 13) { // deprocated https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode\n          if ((!e.shiftKey && !options.shiftEnterSendsMessage) || (e.shiftKey && options.shiftEnterSendsMessage)) {\n            // Shift-Enter just adds a new line\n            // (note alt-enter doesn't add newline anyway on my setup - so have to use shift.\n            await handleFieldInput(e)\n          }\n        }\n      },\n      false\n    )\n\n    widgets.makeDropTarget(field, droppedURIHandler, droppedFileHandler)\n\n    rhs.innerHTML = ''\n\n    sendButton = widgets.button(dom, sendIcon, 'Send')\n    sendButton.style.float = 'right'\n    sendButton.addEventListener('click', _event => handleFieldInput(), false)\n    rhs.appendChild(sendButton)\n\n    if (originalMessage) { // Are we editing another message?\n      const cancelButton = rhs.appendChild(widgets.cancelButton(dom))\n      cancelButton.style.float = 'left'\n      // cancelButton.firstChild.style.opacity = '0.3' // moved to buttons\n      cancelButton.addEventListener('click', _event => revertEditing(messageEditor), false)\n      rhs.appendChild(cancelButton)\n    }\n\n    const chatDocument = channelObject.dateFolder.leafDocumentFromDate(new Date())\n    let imageDoc\n\n    middle.appendChild(\n      media.cameraButton(dom, store, getImageDoc, tookPicture)\n    )\n\n    pad.recordParticipation(channelObject.channel, channelObject.channel.doc()) // participation =\n  } // turn on inpuut\n\n  // Body of renderMessageEditor\n\n  let sortDate, sendIcon\n  if (originalMessage) {\n    sortDate = store.anyValue(originalMessage, ns.dct('created'), null, originalMessage.doc())\n    // text = store.anyValue(originalMessage, ns.sioc('content'), null, originalMessage.doc())\n    sendIcon = icons.iconBase + 'noun_1180158.svg' // Green check\n    // cancelIcon = icons.iconBase + 'noun_1180156.svg' // Black cross\n  } else {\n    sendIcon = icons.iconBase + 'noun_383448.svg'\n    sortDate = '9999-01-01T00:00:00Z' // ISO format for field sort\n    // text = ''\n  }\n  const messageEditor = dom.createElement('tr')\n  const lhs = dom.createElement('td')\n  const middle = dom.createElement('td')\n  const rhs = dom.createElement('td')\n  messageEditor.appendChild(lhs)\n  messageEditor.appendChild(middle)\n  messageEditor.appendChild(rhs)\n  messageEditor.AJAR_date = sortDate\n  // messageEditor.appendChild(dom.createElement('br'))\n\n  let field, sendButton\n  const context = { div: middle, dom }\n\n  ensureLoggedIn(context).then(context => {\n    // me = context.me\n    turnOnInput()\n    Object.assign(context, userContext)\n    findBookmarkDocument(context).then(_context => {\n      // debug.log('Bookmark file: ' + context.bookmarkDocument)\n    })\n  })\n\n  return messageEditor\n} // renderMessageEditor\n"],"mappings":"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","ignoreList":[]}
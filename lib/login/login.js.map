{"version":3,"file":"login.js","names":["_rdflib","require","_solidLogic","debug","_interopRequireWildcard","_log","ns","_signup","_style","utils","widgets","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","step","next","_e2","minLen","_arrayLikeToArray","toString","slice","constructor","name","from","test","arr","len","arr2","store","solidLogicSingleton","_solidLogicSingleton$","profile","loadPreferences","loadProfile","_solidLogicSingleton$2","typeIndex","getScopedAppInstances","getRegistrations","loadAllTypeIndexes","getScopedAppsFromIndex","deleteTypeIndexRegistration","ensureLoggedIn","context","me","authn","currentUser","saveUser","Promise","resolve","checkUser","then","webId","log","concat","div","dom","box","loginStatusBox","webIdUri","appendChild","ensureLoadedPreferences","_x","_ensureLoadedPreferences","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee4","statusArea","progressDisplay","complain","preferencesFile","m2","wrap","_callee4$","_context4","prev","_complain","message","errorMessageBlock","abrupt","ensureLoadedProfile","sent","parentNode","removeChild","t0","UnauthorizedError","alert","CrossOriginForbiddenError","window","location","origin","preferencesFileError","SameOriginForbiddenError","warn","NotEditableError","WebOperationError","FetchError","status","Error","stop","_x2","_ensureLoadedProfile","_callee5","logInContext","_callee5$","_context5","publicProfile","findAppInstances","_x3","_x4","_x5","_findAppInstances","_callee6","theClass","isPublic","items","_callee6$","_context6","filter","item","scope","label","instances","map","instance","scopeLabel","mine","sameTerm","agent","registrationControl","_x6","_x7","_x8","_registrationControl","_callee7","registrationStatements","renderScopeCheckbox","scopes","msg","tbody","form","_iterator","_step","row","_callee7$","_context7","_renderScopeCheckbox","statements","index","noun","buildCheckboxForm","_registrationStatemen","registrations","reg","newThing","st","solid","createElement","innerHTML","textContent","setAttribute","children","BlankNode","renderScopeHeadingRow","backgroundColor","cell","style","backgoundColor","header","textAlign","registrationList","_x9","_x10","_registrationList","_callee9","options","table","_iterator2","_step2","headingRow","_iterator3","_step3","_loop","_callee9$","_context10","firstChild","type","display","_loop$","_context9","personTR","deleteFunction","_deleteFunction","_callee8","_callee8$","_context8","paddingLeft","delegateYield","t1","finish","t2","getDefaultSignInButtonStyle","signInOrSignUpBox","setUserCallback","undefined","signInButtonStyle","buttonStyle","magicClassName","signInPopUpButton","authSession","onLogin","webIdURI","uri","divs","getElementsByClassName","parent","addEventListener","offline","offlineTestID","renderSignInPopup","signupButton","_event","signupMgr","Signup","signup","issuerPopup","body","issuerPopupBox","issuerPopupBoxTopMenu","issuerPopupBoxLabel","innerText","issuerPopupBoxCloseButton","remove","loginToIssuer","_ref","_callee","issuerUri","preLoginRedirectHash","locationUrl","_callee$","_context","updater","flagAuthorizationMetadata","URL","href","hash","localStorage","setItem","login","redirectUrl","oidcIssuer","_x11","issuerTextContainer","issuerTextInputContainer","issuerTextLabel","issuerTextInput","getItem","issuerTextGoButton","issuerButtonContainer","issuerBottonLabel","getSuggestedIssuers","forEach","issuerInfo","issuerButton","listener","setIt","newidURI","refresh","logoutButtonHandler","oldMe","logout","logoutButton","logoutLabel","nick","any","foaf","signOutButton","sessionInfo","info","isLoggedIn","sym","clearElement","trackSession","onLogout","_callee2","issuer","wellKnownUri","wellKnownResult","openidConfiguration","_callee2$","_context2","pathname","fetch","json","end_session_endpoint","credentials","reload","selectWorkspace","appDetails","callbackWS","appPathSegment","say","background","figureOutBase","ws","newBaseNode","space","newBaseString","split","now","Date","getTime","displayOptions","makeNewWorkspace","_x12","_makeNewWorkspace","_callee3","newBase","newWs","newData","_callee3$","_context3","padding","encodeURI","askName","update","id","w","each","storages","ldp","file","includes","toLowerCase","p","commentStyle","baseField","textInputStyle","size","autocomplete","button","replace","x","holds","rdf","col1","col2","col3","tr","comment","cellStyle","deselectedStyle","anyValue","ui","reduce","a","b","charCodeAt","bgcolor","target","rdfs","disabled","trLast","newAppInstance","callback","gotWS","base","getUserRoles","_getUserRoles","_callee10","_yield$ensureLoadedPr","_callee10$","_context11","doc","filterAvailablePanes","_x13","_filterAvailablePanes","_callee11","panes","userRoles","_callee11$","_context12","pane","isMatchingAudience","audience","isMatch","audienceRole","find","role","equals"],"sources":["../../src/login/login.ts"],"sourcesContent":["/* eslint-disable camelcase */\n/**\n * Signing in, signing up, profile and preferences reloading\n * Type index management\n *\n * Many functions in this module take a context object which\n * holds various RDF symbols, add to it, and return a promise of it.\n *\n * * `me`                RDF symbol for the user's WebID\n * * `publicProfile`     The user's public profile, iff loaded\n * * `preferencesFile`   The user's personal preference file, iff loaded\n * * `index.public`      The user's public type index file\n * * `index.private`     The user's private type index file\n *\n * Not RDF symbols:\n * * `noun`            A string in english for the type of thing -- like \"address book\"\n * * `instance`        An array of nodes which are existing instances\n * * `containers`      An array of nodes of containers of instances\n * * `div`             A DOM element where UI can be displayed\n * * `statusArea`      A DOM element (opt) progress stuff can be displayed, or error messages\n * *\n * * Vocabulary:  \"load\" loads a file if it exists;\n * *  'Ensure\" CREATES the file if it does not exist (if it can) and then loads it.\n * @packageDocumentation\n */\nimport { PaneDefinition } from 'pane-registry'\nimport { BlankNode, NamedNode, st } from 'rdflib'\n// eslint-disable-next-line camelcase\nimport { Quad_Object } from 'rdflib/lib/tf-types'\nimport {\n  AppDetails,\n  AuthenticationContext,\n  authn,\n  authSession,\n  CrossOriginForbiddenError,\n  FetchError,\n  getSuggestedIssuers,\n  NotEditableError,\n  offlineTestID,\n  SameOriginForbiddenError,\n  solidLogicSingleton,\n  UnauthorizedError,\n  WebOperationError\n} from 'solid-logic'\nimport * as debug from '../debug'\nimport { alert } from '../log'\nimport * as ns from '../ns.js'\nimport { Signup } from '../signup/signup.js'\nimport { buttonStyle, commentStyle, textInputStyle } from '../style'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\n\nconst store = solidLogicSingleton.store\n\nconst {\n  loadPreferences,\n  loadProfile\n} = solidLogicSingleton.profile\n\nconst {\n  getScopedAppInstances,\n  getRegistrations,\n  loadAllTypeIndexes,\n  getScopedAppsFromIndex,\n  deleteTypeIndexRegistration\n} = solidLogicSingleton.typeIndex\n\n/**\n * Resolves with the logged in user's WebID\n *\n * @param context\n */\n// used to be logIn\nexport function ensureLoggedIn (context: AuthenticationContext): Promise<AuthenticationContext> {\n  const me = authn.currentUser()\n  if (me) {\n    authn.saveUser(me, context)\n    return Promise.resolve(context)\n  }\n\n  return new Promise((resolve) => {\n    authn.checkUser().then((webId) => {\n      // Already logged in?\n      if (webId) {\n        debug.log(`logIn: Already logged in as ${webId}`)\n        return resolve(context)\n      }\n      if (!context.div || !context.dom) {\n        return resolve(context)\n      }\n      const box = loginStatusBox(context.dom, (webIdUri) => {\n        authn.saveUser(webIdUri, context)\n        resolve(context) // always pass growing context\n      })\n      context.div.appendChild(box)\n    })\n  })\n}\n\n/**\n * Loads preference file\n * Do this after having done log in and load profile\n *\n * @private\n *\n * @param context\n */\n// used to be logInLoadPreferences\nexport async function ensureLoadedPreferences (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.preferencesFile) return Promise.resolve(context) // already done\n\n  const statusArea = context.statusArea || context.div || null\n  let progressDisplay\n  function complain (message) {\n    message = `ensureLoadedPreferences: ${message}`\n    if (statusArea) {\n      // statusArea.innerHTML = ''\n      statusArea.appendChild(widgets.errorMessageBlock(context.dom, message))\n    }\n    debug.log(message)\n    // reject(new Error(message))\n  }\n  try {\n    context = await ensureLoadedProfile(context)\n\n    // console.log('back in Solid UI after logInLoadProfile', context)\n    const preferencesFile = await loadPreferences(context.me as NamedNode)\n    if (progressDisplay) {\n      progressDisplay.parentNode.removeChild(progressDisplay)\n    }\n    context.preferencesFile = preferencesFile\n  } catch (err) {\n    let m2: string\n    if (err instanceof UnauthorizedError) {\n      m2 =\n        'Ooops - you are not authenticated (properly logged in) to for me to read your preference file.  Try loggin out and logging in?'\n      alert(m2)\n    } else if (err instanceof CrossOriginForbiddenError) {\n      m2 = `Unauthorized: Assuming preference file blocked for origin ${window.location.origin}`\n      context.preferencesFileError = m2\n      return context\n    } else if (err instanceof SameOriginForbiddenError) {\n      m2 =\n        'You are not authorized to read your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof NotEditableError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof WebOperationError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n    } else if (err instanceof FetchError) {\n      m2 = `Strange: Error ${err.status} trying to read your preference file.${err.message}`\n      alert(m2)\n    } else {\n      throw new Error(`(via loadPrefs) ${err}`)\n    }\n  }\n  return context\n}\n\n/**\n * Logs the user in and loads their WebID profile document into the store\n *\n * @param context\n *\n * @returns Resolves with the context after login / fetch\n */\n// used to be logInLoadProfile\nexport async function ensureLoadedProfile (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.publicProfile) {\n    return context\n  } // already done\n  try {\n    const logInContext = await ensureLoggedIn(context)\n    if (!logInContext.me) {\n      throw new Error('Could not log in')\n    }\n    context.publicProfile = await loadProfile(logInContext.me)\n  } catch (err) {\n    if (context.div && context.dom) {\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, err.message))\n    }\n    throw new Error(`Can't log in: ${err}`)\n  }\n  return context\n}\n\n/**\n  * Returns promise of context with arrays of symbols\n  *\n  * leaving the `isPublic` param undefined will bring in community index things, too\n  */\nexport async function findAppInstances (\n  context: AuthenticationContext,\n  theClass: NamedNode,\n  isPublic?: boolean\n): Promise<AuthenticationContext> {\n  let items = context.me ? await getScopedAppInstances(theClass, context.me) : []\n  if (isPublic === true) { // old API - not recommended!\n    items = items.filter(item => item.scope.label === 'public')\n  } else if (isPublic === false) {\n    items = items.filter(item => item.scope.label === 'private')\n  }\n  context.instances = items.map(item => item.instance)\n  return context\n}\n\nexport function scopeLabel (context, scope) {\n  const mine = context.me && context.me.sameTerm(scope.agent)\n  const name = mine ? '' : utils.label(scope.agent) + ' '\n  return `${name}${scope.label}`\n}\n/**\n * UI to control registration of instance\n */\nexport async function registrationControl (\n  context: AuthenticationContext,\n  instance,\n  theClass\n): Promise<AuthenticationContext | void> {\n  function registrationStatements (index) {\n    const registrations = getRegistrations(instance, theClass)\n    const reg = registrations.length ? registrations[0] : widgets.newThing(index)\n    return [\n      st(reg, ns.solid('instance'), instance, index),\n      st(reg, ns.solid('forClass'), theClass, index)\n    ]\n  }\n\n  function renderScopeCheckbox (scope) {\n    const statements = registrationStatements(scope.index)\n    const name = scopeLabel(context, scope)\n    const label = `${name} link to this ${context.noun}`\n    return widgets.buildCheckboxForm(\n      context.dom,\n      solidLogicSingleton.store,\n      label,\n      null,\n      statements,\n      form,\n      scope.index\n    )\n  }\n  /// / body of registrationControl\n  const dom = context.dom\n  if (!dom || !context.div) {\n    throw new Error('registrationControl: need dom and div')\n  }\n  const box = dom.createElement('div')\n  context.div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  const me = context.me\n  if (!me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in to save a link to this)</p>'\n    return context\n  }\n\n  let scopes // @@ const\n  try {\n    scopes = await loadAllTypeIndexes(me)\n  } catch (e) {\n    let msg\n    if (context.div && context.preferencesFileError) {\n      msg = '(Lists of stuff not available)'\n      context.div.appendChild(dom.createElement('p')).textContent = msg\n    } else if (context.div) {\n      msg = `registrationControl: Type indexes not available: ${e}`\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, e))\n    }\n    debug.log(msg)\n    return context\n  }\n\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid gray 0.05em;')\n  const tbody = box.children[0].children[0]\n  const form = new BlankNode() // @@ say for now\n\n  for (const scope of scopes) {\n    const row = tbody.appendChild(dom.createElement('tr'))\n    row.appendChild(renderScopeCheckbox(scope)) // @@ index\n  }\n  return context\n}\n\nexport function renderScopeHeadingRow (context, store, scope) {\n  const backgroundColor = { private: '#fee', public: '#efe' }\n  const { dom } = context\n  const name = scopeLabel(context, scope)\n  const row = dom.createElement('tr')\n  const cell = row.appendChild(dom.createElement('td'))\n  cell.setAttribute('colspan', '3')\n  cell.style.backgoundColor = backgroundColor[scope.label] || 'white'\n  const header = cell.appendChild(dom.createElement('h3'))\n  header.textContent = name + ' links'\n  header.style.textAlign = 'left'\n  return row\n}\n/**\n  * UI to List at all registered things\n  */\nexport async function registrationList (context: AuthenticationContext, options: {\n  private?: boolean\n  public?: boolean\n  type?: NamedNode\n}): Promise<AuthenticationContext> {\n  const dom = context.dom as HTMLDocument\n  const div = context.div as HTMLElement\n\n  const box = dom.createElement('div')\n  div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  if (!context.me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in list your stuff)</p>'\n    return context\n  }\n\n  const scopes = await loadAllTypeIndexes(context.me) // includes community indexes\n\n  // console.log('@@ registrationList ', scopes)\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid #eee 0.5em;')\n  const table = box.firstChild as HTMLElement\n  const tbody = table.firstChild as HTMLElement\n\n  for (const scope of scopes) { // need some predicate for listing/adding agents\n    const headingRow = renderScopeHeadingRow(context, store, scope)\n    tbody.appendChild(headingRow)\n    const items = await getScopedAppsFromIndex(scope, options.type || null) // any class\n    if (items.length === 0) headingRow.style.display = 'none'\n    // console.log(`registrationList: @@ instance items for class ${options.type || 'undefined' }:`, items)\n    for (const item of items) {\n      const row = widgets.personTR(dom, ns.solid('instance'), item.instance, {\n        deleteFunction: async () => {\n          await deleteTypeIndexRegistration(item)\n          tbody.removeChild(row)\n        }\n      })\n      row.children[0].style.paddingLeft = '3em'\n\n      tbody.appendChild(row)\n    }\n  }\n  return context\n} // registrationList\n\nfunction getDefaultSignInButtonStyle (): string {\n  return 'padding: 1em; border-radius:0.5em; font-size: 100%;'\n}\n\n/**\n * Bootstrapping identity\n * (Called by `loginStatusBox()`)\n *\n * @param dom\n * @param setUserCallback\n *\n * @returns\n */\nfunction signInOrSignUpBox (\n  dom: HTMLDocument,\n  setUserCallback: (user: string) => void,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  options = options || {}\n  const signInButtonStyle = options.buttonStyle || getDefaultSignInButtonStyle()\n\n  // @@ TODO Remove the need to cast HTML element to any\n  const box: any = dom.createElement('div')\n  const magicClassName = 'SolidSignInOrSignUpBox'\n  debug.log('widgets.signInOrSignUpBox')\n  box.setUserCallback = setUserCallback\n  box.setAttribute('class', magicClassName);\n  (box as any).style = 'display:flex;' // @@ fix all typecasts like this\n\n  // Sign in button with PopUP\n  const signInPopUpButton = dom.createElement('input') // multi\n  box.appendChild(signInPopUpButton)\n  signInPopUpButton.setAttribute('type', 'button')\n  signInPopUpButton.setAttribute('value', 'Log in')\n  signInPopUpButton.setAttribute('style', `${signInButtonStyle}background-color: #eef;`)\n\n  authSession.onLogin(() => {\n    const me = authn.currentUser()\n    // const sessionInfo = authSession.info\n    // if (sessionInfo && sessionInfo.isLoggedIn) {\n    if (me) {\n      // const webIdURI = sessionInfo.webId\n      const webIdURI = me.uri\n      // setUserCallback(webIdURI)\n      const divs = dom.getElementsByClassName(magicClassName)\n      debug.log(`Logged in, ${divs.length} panels to be serviced`)\n      // At the same time, satisfy all the other login boxes\n      for (let i = 0; i < divs.length; i++) {\n        const div: any = divs[i]\n        // @@ TODO Remove the need to manipulate HTML elements\n        if (div.setUserCallback) {\n          try {\n            div.setUserCallback(webIdURI)\n            const parent = div.parentNode\n            if (parent) {\n              parent.removeChild(div)\n            }\n          } catch (e) {\n            debug.log(`## Error satisfying login box: ${e}`)\n            div.appendChild(widgets.errorMessageBlock(dom, e))\n          }\n        }\n      }\n    }\n  })\n\n  signInPopUpButton.addEventListener(\n    'click',\n    () => {\n      const offline = offlineTestID()\n      if (offline) return setUserCallback(offline.uri)\n\n      renderSignInPopup(dom)\n    },\n    false\n  )\n\n  // Sign up button\n  const signupButton = dom.createElement('input')\n  box.appendChild(signupButton)\n  signupButton.setAttribute('type', 'button')\n  signupButton.setAttribute('value', 'Sign Up for Solid')\n  signupButton.setAttribute('style', `${signInButtonStyle}background-color: #efe;`)\n\n  signupButton.addEventListener(\n    'click',\n    function (_event) {\n      const signupMgr = new Signup()\n      signupMgr.signup().then(function (uri) {\n        debug.log('signInOrSignUpBox signed up ' + uri)\n        setUserCallback(uri)\n      })\n    },\n    false\n  )\n  return box\n}\n\nexport function renderSignInPopup (dom: HTMLDocument) {\n  /**\n   * Issuer Menu\n   */\n  const issuerPopup = dom.createElement('div')\n  issuerPopup.setAttribute(\n    'style',\n    'position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; align-items: center;'\n  )\n  dom.body.appendChild(issuerPopup)\n  const issuerPopupBox = dom.createElement('div')\n  issuerPopupBox.setAttribute(\n    'style',\n    `\n      background-color: white;\n      box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -webkit-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -moz-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -o-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      border-radius: 4px;\n      min-width: 400px;\n      padding: 10px;\n      z-index : 10;\n    `\n  )\n  issuerPopup.appendChild(issuerPopupBox)\n  const issuerPopupBoxTopMenu = dom.createElement('div')\n  issuerPopupBoxTopMenu.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n    `\n  )\n  issuerPopupBox.appendChild(issuerPopupBoxTopMenu)\n  const issuerPopupBoxLabel = dom.createElement('label')\n  issuerPopupBoxLabel.setAttribute('style', 'margin-right: 5px; font-weight: 800')\n  issuerPopupBoxLabel.innerText = 'Select an identity provider'\n  const issuerPopupBoxCloseButton = dom.createElement('button')\n  issuerPopupBoxCloseButton.innerHTML =\n    '<img src=\"https://solidos.github.io/solid-ui/src/icons/noun_1180156.svg\" style=\"width: 2em; height: 2em;\" title=\"Cancel\">'\n  issuerPopupBoxCloseButton.setAttribute('style', 'background-color: transparent; border: none;')\n  issuerPopupBoxCloseButton.addEventListener('click', () => {\n    issuerPopup.remove()\n  })\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxLabel)\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxCloseButton)\n\n  const loginToIssuer = async (issuerUri: string) => {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n      // Save hash\n      const preLoginRedirectHash = new URL(window.location.href).hash\n      if (preLoginRedirectHash) {\n        window.localStorage.setItem('preLoginRedirectHash', preLoginRedirectHash)\n      }\n      window.localStorage.setItem('loginIssuer', issuerUri)\n      // Login\n      const locationUrl = new URL(window.location.href)\n      locationUrl.hash = '' // remove hash part\n      await authSession.login({\n        redirectUrl: locationUrl.href,\n        oidcIssuer: issuerUri\n      })\n    } catch (err) {\n      alert(err.message)\n    }\n  }\n\n  /**\n   * Text-based idp selection\n   */\n  const issuerTextContainer = dom.createElement('div')\n  issuerTextContainer.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerTextInputContainer = dom.createElement('div')\n  issuerTextInputContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: row;\n    `\n  )\n  const issuerTextLabel = dom.createElement('label')\n  issuerTextLabel.innerText = 'Enter the URL of your identity provider:'\n  issuerTextLabel.setAttribute('style', 'color: #888')\n  const issuerTextInput = dom.createElement('input')\n  issuerTextInput.setAttribute('type', 'text')\n  issuerTextInput.setAttribute(\n    'style',\n    'margin-left: 0 !important; flex: 1; margin-right: 5px !important'\n  )\n  issuerTextInput.setAttribute('placeholder', 'https://example.com')\n  issuerTextInput.value = localStorage.getItem('loginIssuer') || ''\n  const issuerTextGoButton = dom.createElement('button')\n  issuerTextGoButton.innerText = 'Go'\n  issuerTextGoButton.setAttribute('style', 'margin-top: 12px; margin-bottom: 12px;')\n  issuerTextGoButton.addEventListener('click', () => {\n    loginToIssuer(issuerTextInput.value)\n  })\n  issuerTextContainer.appendChild(issuerTextLabel)\n  issuerTextInputContainer.appendChild(issuerTextInput)\n  issuerTextInputContainer.appendChild(issuerTextGoButton)\n  issuerTextContainer.appendChild(issuerTextInputContainer)\n  issuerPopupBox.appendChild(issuerTextContainer)\n\n  /**\n   * Button-based idp selection\n   */\n  const issuerButtonContainer = dom.createElement('div')\n  issuerButtonContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerBottonLabel = dom.createElement('label')\n  issuerBottonLabel.innerText = 'Or pick an identity provider from the list below:'\n  issuerBottonLabel.setAttribute('style', 'color: #888')\n  issuerButtonContainer.appendChild(issuerBottonLabel)\n  getSuggestedIssuers().forEach((issuerInfo) => {\n    const issuerButton = dom.createElement('button')\n    issuerButton.innerText = issuerInfo.name\n    issuerButton.setAttribute('style', 'height: 38px; margin-top: 10px')\n    issuerButton.addEventListener('click', () => {\n      loginToIssuer(issuerInfo.uri)\n    })\n    issuerButtonContainer.appendChild(issuerButton)\n  })\n  issuerPopupBox.appendChild(issuerButtonContainer)\n}\n\n/**\n * Login status box\n *\n * A big sign-up/sign in box or a logout box depending on the state\n *\n * @param dom\n * @param listener\n *\n * @returns\n */\nexport function loginStatusBox (\n  dom: HTMLDocument,\n  listener: ((uri: string | null) => void) | null = null,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  // 20190630\n  let me = offlineTestID()\n  // @@ TODO Remove the need to cast HTML element to any\n  const box: any = dom.createElement('div')\n\n  function setIt (newidURI) {\n    if (!newidURI) {\n      return\n    }\n\n    // const uri = newidURI.uri || newidURI\n    // me = sym(uri)\n    me = authn.saveUser(newidURI)\n    box.refresh()\n    if (listener) listener(me!.uri)\n  }\n\n  function logoutButtonHandler (_event) {\n    const oldMe = me\n    authSession.logout().then(\n      function () {\n        const message = `Your WebID was ${oldMe}. It has been forgotten.`\n        me = null\n        try {\n          alert(message)\n        } catch (e) {\n          window.alert(message)\n        }\n        box.refresh()\n        if (listener) listener(null)\n      },\n      (err) => {\n        alert('Fail to log out:' + err)\n      }\n    )\n  }\n\n  function logoutButton (me, options) {\n    const signInButtonStyle = options.buttonStyle || getDefaultSignInButtonStyle()\n    let logoutLabel = 'WebID logout'\n    if (me) {\n      const nick =\n        solidLogicSingleton.store.any(me, ns.foaf('nick')) ||\n        solidLogicSingleton.store.any(me, ns.foaf('name'))\n      if (nick) {\n        logoutLabel = 'Logout ' + nick.value\n      }\n    }\n    const signOutButton = dom.createElement('input')\n    // signOutButton.className = 'WebIDCancelButton'\n    signOutButton.setAttribute('type', 'button')\n    signOutButton.setAttribute('value', logoutLabel)\n    signOutButton.setAttribute('style', `${signInButtonStyle}background-color: #eee;`)\n    signOutButton.addEventListener('click', logoutButtonHandler, false)\n    return signOutButton\n  }\n\n  box.refresh = function () {\n    const sessionInfo = authSession.info\n    if (sessionInfo && sessionInfo.webId && sessionInfo.isLoggedIn) {\n      me = solidLogicSingleton.store.sym(sessionInfo.webId)\n    } else {\n      me = null\n    }\n    if ((me && box.me !== me.uri) || (!me && box.me)) {\n      widgets.clearElement(box)\n      if (me) {\n        box.appendChild(logoutButton(me, options))\n      } else {\n        box.appendChild(signInOrSignUpBox(dom, setIt, options))\n      }\n    }\n    box.me = me ? me.uri : null\n  }\n  box.refresh()\n\n  function trackSession () {\n    me = authn.currentUser()\n    box.refresh()\n  }\n  trackSession()\n\n  authSession.onLogin(trackSession)\n  authSession.onLogout(trackSession)\n  box.me = '99999' // Force refresh\n  box.refresh()\n  return box\n}\n\nauthSession.onLogout(async () => {\n  const issuer = window.localStorage.getItem('loginIssuer')\n  if (issuer) {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n\n      const wellKnownUri = new URL(issuer)\n      wellKnownUri.pathname = '/.well-known/openid-configuration'\n      const wellKnownResult = await fetch(wellKnownUri.toString())\n      if (wellKnownResult.status === 200) {\n        const openidConfiguration = await wellKnownResult.json()\n        if (openidConfiguration && openidConfiguration.end_session_endpoint) {\n          await fetch(openidConfiguration.end_session_endpoint, { credentials: 'include' })\n        }\n      }\n    } catch (err) {\n      // Do nothing\n    }\n  }\n  window.location.reload()\n})\n\n/**\n * Workspace selection etc\n * See https://github.com/solidos/userguide/issues/16\n */\n\n/**\n * Returns a UI object which, if it selects a workspace,\n * will callback(workspace, newBase).\n * See https://github.com/solidos/userguide/issues/16 for more info on workspaces.\n *\n * If necessary, will get an account, preference file, etc. In sequence:\n *\n *   - If not logged in, log in.\n *   - Load preference file\n *   - Prompt user for workspaces\n *   - Allows the user to just type in a URI by hand\n *\n * Calls back with the workspace and the base URI\n *\n * @param dom\n * @param appDetails\n * @param callbackWS\n */\nexport function selectWorkspace (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callbackWS: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const noun = appDetails.noun\n  const appPathSegment = appDetails.appPathSegment\n\n  const me = offlineTestID()\n  const box = dom.createElement('div')\n  const context: AuthenticationContext = { me, dom, div: box }\n\n  function say (s, background) {\n    box.appendChild(widgets.errorMessageBlock(dom, s, background))\n  }\n\n  function figureOutBase (ws) {\n    const newBaseNode: NamedNode = solidLogicSingleton.store.any(\n      ws,\n      ns.space('uriPrefix')\n    ) as NamedNode\n    let newBaseString: string\n    if (!newBaseNode) {\n      newBaseString = ws.uri.split('#')[0]\n    } else {\n      newBaseString = newBaseNode.value\n    }\n    if (newBaseString.slice(-1) !== '/') {\n      debug.log(`${appPathSegment}: No / at end of uriPrefix ${newBaseString}`) // @@ paramater?\n      newBaseString = `${newBaseString}/`\n    }\n    const now = new Date()\n    newBaseString += `${appPathSegment}/id${now.getTime()}/` // unique id\n    return newBaseString\n  }\n\n  function displayOptions (context) {\n    // console.log('displayOptions!', context)\n    async function makeNewWorkspace (_event) {\n      const row = table.appendChild(dom.createElement('tr'))\n      const cell = row.appendChild(dom.createElement('td'))\n      cell.setAttribute('colspan', '3')\n      cell.style.padding = '0.5em'\n      const newBase = encodeURI(\n        await widgets.askName(\n          dom,\n          solidLogicSingleton.store,\n          cell,\n          ns.solid('URL'),\n          ns.space('Workspace'),\n          'Workspace'\n        )\n      )\n      const newWs = widgets.newThing(context.preferencesFile)\n      const newData = [\n        st(context.me, ns.space('workspace'), newWs, context.preferencesFile),\n        // eslint-disable-next-line camelcase\n        st(\n          newWs,\n          ns.space('uriPrefix'),\n          newBase as unknown as Quad_Object,\n          context.preferencesFile\n        )\n      ]\n      if (!solidLogicSingleton.store.updater) {\n        throw new Error('store has no updater')\n      }\n      await solidLogicSingleton.store.updater.update([], newData)\n      // @@ now refresh list of workspaces\n    }\n\n    // const status = ''\n    const id = context.me\n    const preferencesFile = context.preferencesFile\n    let newBase: any = null\n\n    // A workspace specifically defined in the private preference file:\n    let w: any = solidLogicSingleton.store.each(\n      id,\n      ns.space('workspace'),\n      undefined,\n      preferencesFile\n    ) // Only trust preference file here\n\n    // A workspace in a storage in the public profile:\n    const storages = solidLogicSingleton.store.each(id, ns.space('storage')) // @@ No provenance requirement at the moment\n    if (w.length === 0 && storages) {\n      say(\n        `You don't seem to have any workspaces. You have ${storages.length} storage spaces.`,\n        'white'\n      )\n      storages\n        .map(function (s: any) {\n          w = w.concat(solidLogicSingleton.store.each(s, ns.ldp('contains')))\n          return w\n        })\n        .filter((file) => {\n          return file.id ? ['public', 'private'].includes(file.id().toLowerCase()) : ''\n        })\n    }\n\n    if (w.length === 1) {\n      say(`Workspace used: ${w[0].uri}`, 'white') // @@ allow user to see URI\n      newBase = figureOutBase(w[0])\n      // callbackWS(w[0], newBase)\n      // } else if (w.length === 0) {\n    }\n\n    // Prompt for ws selection or creation\n    // say( w.length + \" workspaces for \" + id + \"Choose one.\");\n    const table = dom.createElement('table')\n    table.setAttribute('style', 'border-collapse:separate; border-spacing: 0.5em;')\n\n    // const popup = window.open(undefined, '_blank', { height: 300, width:400 }, false)\n    box.appendChild(table)\n\n    //  Add a field for directly adding the URI yourself\n\n    // const hr = box.appendChild(dom.createElement('hr')) // @@\n    box.appendChild(dom.createElement('hr')) // @@\n\n    const p = box.appendChild(dom.createElement('p'));\n    (p as any).style = commentStyle\n    p.textContent = `Where would you like to store the data for the ${noun}?\n    Give the URL of the folder where you would like the data stored.\n    It can be anywhere in solid world - this URI is just an idea.`\n    // @@ TODO Remove the need to cast baseField to any\n    const baseField: any = box.appendChild(dom.createElement('input'))\n    baseField.setAttribute('type', 'text');\n    (baseField as any).style = textInputStyle\n    baseField.size = 80 // really a string\n    baseField.label = 'base URL'\n    baseField.autocomplete = 'on'\n    if (newBase) {\n      // set to default\n      baseField.value = newBase\n    }\n\n    context.baseField = baseField\n\n    box.appendChild(dom.createElement('br')) // @@\n\n    const button = box.appendChild(dom.createElement('button'));\n    (button as any).style = buttonStyle\n    button.textContent = `Start new ${noun} at this URI`\n    button.addEventListener('click', function (_event) {\n      let newBase = baseField.value.replace(' ', '%20') // do not re-encode in general, as % encodings may exist\n      if (newBase.slice(-1) !== '/') {\n        newBase += '/'\n      }\n      callbackWS(null, newBase)\n    })\n\n    // Now go set up the table of spaces\n\n    // const row = 0\n    w = w.filter(function (x) {\n      return !solidLogicSingleton.store.holds(\n        x,\n        ns.rdf('type'), // Ignore master workspaces\n        ns.space('MasterWorkspace')\n      )\n    })\n    let col1, col2, col3, tr, ws, style, comment\n    const cellStyle = 'height: 3em; margin: 1em; padding: 1em white; border-radius: 0.3em;'\n    const deselectedStyle = `${cellStyle}border: 0px;`\n    // const selectedStyle = cellStyle + 'border: 1px solid black;'\n    for (let i = 0; i < w.length; i++) {\n      ws = w[i]\n      tr = dom.createElement('tr')\n      if (i === 0) {\n        col1 = dom.createElement('td')\n        col1.setAttribute('rowspan', `${w.length}`)\n        col1.textContent = 'Choose a workspace for this:'\n        col1.setAttribute('style', 'vertical-align:middle;')\n        tr.appendChild(col1)\n      }\n      col2 = dom.createElement('td')\n      style = solidLogicSingleton.store.anyValue(ws, ns.ui('style'))\n      if (!style) {\n        // Otherwise make up arbitrary colour\n        const hash = function (x) {\n          return x.split('').reduce(function (a, b) {\n            a = (a << 5) - a + b.charCodeAt(0)\n            return a & a\n          }, 0)\n        }\n        const bgcolor = `#${((hash(ws.uri) & 0xffffff) | 0xc0c0c0).toString(16)}` // c0c0c0  forces pale\n        style = `color: black ; background-color: ${bgcolor};`\n      }\n      col2.setAttribute('style', deselectedStyle + style)\n      tr.target = ws.uri\n      let label = solidLogicSingleton.store.any(ws, ns.rdfs('label'))\n      if (!label) {\n        label = ws.uri.split('/').slice(-1)[0] || ws.uri.split('/').slice(-2)[0]\n      }\n      col2.textContent = label || '???'\n      tr.appendChild(col2)\n      if (i === 0) {\n        col3 = dom.createElement('td')\n        col3.setAttribute('rowspan', `${w.length}1`)\n        // col3.textContent = '@@@@@ remove';\n        col3.setAttribute('style', 'width:50%;')\n        tr.appendChild(col3)\n      }\n      table.appendChild(tr)\n\n      comment = solidLogicSingleton.store.any(ws, ns.rdfs('comment'))\n      comment = comment ? comment.value : 'Use this workspace'\n      col2.addEventListener(\n        'click',\n        function (_event) {\n          col3.textContent = comment ? comment.value : ''\n          col3.setAttribute('style', deselectedStyle + style)\n          const button = dom.createElement('button')\n          button.textContent = 'Continue'\n          // button.setAttribute('style', style);\n          const newBase = figureOutBase(ws)\n          baseField.value = newBase // show user proposed URI\n\n          button.addEventListener(\n            'click',\n            function (_event) {\n              button.disabled = true\n              callbackWS(ws, newBase)\n              button.textContent = '---->'\n            },\n            true\n          ) // capture vs bubble\n          col3.appendChild(button)\n        },\n        true\n      ) // capture vs bubble\n    }\n\n    // last line with \"Make new workspace\"\n    const trLast = dom.createElement('tr')\n    col2 = dom.createElement('td')\n    col2.setAttribute('style', cellStyle)\n    col2.textContent = '+ Make a new workspace'\n    col2.addEventListener('click', makeNewWorkspace)\n    trLast.appendChild(col2)\n    table.appendChild(trLast)\n  } // displayOptions\n\n  // console.log('kicking off async operation')\n  ensureLoadedPreferences(context) // kick off async operation\n    .then(displayOptions)\n    .catch((err) => {\n      // console.log(\"err from async op\")\n      box.appendChild(widgets.errorMessageBlock(context.dom, err))\n    })\n\n  return box // return the box element, while login proceeds\n} // selectWorkspace\n\n/**\n * Creates a new instance of an app.\n *\n * An instance of an app could be e.g. an issue tracker for a given project,\n * or a chess game, or calendar, or a health/fitness record for a person.\n *\n * Note that this use of the term 'app' refers more to entries in the user's\n * type index than to actual software applications that use the personal data\n * to which these entries point.\n *\n * @param dom\n * @param appDetails\n * @param callback\n *\n * @returns A div with a button in it for making a new app instance\n */\nexport function newAppInstance (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callback: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const gotWS = function (ws, base) {\n    // log.debug(\"newAppInstance: Selected workspace = \" + (ws? ws.uri : 'none'))\n    callback(ws, base)\n  }\n  const div = dom.createElement('div')\n  const b = dom.createElement('button')\n  b.setAttribute('type', 'button')\n  div.appendChild(b)\n  b.innerHTML = `Make new ${appDetails.noun}`\n  b.addEventListener(\n    'click',\n    (_event) => {\n      div.appendChild(selectWorkspace(dom, appDetails, gotWS))\n    },\n    false\n  )\n  div.appendChild(b)\n  return div\n}\n/**\n * Retrieves whether the currently logged in user is a power user\n * and/or a developer\n */\nexport async function getUserRoles (): Promise<Array<NamedNode>> {\n  try {\n    const { me, preferencesFile, preferencesFileError } = await ensureLoadedPreferences({})\n    if (!preferencesFile || preferencesFileError) {\n      throw new Error(preferencesFileError)\n    }\n    return solidLogicSingleton.store.each(\n      me,\n      ns.rdf('type'),\n      null,\n      preferencesFile.doc()\n    ) as NamedNode[]\n  } catch (error) {\n    debug.warn('Unable to fetch your preferences - this was the error: ', error)\n  }\n  return []\n}\n\n/**\n * Filters which panes should be available, based on the result of [[getUserRoles]]\n */\nexport async function filterAvailablePanes (\n  panes: Array<PaneDefinition>\n): Promise<Array<PaneDefinition>> {\n  const userRoles = await getUserRoles()\n  return panes.filter((pane) => isMatchingAudience(pane, userRoles))\n}\n\nfunction isMatchingAudience (pane: PaneDefinition, userRoles: Array<NamedNode>): boolean {\n  const audience = pane.audience || []\n  return audience.reduce(\n    (isMatch, audienceRole) => isMatch && !!userRoles.find((role) => role.equals(audienceRole)),\n    true as boolean\n  )\n}\n"],"mappings":"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"}
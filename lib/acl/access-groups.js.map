{"version":3,"file":"access-groups.js","names":["_rdflib","require","_acl","widgets","_interopRequireWildcard","ns","_addAgentButtons","debug","style","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ACL","acl","COLLOQUIAL","RECOMMENDED","EXPLANATION","AccessGroups","doc","aclDoc","controller","store","options","arguments","length","undefined","_classCallCheck2","_defineProperty2","defaults","_store","aclMap","readACL","byCombo","ACLbyCombination","addAgentButton","AddAgentButtons","rootElement","dom","createElement","setAttribute","accessGroupList","_createClass2","value","render","_this","innerHTML","renderGroups","forEach","group","appendChild","isEditable","groupElements","comboIndex","combo","kToCombo","push","renderGroup","_this2","groupRow","accessGroupListItem","makeDropTarget","uris","handleDroppedUris","then","error","renderStatus","groupColumns","renderGroupElements","column","_this3","groupNameColumn","group1","group2","group3","group5","group9","group13","innerText","ktToList","groupAgentsColumn","groupAgentsTable","combos","map","_ref","_ref2","_slicedToArray2","pred","renderAgent","agentElement","groupDescriptionElement","_this4","personRow","personTR","sym","deleteFunction","deleteAgent","removeChild","_deleteAgent","_asyncToGenerator2","_regenerator","mark","_callee","comboToRemove","wrap","_callee$","_context","prev","next","find","_ref3","_ref4","comboPred","comboObj","splice","indexOf","save","stop","_x","_x2","_x3","apply","_addNewURI","_callee2","uri","_callee2$","_context2","handleDroppedUri","addNewURI","_x4","_handleDroppedUris","_callee3","_this5","_callee3$","_context3","Promise","all","t0","abrupt","reject","_x5","_x6","_handleDroppedUri","_this6","secondAttempt","_callee4","agent","thing","_this6$_store","_this6$_store$fetcher","message","_callee4$","_context4","findAgent","log","concat","fetcher","load","Error","setACLCombo","subject","_x7","_x8","res","removeAgentFromCombos","k","i","exports","y","sort","join","list","kb","types","findTypeURIs","ty","startsWith","split","endsWith","slice","vcard","sameTerm","foaf","rdf","owl","pref","any","solid"],"sources":["../../src/acl/access-groups.ts"],"sourcesContent":["/**\n * Contains the [[AccessGroups]]\n * and [[AccessGroupsOptions]] classes\n * @packageDocumentation\n */\n\nimport { NamedNode, sym, Store } from 'rdflib'\nimport { ACLbyCombination, readACL } from './acl'\nimport * as widgets from '../widgets'\nimport * as ns from '../ns'\nimport { AccessController } from './access-controller'\nimport { AgentMapMap, ComboList, PartialAgentTriple } from './types'\nimport { AddAgentButtons } from './add-agent-buttons'\nimport * as debug from '../debug'\nimport * as style from '../style'\n\nconst ACL = ns.acl\n\nconst COLLOQUIAL = {\n  13: 'Owners',\n  9: 'Owners (write locked)',\n  5: 'Editors',\n  3: 'Posters',\n  2: 'Submitters',\n  1: 'Viewers'\n}\n\nconst RECOMMENDED = {\n  13: true,\n  5: true,\n  3: true,\n  2: true,\n  1: true\n}\n\nconst EXPLANATION = {\n  13: 'can read, write, and control sharing.',\n  9: 'can read and control sharing, currently write-locked.',\n  5: 'can read and change information',\n  3: 'can add new information, and read but not change existing information',\n  2: 'can add new information but not read any',\n  1: 'can read but not change information'\n}\n\n/**\n * Type for the options parameter of [[AccessGroups]]\n */\nexport interface AccessGroupsOptions {\n  defaults?: boolean\n}\n\n/**\n * Renders the table of Owners, Editors, Posters, Submitters, Viewers\n * for https://github.com/solidos/userguide/blob/main/views/sharing/userguide.md\n */\nexport class AccessGroups {\n  private readonly defaults: boolean\n  public byCombo: ComboList\n  public aclMap: AgentMapMap\n  private readonly addAgentButton: AddAgentButtons\n  private readonly rootElement: HTMLElement\n  private _store: Store // @@ was LiveStore but does not need to be connected to web\n\n  constructor (\n    private doc: NamedNode,\n    private aclDoc: NamedNode,\n    public controller: AccessController,\n    store: Store, // @@ was LiveStore\n    private options: AccessGroupsOptions = {}\n  ) {\n    this.defaults = options.defaults || false\n    this._store = store\n    this.aclMap = readACL(doc, aclDoc, store, this.defaults)\n    this.byCombo = ACLbyCombination(this.aclMap)\n    this.addAgentButton = new AddAgentButtons(this)\n    this.rootElement = this.controller.dom.createElement('div')\n    this.rootElement.setAttribute('style', style.accessGroupList)\n  }\n\n  public get store () {\n    return this._store\n  }\n\n  public set store (store) {\n    this._store = store\n    this.aclMap = readACL(this.doc, this.aclDoc, store, this.defaults)\n    this.byCombo = ACLbyCombination(this.aclMap)\n  }\n\n  public render (): HTMLElement {\n    this.rootElement.innerHTML = ''\n    this.renderGroups().forEach(group => this.rootElement.appendChild(group))\n    if (this.controller.isEditable) {\n      this.rootElement.appendChild(this.addAgentButton.render())\n    }\n    return this.rootElement\n  }\n\n  private renderGroups (): HTMLElement[] {\n    const groupElements: HTMLElement[] = []\n    for (let comboIndex = 15; comboIndex > 0; comboIndex--) {\n      const combo = kToCombo(comboIndex)\n      if ((this.controller.isEditable && RECOMMENDED[comboIndex]) || this.byCombo[combo]) {\n        groupElements.push(this.renderGroup(comboIndex, combo))\n      }\n    }\n    return groupElements\n  }\n\n  private renderGroup (comboIndex: number, combo: string): HTMLElement {\n    const groupRow = this.controller.dom.createElement('div')\n    groupRow.setAttribute('style', style.accessGroupListItem)\n    widgets.makeDropTarget(groupRow, (uris) => this.handleDroppedUris(uris, combo)\n      .then(() => this.controller.render())\n      .catch(error => this.controller.renderStatus(error)))\n    const groupColumns = this.renderGroupElements(comboIndex, combo)\n    groupColumns.forEach(column => groupRow.appendChild(column))\n    return groupRow\n  }\n\n  private renderGroupElements (comboIndex, combo): HTMLElement[] {\n    const groupNameColumn = this.controller.dom.createElement('div')\n    groupNameColumn.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupNameColumn.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupNameColumn.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupNameColumn.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupNameColumn.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupNameColumn.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupNameColumn.setAttribute('style', style.group13)\n          break\n        default:\n          groupNameColumn.setAttribute('style', style.group)\n      }\n    }\n    groupNameColumn.innerText = COLLOQUIAL[comboIndex] || ktToList(comboIndex)\n\n    const groupAgentsColumn = this.controller.dom.createElement('div')\n    groupAgentsColumn.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupAgentsColumn.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupAgentsColumn.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupAgentsColumn.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupAgentsColumn.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupAgentsColumn.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupAgentsColumn.setAttribute('style', style.group13)\n          break\n        default:\n          groupAgentsColumn.setAttribute('style', style.group)\n      }\n    }\n    const groupAgentsTable = groupAgentsColumn.appendChild(this.controller.dom.createElement('table'))\n    const combos = this.byCombo[combo] || []\n    combos\n      .map(([pred, obj]) => this.renderAgent(groupAgentsTable, combo, pred, obj))\n      .forEach(agentElement => groupAgentsTable.appendChild(agentElement))\n\n    const groupDescriptionElement = this.controller.dom.createElement('div')\n    groupDescriptionElement.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupDescriptionElement.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupDescriptionElement.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupDescriptionElement.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupDescriptionElement.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupDescriptionElement.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupDescriptionElement.setAttribute('style', style.group13)\n          break\n        default:\n          groupDescriptionElement.setAttribute('style', style.group)\n      }\n    }\n    groupDescriptionElement.innerText = EXPLANATION[comboIndex] || 'Unusual combination'\n\n    return [groupNameColumn, groupAgentsColumn, groupDescriptionElement]\n  }\n\n  private renderAgent (groupAgentsTable, combo, pred, obj): HTMLElement {\n    const personRow = widgets.personTR(this.controller.dom, ACL(pred), sym(obj), this.controller.isEditable\n      ? {\n          deleteFunction: () => this.deleteAgent(combo, pred, obj)\n            .then(() => groupAgentsTable.removeChild(personRow))\n            .catch(error => this.controller.renderStatus(error))\n        }\n      : {})\n    return personRow\n  }\n\n  private async deleteAgent (combo, pred, obj): Promise<void> {\n    const combos = this.byCombo[combo] || []\n    const comboToRemove = combos.find(([comboPred, comboObj]) => comboPred === pred && comboObj === obj)\n    if (comboToRemove) {\n      combos.splice(combos.indexOf(comboToRemove), 1)\n    }\n    await this.controller.save()\n  }\n\n  public async addNewURI (uri: string): Promise<void> {\n    await this.handleDroppedUri(uri, kToCombo(1))\n    await this.controller.save()\n  }\n\n  private async handleDroppedUris (uris: string[], combo: string): Promise<void> {\n    try {\n      await Promise.all(uris.map(uri => this.handleDroppedUri(uri, combo)))\n      await this.controller.save()\n    } catch (error) {\n      return Promise.reject(error)\n    }\n  }\n\n  private async handleDroppedUri (uri: string, combo: string, secondAttempt: boolean = false): Promise<void> {\n    const agent = findAgent(uri, this.store) // eg 'agent', 'origin', agentClass'\n    const thing = sym(uri)\n    if (!agent && !secondAttempt) {\n      debug.log(`   Not obvious: looking up dropped thing ${thing}`)\n      try {\n        await this._store?.fetcher?.load(thing.doc())\n      } catch (error) {\n        const message = `Ignore error looking up dropped thing: ${error}`\n        debug.error(message)\n        return Promise.reject(new Error(message))\n      }\n      return this.handleDroppedUri(uri, combo, true)\n    } else if (!agent) {\n      const error = `   Error: Drop fails to drop appropriate thing! ${uri}`\n      debug.error(error)\n      return Promise.reject(new Error(error))\n    }\n    this.setACLCombo(combo, uri, agent, this.controller.subject)\n  }\n\n  private setACLCombo (combo: string, uri: string, res: PartialAgentTriple, subject: NamedNode): void {\n    if (!(combo in this.byCombo)) {\n      this.byCombo[combo] = []\n    }\n    this.removeAgentFromCombos(uri) // Combos are mutually distinct\n    this.byCombo[combo].push([res.pred, res.obj.uri])\n    debug.log(`ACL: setting access to ${subject} by ${res.pred}: ${res.obj}`)\n  }\n\n  private removeAgentFromCombos (uri: string): void {\n    for (let k = 0; k < 16; k++) {\n      const combos = this.byCombo[kToCombo(k)]\n      if (combos) {\n        for (let i = 0; i < combos.length; i++) {\n          while (i < combos.length && combos[i][1] === uri) {\n            combos.splice(i, 1)\n          }\n        }\n      }\n    }\n  }\n}\n\nfunction kToCombo (k: number): string {\n  const y = ['Read', 'Append', 'Write', 'Control']\n  const combo: string[] = []\n  for (let i = 0; i < 4; i++) {\n    if (k & (1 << i)) {\n      combo.push('http://www.w3.org/ns/auth/acl#' + y[i])\n    }\n  }\n  combo.sort()\n  return combo.join('\\n')\n}\n\nfunction ktToList (k: number): string {\n  let list = ''\n  const y = ['Read', 'Append', 'Write', 'Control']\n  for (let i = 0; i < 4; i++) {\n    if (k & (1 << i)) {\n      list += y[i]\n    }\n  }\n  return list\n}\n\nfunction findAgent (uri, kb): PartialAgentTriple | null {\n  const obj = sym(uri)\n  const types = kb.findTypeURIs(obj)\n  for (const ty in types) {\n    debug.log('    drop object type includes: ' + ty)\n  }\n  // An Origin URI is one like https://fred.github.io eith no trailing slash\n  if (uri.startsWith('http') && uri.split('/').length === 3) {\n    // there is no third slash\n    return { pred: 'origin', obj } // The only way to know an origin alas\n  }\n  // @@ This is an almighty kludge needed because drag and drop adds extra slashes to origins\n  if (\n    uri.startsWith('http') &&\n    uri.split('/').length === 4 &&\n    uri.endsWith('/')\n  ) {\n    // there  IS third slash\n    debug.log('Assuming final slash on dragged origin URI was unintended!')\n    return { pred: 'origin', obj: sym(uri.slice(0, -1)) } // Fix a URI where the drag and drop system has added a spurious slash\n  }\n\n  if (ns.vcard('WebID').uri in types) return { pred: 'agent', obj }\n\n  if (ns.vcard('Group').uri in types) {\n    return { pred: 'agentGroup', obj } // @@ note vcard membership not RDFs\n  }\n  if (\n    obj.sameTerm(ns.foaf('Agent')) ||\n    obj.sameTerm(ns.acl('AuthenticatedAgent')) || // AuthenticatedAgent\n    obj.sameTerm(ns.rdf('Resource')) ||\n    obj.sameTerm(ns.owl('Thing'))\n  ) {\n    return { pred: 'agentClass', obj }\n  }\n  if (\n    ns.vcard('Individual').uri in types ||\n    ns.foaf('Person').uri in types ||\n    ns.foaf('Agent').uri in types\n  ) {\n    const pref = kb.any(obj, ns.foaf('preferredURI'))\n    if (pref) return { pred: 'agent', obj: sym(pref) }\n    return { pred: 'agent', obj }\n  }\n  if (ns.solid('AppProvider').uri in types) {\n    return { pred: 'origin', obj }\n  }\n  if (ns.solid('AppProviderClass').uri in types) {\n    return { pred: 'originClass', obj }\n  }\n  debug.log('    Triage fails for ' + uri)\n  return null\n}\n"],"mappings":"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"}